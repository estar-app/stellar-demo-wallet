(this["webpackJsonpstellar-demo-wallet"]=this["webpackJsonpstellar-demo-wallet"]||[]).push([[0],{1:function(e,t,n){"use strict";var r,a,s,i,c,o,u,d,l,p,b,h,f,j,v,m;n.d(t,"i",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"o",(function(){return s})),n.d(t,"f",(function(){return i})),n.d(t,"h",(function(){return c})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"p",(function(){return l})),n.d(t,"g",(function(){return p})),n.d(t,"b",(function(){return b})),n.d(t,"m",(function(){return h})),n.d(t,"n",(function(){return f})),n.d(t,"l",(function(){return j})),n.d(t,"k",(function(){return v})),n.d(t,"j",(function(){return m})),function(e){e.SECRET_KEY="secretKey",e.PUBNET="pubnet",e.UNTRUSTED_ASSETS="untrustedAssets",e.ASSET_OVERRIDES="assetOverrides",e.CLAIMABLE_BALANCE_SUPPORTED="claimableBalanceSupported"}(r||(r={})),function(e){e.TRUSTED="trusted",e.UNTRUSTED="untrusted"}(a||(a={})),function(e){e.ACCOUNTS="ACCOUNTS",e.AUTH_SERVER="AUTH_SERVER",e.DIRECT_PAYMENT_SERVER="DIRECT_PAYMENT_SERVER",e.FEDERATION_SERVER="FEDERATION_SERVER",e.HORIZON_URL="HORIZON_URL",e.KYC_SERVER="KYC_SERVER",e.NETWORK_PASSPHRASE="NETWORK_PASSPHRASE",e.SIGNING_KEY="SIGNING_KEY",e.TRANSFER_SERVER="TRANSFER_SERVER",e.TRANSFER_SERVER_SEP0024="TRANSFER_SERVER_SEP0024",e.URI_REQUEST_SIGNING_KEY="URI_REQUEST_SIGNING_KEY",e.VERSION="VERSION",e.WEB_AUTH_ENDPOINT="WEB_AUTH_ENDPOINT"}(s||(s={})),function(e){e.REQUEST="request",e.RESPONSE="response",e.INSTRUCTION="instruction",e.ERROR="error"}(i||(i={})),function(e){e.PUBLIC="public",e.TESTNET="testnet"}(c||(c={})),function(e){e.ERROR="ERROR",e.PENDING="PENDING",e.SUCCESS="SUCCESS",e.NEEDS_INPUT="NEEDS_INPUT",e.CAN_PROCEED="CAN_PROCEED"}(o||(o={})),function(e){e.SEND_PAYMENT="send-payment",e.SEP6_DEPOSIT="sep6-deposit",e.SEP6_WITHDRAW="sep6-withdraw",e.SEP8_SEND_PAYMENT="sep8-send-payment",e.SEP24_DEPOSIT="sep24-deposit",e.SEP24_WITHDRAW="sep24-withdraw",e.SEP31_SEND="sep31-send",e.TRUST_ASSET="trust-asset",e.REMOVE_ASSET="remove-asset",e.ADD_ASSET_OVERRIDE="add-asset-override",e.REMOVE_ASSET_OVERRIDE="remove-asset-override"}(u||(u={})),function(e){e.NATIVE="native"}(d||(d={})),function(e){e.COMPLETED="completed",e.ERROR="error",e.INCOMPLETE="incomplete",e.PENDING_ANCHOR="pending_anchor",e.PENDING_CUSTOMER_INFO_UPDATE="pending_customer_info_update",e.PENDING_EXTERNAL="pending_external",e.PENDING_RECEIVER="pending_receiver",e.PENDING_SENDER="pending_sender",e.PENDING_STELLAR="pending_stellar",e.PENDING_TRANSACTION_INFO_UPDATE="pending_transaction_info_update",e.PENDING_TRUST="pending_trust",e.PENDING_USER="pending_user",e.PENDING_USER_TRANSFER_START="pending_user_transfer_start"}(l||(l={})),function(e){e.TEXT="text",e.ID="id",e.HASH="hash"}(p||(p={})),function(e){e.DEPOSIT="deposit",e.WITHDRAWAL="withdraw"}(b||(b={})),function(e){e.ACTION_REQUIRED="action_required",e.PENDING="pending",e.REJECTED="rejected",e.REVISED="revised",e.SUCCESS="success"}(h||(h={})),function(e){e.DISABLED="disabled",e.STARTING="starting",e.PENDING="pending",e.TRANSACTION_REVISED="transaction_revised",e.ACTION_REQUIRED="action_required",e.SENT_ACTION_REQUIRED_FIELDS="sent_action_required_fields",e.COMPLETE="complete"}(f||(f={})),function(e){e.FOLLOW_NEXT_URL="follow_next_url",e.NO_FURTHER_ACTION_REQUIRED="no_further_action_required"}(j||(j={})),function(e){e.ACCEPTED="ACCEPTED",e.PROCESSING="PROCESSING",e.NEEDS_INFO="NEEDS_INFO",e.REJECTED="REJECTED"}(v||(v={})),function(e){e.ACCEPTED="ACCEPTED",e.PROCESSING="PROCESSING",e.NOT_PROVIDED="NOT_PROVIDED",e.REJECTED="REJECTED",e.VERIFICATION_REQUIRED="VERIFICATION_REQUIRED"}(m||(m={}))},1018:function(e,t){},1057:function(e,t,n){},1058:function(e,t,n){},1059:function(e,t,n){},1060:function(e,t,n){},1062:function(e,t,n){"use strict";n.r(t);var r=n(88),a=n.n(r),s=n(38),i=n(31),c=n(18),o=n(2),u=n(50),d=n(23),l=n(12),p=n(457),b=n(29),h=n.n(b),f=n(4),j=n.n(f),v=n(9),m=n(91),S=n(6),O=n.n(S),E=n(7),g=Object(l.d)({name:"settings",initialState:{assetOverrides:"",pubnet:!1,secretKey:"",untrustedAssets:"",claimableBalanceSupported:!1},reducers:{updateSettingsAction:function(e,t){return Object(E.a)(Object(E.a)({},e),t.payload)}}}),x=function(e){return e.settings},y=g.reducer,T=g.actions.updateSettingsAction,w=n(10),A=function(e){var t=e;return t=t.includes("localhost")?t.startsWith("http")?t:"http://".concat(t):t.startsWith("http")?t:"https://".concat(t),new URL(t.replace(/\/$/,""))},C=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=A(t)).pathname="/.well-known/stellar.toml","http:"!==n.protocol){e.next=8;break}return e.next=5,S.StellarTomlResolver.resolve(n.host,{allowHttp:!0});case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,S.StellarTomlResolver.resolve(n.host);case 10:e.t0=e.sent;case 11:return r=e.t0,e.abrupt("return",r);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=n(1),N=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p,b,h,f,v;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.assetId,r=t.networkUrl,a=t.homeDomainOverride,s=new S.Server(r),n!==R.e.NATIVE){e.next=4;break}return e.abrupt("return",{homeDomain:void 0,supportedActions:{}});case 4:if(i={},c=n.split(":"),o=Object(w.a)(c,2),u=o[1],d=a,a){e.next=12;break}return e.next=10,s.loadAccount(u);case 10:l=e.sent,d=l.home_domain;case 12:if(!d){e.next=18;break}return e.next=15,C(d);case 15:p=e.sent,b=p.CURRENCIES,h=p.TRANSFER_SERVER,f=p.TRANSFER_SERVER_SEP0024,v=p.DIRECT_PAYMENT_SERVER,i={sep6:Boolean(h),sep8:k({assetId:n,currencies:b}),sep24:Boolean(f),sep31:Boolean(v)};case 18:return e.abrupt("return",Object(E.a)({homeDomain:d},{supportedActions:i}));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(e){var t=e.currencies,n=e.assetId.split(":"),r=Object(w.a)(n,2),a=r[0],s=r[1],i=t.find((function(e){return e.code===a&&e.issuer===s}));return Boolean(null===i||void 0===i?void 0:i.regulated)},I=function(e){var t,n=e.source,r=e.homeDomain,a=e.supportedActions,s=e.isUntrusted,i=void 0!==s&&s,c=e.assetCode,o=void 0===c?"":c,u=e.assetIssuer,d=void 0===u?"":u,l=e.assetType,p=void 0===l?"":l,b=o||(null===n||void 0===n?void 0:n.token.code),h=p||(null===n||void 0===n?void 0:n.token.type);if(!b||!h)throw new Error("Asset code and asset type are required");var f=d;return f||h===R.e.NATIVE||(f=n.token.issuer.key),{assetString:h===R.e.NATIVE?"native":"".concat(b,":").concat(f),assetCode:b,assetIssuer:f,assetType:h,total:(null===n||void 0===n||null===(t=n.available)||void 0===t?void 0:t.toString())||"0",homeDomain:r,supportedActions:a,isUntrusted:i,source:n}},_=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.balances,r=t.networkUrl,a=Object.entries(n),s=[],null===a||void 0===a?void 0:a.length){e.next=5;break}return e.abrupt("return",s);case 5:i=0;case 6:if(!(i<a.length)){e.next=17;break}return c=Object(w.a)(a[i],2),o=c[0],u=c[1],e.next=10,N({assetId:o,networkUrl:r});case 10:d=e.sent,l=d.homeDomain,p=d.supportedActions,s.push(I({source:u,homeDomain:l,supportedActions:p}));case 14:i++,e.next=6;break;case 17:return e.abrupt("return",s);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(e){var t=Object(u.getCatchError)(e);return t.message||t.toString()},D={buy_not_authorized:"The issuer must authorize you to trade this token. Visit the issuer\u2019s site more info.",op_malformed:"The input is incorrect and would result in an invalid offer.",op_sell_no_trust:"You are not authorized to sell this asset.",op_line_full:"You have reached the limit allowed for buying that asset.",op_no_destination:"The destination account doesn't exist.",op_no_trust:"One or more accounts in this transaction doesn't have a trustline with the desired asset.",op_underfunded:"You don\u2019t have enough to cover that transaction.",op_under_dest_min:"We couldn\u2019t complete your transaction at this time because the exchange rate offered is no longer available. Please try again.",op_over_source_max:"We couldn\u2019t complete your transaction at this time because the exchange rate offered is no longer available. Please try again.",op_cross_self:"You already have an offer out that would immediately cross this one.",op_sell_no_issuer:"The issuer of that token doesn\u2019t exist.",buy_no_issuer:"The issuer of that token doesn\u2019t exist.",op_offer_not_found:"We couldn\u2019t find that offer.",op_low_reserve:"That offer would take you below the minimum XLM reserve.",op_not_authorized:"This operation was not authorized, please make sure the asset you used complies with the Regulated Assets protocol (SEP-8).",tx_bad_auth:"Something went wrong while signing a transaction.",tx_bad_seq:"The app has gotten out of sync with the network. Please try again later.",tx_too_late:"This transaction has expired."};function U(e){var t=e&&e.response?e.response:e;if(t&&504===t.status)return"Sorry, the request timed out! Please try again later.";if(t&&t.data&&t.data.extras&&t.data.extras.result_codes){var n=t.data.extras.result_codes;if(n.operations){var r=n.operations,a=["op_success"],s=r.filter((function(e){return!a.includes(e)})).map((function(e){return D[e]||"Error code '".concat(e,"'.")})).join(" ");if(s)return s}if(n.transaction)return D[n.transaction]||"Error code '".concat(n.transaction,"'")}return t&&t.data&&t.data.detail?t.data.detail:t&&t.detail?t.detail:t&&t.message?t.message:t&&t.errors?t.errors[0].message:t&&t.error?t.error:t.toString()}var L,B={testnet:{network:O.a.Networks.TESTNET,url:"https://horizon-testnet.stellar.org"},public:{network:O.a.Networks.PUBLIC,url:"https://horizon.stellar.org"}},M=function(e){var t=e?R.h.PUBLIC:R.h.TESTNET;return B[t]},F=n(3),K=Object(l.c)("account/fetchAccountAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,d,l,p,b,h,f,v;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.publicKey,a=t.secretKey,s=n.rejectWithValue,i=n.getState,c=x(i()),o=c.pubnet,d=M(o),l=new m.a({serverUrl:d.url,accountOrKey:r,networkPassphrase:d.network}),p=null,b=[],h=!1,F.a.request({title:"Fetching account info",body:"Public key: ".concat(r)}),e.prev=9,e.next=12,l.fetchAccountDetails();case 12:return p=e.sent,e.next=15,_({balances:p.balances,networkUrl:d.url});case 15:b=e.sent,e.next=30;break;case 18:if(e.prev=18,e.t0=e.catch(9),!(f=Object(u.getCatchError)(e.t0)).isUnfunded){e.next=27;break}F.a.instruction({title:"Account is not funded"}),p={id:r},h=!0,e.next=30;break;case 27:return v=U(f),F.a.error({title:"Fetching account `".concat(r,"` failed"),body:v}),e.abrupt("return",s({errorString:v}));case 30:return F.a.response({title:"Account info fetched",body:p}),e.abrupt("return",{data:p,assets:b,isUnfunded:h,secretKey:a});case 32:case"end":return e.stop()}}),e,null,[[9,18]])})));return function(t,n){return e.apply(this,arguments)}}()),G=Object(l.c)("account/createRandomAccount",(function(e,t){var n=t.rejectWithValue;try{return F.a.instruction({title:"Generating new keypair"}),S.Keypair.random().secret()}catch(r){return F.a.error({title:"Generating new keypair failed",body:P(r)}),n({errorString:"Something went wrong while creating random account, please try again."})}})),V=Object(l.c)("account/fundTestnetAccount",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,a=n.getState,F.a.instruction({title:"The friendbot is funding testnet account",body:"Public key: ".concat(t)}),s=x(a()),i=s.pubnet,c=M(i),o=new m.a({serverUrl:c.url,accountOrKey:t,networkPassphrase:c.network}),e.prev=5,e.next=8,fetch("https://friendbot.stellar.org?addr=".concat(t));case 8:return e.next=10,o.fetchAccountDetails();case 10:return u=e.sent,e.next=13,_({balances:u.balances,networkUrl:c.url});case 13:return d=e.sent,F.a.response({title:"The friendbot funded account",body:u}),e.abrupt("return",{data:u,assets:d,isUnfunded:!1});case 18:return e.prev=18,e.t0=e.catch(5),F.a.error({title:"The friendbot funding of the account failed",body:P(e.t0)}),e.abrupt("return",r({errorString:"Something went wrong with funding the account, please try again."}));case 22:case"end":return e.stop()}}),e,null,[[5,18]])})));return function(t,n){return e.apply(this,arguments)}}()),W={data:null,assets:[],errorString:void 0,isAuthenticated:!1,isUnfunded:!1,secretKey:"",status:void 0},q=Object(l.d)({name:"account",initialState:W,reducers:{resetAccountAction:function(){return W},resetAccountStatusAction:function(e){e.status=void 0}},extraReducers:function(e){e.addCase(K.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W;e.status=R.a.PENDING})),e.addCase(K.fulfilled,(function(e,t){e.data=t.payload.data,e.assets=t.payload.assets,e.isAuthenticated=Boolean(t.payload.data),e.isUnfunded=t.payload.isUnfunded,e.secretKey=t.payload.secretKey,e.status=R.a.SUCCESS})),e.addCase(K.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR})),e.addCase(G.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W;e.status=R.a.PENDING})),e.addCase(G.fulfilled,(function(e,t){e.secretKey=t.payload,e.status=R.a.SUCCESS})),e.addCase(G.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR})),e.addCase(V.pending,(function(e){e.status=R.a.PENDING})),e.addCase(V.fulfilled,(function(e,t){e.data=t.payload.data,e.assets=t.payload.assets,e.isUnfunded=t.payload.isUnfunded,e.status=R.a.SUCCESS})),e.addCase(V.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR}))}}),H=function(e){return e.account},Y=q.reducer,X=q.actions,Q=(X.resetAccountAction,X.resetAccountStatusAction),z={action:void 0,status:void 0},J=Object(l.d)({name:"activeAsset",initialState:z,reducers:{setActiveAssetAction:function(e,t){e.action=t.payload},setActiveAssetStatusAction:function(e,t){e.action&&(e.status=t.payload)},resetActiveAssetAction:function(){return z}}}),Z=J.reducer,$=J.actions,ee=$.setActiveAssetAction,te=$.setActiveAssetStatusAction,ne=$.resetActiveAssetAction,re=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,l,p,b,h,f,v,m,O;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.assetOverrides,r=t.networkUrl,n.length){e.next=3;break}return e.abrupt("return",[]);case 3:a=[],s=0;case 5:if(!(s<n.length)){e.next=24;break}return i=n[s],c=i.assetString,o=i.homeDomain,u=c.split(":"),l=Object(w.a)(u,2),p=l[0],b=l[1],h=new S.Server(r),e.next=11,h.assets().forCode(p).forIssuer(b).call();case 11:if((f=e.sent).records.length){e.next=15;break}return F.a.error({title:"Asset `".concat(c,"` does not exist.")}),e.abrupt("break",24);case 15:return e.next=17,N({assetId:c,networkUrl:r,homeDomainOverride:o});case 17:v=e.sent,m=v.supportedActions,O=I({assetCode:p,assetIssuer:b,assetType:f.records[0].asset_type,homeDomain:o,supportedActions:m}),a=[].concat(Object(d.a)(a),[O]);case 21:s++,e.next=5;break;case 24:return e.abrupt("return",a);case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=n(16),se=n(19),ie=function(e){var t=e?e.split(","):[];return t.length?t.reduce((function(e,t){var n=t.split("|"),r=n[0],a=n.splice(1,n.length-1).reduce((function(e,t){var n=t.split(se.d),r=Object(w.a)(n,2),a=r[0],s=r[1];return Object(E.a)(Object(E.a)({},e),{},Object(ae.a)({},a,s))}),{});return[].concat(Object(d.a)(e),[Object(E.a)({assetString:r},a)])}),[]):[]},ce=Object(l.c)("assetOverrides/addAssetOverridesAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,a=n.getState,s=x(a()),i=s.pubnet,e.prev=2,c=ie(t),e.next=6,re({assetOverrides:c,networkUrl:M(i).url});case 6:return o=e.sent,e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(2),u=P(e.t0),F.a.error({title:u}),e.abrupt("return",r({errorString:u}));case 15:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n){return e.apply(this,arguments)}}()),oe={data:[],errorString:void 0,status:void 0},ue=Object(l.d)({name:"assetOverrides",initialState:oe,reducers:{resetAssetOverridesStatusAction:function(e){e.status=void 0},resetAssetOverridesAction:function(){return oe}},extraReducers:function(e){e.addCase(ce.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe;e.status=R.a.PENDING})),e.addCase(ce.fulfilled,(function(e,t){e.data=t.payload,e.status=R.a.SUCCESS})),e.addCase(ce.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR}))}}),de=ue.reducer,le=ue.actions,pe=le.resetAssetOverridesStatusAction,be=(le.resetAssetOverridesAction,function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,l,p,b,h,f,v,m,O;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.assetsToAdd,r=t.accountAssets,a=t.networkUrl,n.length||F.a.instruction({title:"No assets to fetch"}),s=[],i=0;case 4:if(!(i<n.length)){e.next=32;break}if(c=n[i],o=c.split(":"),u=Object(w.a)(o,2),l=u[0],p=u[1],!(null===r||void 0===r?void 0:r[c])){e.next=10;break}return F.a.instruction({title:"Asset `".concat(c,"` is already trusted")}),e.abrupt("continue",29);case 10:return F.a.request({title:"Fetching asset `".concat(c,"` record")}),b=new S.Server(a),e.next=14,b.assets().forCode(l).forIssuer(p).call();case 14:if((h=e.sent).records.length){e.next=20;break}F.a.error({title:"Asset `".concat(c,"` does not exist")}),s=[].concat(Object(d.a)(s),[{assetString:c,assetCode:l,assetIssuer:p,assetType:"none",total:"0",notExist:!0,source:{}}]),e.next=29;break;case 20:return F.a.response({title:"Asset `".concat(c,"` record fetched"),body:h.records[0]}),e.next=23,N({assetId:c,networkUrl:a});case 23:f=e.sent,v=f.homeDomain,m=f.supportedActions,O=I({assetCode:l,assetIssuer:p,assetType:h.records[0].asset_type,homeDomain:v,supportedActions:m,isUntrusted:!0}),s=[].concat(Object(d.a)(s),[O]),F.a.instruction({title:"Asset `".concat(c,"` added")});case 29:i++,e.next=4;break;case 32:return e.abrupt("return",s);case 33:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),he=function(e){var t=e.assetsString,n=e.untrustedAssets,r=t.split(",");if(!n.length)return r;var a=n.map((function(e){return e.assetString}));return r.filter((function(e){return!a.includes(e)}))},fe=Object(l.c)("untrustedAssets/addUntrustedAssetAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,d,l,p,b,h,f;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rejectWithValue,a=n.getState,s=H(a()),i=s.data,c=x(a()),o=c.pubnet,d=Se(a()),l=d.data,e.prev=4,(p=he({assetsString:t,untrustedAssets:l})).length){e.next=8;break}return e.abrupt("return",[]);case 8:return F.a.instruction({title:"Adding untrusted asset"}),e.prev=9,e.next=12,be({assetsToAdd:p,accountAssets:null===i||void 0===i?void 0:i.balances,networkUrl:M(o).url});case 12:b=e.sent,e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(9),h=Object(u.getCatchError)(e.t0),new Error(h.message);case 19:if(b.length){e.next=22;break}return F.a.instruction({title:"No new assets to add"}),e.abrupt("return",[]);case 22:return e.abrupt("return",b);case 25:return e.prev=25,e.t1=e.catch(4),f=Object(u.getCatchError)(e.t1),F.a.error({title:f.toString()}),e.abrupt("return",r({errorString:P(f)}));case 30:case"end":return e.stop()}}),e,null,[[4,25],[9,15]])})));return function(t,n){return e.apply(this,arguments)}}()),je=Object(l.c)("untrustedAssets/removeUntrustedAssetAction",(function(e,t){var n=t.getState;return Se(n()).data.filter((function(t){return t.assetString!==e}))})),ve={data:[],errorString:void 0,status:void 0},me=Object(l.d)({name:"untrustedAssets",initialState:ve,reducers:{resetUntrustedAssetStatusAction:function(e){e.status=void 0},resetUntrustedAssetsAction:function(){return ve}},extraReducers:function(e){e.addCase(fe.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve;e.status=R.a.PENDING})),e.addCase(fe.fulfilled,(function(e,t){e.data=[].concat(Object(d.a)(e.data),Object(d.a)(t.payload)),e.status=R.a.SUCCESS})),e.addCase(fe.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR})),e.addCase(je.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve;e.status=R.a.PENDING})),e.addCase(je.fulfilled,(function(e,t){e.data=t.payload,e.status=R.a.SUCCESS}))}}),Se=function(e){return e.untrustedAssets},Oe=me.reducer,Ee=me.actions,ge=Ee.resetUntrustedAssetStatusAction,xe=(Ee.resetUntrustedAssetsAction,function(e){var t=e.assets,n=e.assetCategory,r=e.assetOverrides;return t.reduce((function(e,t){var a=r.find((function(e){return e.assetString===t.assetString})),s=a?Object(E.a)(Object(E.a)({},a),{},{category:n,isUntrusted:t.isUntrusted,isOverride:!0,total:t.total}):Object(E.a)(Object(E.a)({},t),{},{category:n});return[].concat(Object(d.a)(e),[s])}),[])}),ye=Object(l.c)("allAssets/getAllAssetsAction",(function(e,t){var n=t.rejectWithValue,r=t.getState,a=H(r()).assets,s=Se(r()).data,i=r().assetOverrides.data,c=xe({assets:a,assetCategory:R.d.TRUSTED,assetOverrides:i}),o=xe({assets:s,assetCategory:R.d.UNTRUSTED,assetOverrides:i});try{return[].concat(Object(d.a)(c),Object(d.a)(o))}catch(l){var u=P(l);return F.a.error({title:u}),n({errorString:u})}})),Te={data:[],errorString:void 0,status:void 0},we=Object(l.d)({name:"allAssets",initialState:Te,reducers:{resetAllAssetsStatusAction:function(e){e.status=void 0}},extraReducers:function(e){e.addCase(ye.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te;e.status=R.a.PENDING})),e.addCase(ye.fulfilled,(function(e,t){e.data=t.payload,e.status=R.a.SUCCESS})),e.addCase(ye.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR}))}}),Ae=we.reducer,Ce=we.actions.resetAllAssetsStatusAction,Re=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p,b,h;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.secretKey,r=t.balance,a=t.assetCode,s=t.networkPassphrase,i=t.networkUrl,c=t.fee,F.a.instruction({title:"Claiming ".concat(r.total," ").concat(a),body:"Balance ID: ".concat(r.id,", sponsor: ").concat(r.sponsor)}),e.prev=2,o=S.Keypair.fromSecret(n),u=new O.a.Server(i),e.next=7,u.accounts().accountId(o.publicKey()).call();case 7:return d=e.sent,F.a.instruction({title:"Loading account to get a sequence number for `claimClaimableBalance` transaction"}),l=new S.Account(o.publicKey(),d.sequence),F.a.instruction({title:"Building `claimClaimableBalance` transaction"}),(p=new S.TransactionBuilder(l,{fee:c,networkPassphrase:s}).addOperation(S.Operation.claimClaimableBalance({balanceId:r.id})).setTimeout(0).build()).sign(o),F.a.request({title:"Submitting `claimClaimableBalance` transaction",body:p}),e.next=16,u.submitTransaction(p);case 16:return b=e.sent,F.a.response({title:"Submitted `claimClaimableBalance` transaction",body:b}),F.a.instruction({title:"Claimed ".concat(r.total," ").concat(a)}),e.abrupt("return",b);case 22:throw e.prev=22,e.t0=e.catch(2),h=P(e.t0),F.a.error({title:"`claimClaimableBalance` transaction failed",body:h}),new Error(h);case 27:case"end":return e.stop()}}),e,null,[[2,22]])})));return function(t){return e.apply(this,arguments)}}(),Ne=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.secretKey,r=t.untrustedAsset,a=t.networkUrl,s=t.networkPassphrase,e.prev=1,F.a.instruction({title:"Adding `".concat(r.assetCode,":").concat(r.assetIssuer,"` trustline")}),i=S.Keypair.fromSecret(n),c=new O.a.Server(a),F.a.instruction({title:"Loading account to get a sequence number for add trustline transaction"}),e.next=8,c.loadAccount(i.publicKey());case 8:return o=e.sent,F.a.instruction({title:"Building add trustline transaction"}),(u=new S.TransactionBuilder(o,{fee:S.BASE_FEE,networkPassphrase:s}).addOperation(S.Operation.changeTrust({asset:new S.Asset(r.assetCode,r.assetIssuer)})).setTimeout(0).build()).sign(i),F.a.request({title:"Submitting add trustline transaction",body:u}),e.next=15,c.submitTransaction(u);case 15:return d=e.sent,F.a.response({title:"Submitted add trustline transaction",body:d}),F.a.instruction({title:"Asset `".concat(r.assetCode,":").concat(r.assetIssuer,"` trustline added")}),e.abrupt("return",d);case 21:throw e.prev=21,e.t0=e.catch(1),l=P(e.t0),F.a.error({title:"Add trustline transaction failed",body:l}),new Error(l);case 26:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(t){return e.apply(this,arguments)}}(),ke=Object(l.c)("claimAsset/claimAssetAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f,v;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rejectWithValue,a=n.getState,s=H(a()),i=s.data,c=s.secretKey,o=x(a()),u=o.pubnet,d=M(u),l=t.assetCode,p=t.assetIssuer,b=p?"".concat(l,":").concat(p):l,F.a.instruction({title:"Claiming asset `".concat(b,"`")}),e.prev=7,"XLM"===b||(null===i||void 0===i?void 0:i.balances[b])){e.next=19;break}return F.a.instruction({title:"Not a trusted asset, need to add a trustline"}),e.prev=10,e.next=13,Ne({secretKey:c,networkPassphrase:d.network,networkUrl:d.url,untrustedAsset:{assetString:b,assetCode:l,assetIssuer:p}});case 13:h="".concat(b),e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(10),new Error(P(e.t0));case 19:return e.prev=19,e.next=22,Re({secretKey:c,balance:t,assetCode:l,networkPassphrase:d.network,networkUrl:d.url,fee:S.BASE_FEE});case 22:return f=e.sent,e.abrupt("return",{result:f,trustedAssetAdded:h});case 26:throw e.prev=26,e.t1=e.catch(19),new Error(P(e.t1));case 29:e.next=36;break;case 31:return e.prev=31,e.t2=e.catch(7),v=P(e.t2),F.a.error({title:v}),e.abrupt("return",r({errorString:v}));case 36:case"end":return e.stop()}}),e,null,[[7,31],[10,16],[19,26]])})));return function(t,n){return e.apply(this,arguments)}}()),Ie={data:{result:null,trustedAssetAdded:void 0},status:void 0,errorString:void 0},_e=Object(l.d)({name:"claimAsset",initialState:Ie,reducers:{resetClaimAssetAction:function(){return Ie}},extraReducers:function(e){e.addCase(ke.pending,(function(e){e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(ke.fulfilled,(function(e,t){e.data=t.payload,e.status=R.a.SUCCESS})),e.addCase(ke.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR}))}}),Pe=_e.reducer,De=_e.actions.resetClaimAssetAction,Ue=Object(l.c)("claimableBalances/fetchClaimableBalancesAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.publicKey,a=n.rejectWithValue,s=n.getState,i=x(s()),c=i.pubnet,o=M(c),u=new O.a.Server(o.url),e.prev=5,e.next=8,u.claimableBalances().claimant(r).call();case 8:return d=e.sent,l=[],d.records.forEach((function(e){var t,n;if(e.asset===R.e.NATIVE)t="XLM";else{var r=e.asset.split(":"),a=Object(w.a)(r,2);t=a[0],n=a[1]}var s={id:e.id,assetString:e.id,assetCode:t,assetIssuer:n,total:e.amount,sponsor:e.sponsor,lastModifiedLedger:e.last_modified_ledger,isClaimableBalance:!0,source:e};F.a.response({title:"Claimable balance of ".concat(e.amount," ").concat(t," available"),body:s}),l.push(s)})),e.abrupt("return",{records:l});case 14:return e.prev=14,e.t0=e.catch(5),p=P(e.t0),F.a.error({title:p}),e.abrupt("return",a({errorString:P(e.t0)}));case 19:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t,n){return e.apply(this,arguments)}}()),Le={data:{records:null},errorString:void 0,status:void 0},Be=Object(l.d)({name:"claimableBalances",initialState:Le,reducers:{resetClaimableBalancesAction:function(){return Le}},extraReducers:function(e){e.addCase(Ue.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le;e.status=R.a.PENDING})),e.addCase(Ue.fulfilled,(function(e,t){e.data=t.payload,e.status=R.a.SUCCESS})),e.addCase(Ue.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR}))}}),Me=Be.reducer,Fe=(Be.actions.resetClaimableBalancesAction,n(56)),Ke=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.type,r=t.transferServerUrl,a=t.assetCode,F.a.instruction({title:"Checking `/info` endpoint to ensure this currency is enabled for ".concat(n===R.b.DEPOSIT?"deposit":"withdrawal")}),s="".concat(r,"/info"),F.a.request({title:"GET `".concat(s,"`")}),e.next=6,fetch(s);case 6:return i=e.sent,e.next=9,i.json();case 9:if(c=e.sent,F.a.response({title:"GET `".concat(s,"`"),body:c}),Object(Fe.get)(c,[n,a,"enabled"])){e.next=13;break}throw new Error("Asset is not enabled in the `/info` endpoint");case 13:return e.abrupt("return",c);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ge=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.transactionId,r=t.token,a=t.transferServerUrl,s=t.trustAssetCallback,i=R.p.INCOMPLETE,o=new URL("".concat(a,"/transaction?id=").concat(n)),F.a.instruction({title:"Polling for updates `".concat(o.toString(),"`")}),u=[R.p.PENDING_EXTERNAL,R.p.COMPLETED,R.p.ERROR];case 5:if(u.includes(i)){e.next=45;break}return e.next=8,fetch(o.toString(),{headers:{Authorization:"Bearer ".concat(r)}});case 8:return d=e.sent,e.next=11,d.json();case 11:if((l=e.sent).transaction.status===i){e.next=41;break}i=l.transaction.status,F.a.instruction({title:"Transaction `".concat(n,"` is in `").concat(l.transaction.status,"` status")}),e.t0=i,e.next=e.t0===R.p.PENDING_USER_TRANSFER_START?18:e.t0===R.p.PENDING_ANCHOR?20:e.t0===R.p.PENDING_STELLAR?22:e.t0===R.p.PENDING_EXTERNAL?24:e.t0===R.p.PENDING_TRUST?26:e.t0===R.p.PENDING_USER?37:e.t0===R.p.ERROR?39:41;break;case 18:return F.a.instruction({title:"The anchor is waiting on you to take the action described in the popup"}),e.abrupt("break",41);case 20:return F.a.instruction({title:"The anchor is processing the transaction"}),e.abrupt("break",41);case 22:return F.a.instruction({title:"The Stellar network is processing the transaction"}),e.abrupt("break",41);case 24:return F.a.instruction({title:"The transaction is being processed by an external system"}),e.abrupt("break",41);case 26:return F.a.instruction({title:"You must add a trustline to the asset in order to receive your deposit"}),e.prev=27,e.next=30,s();case 30:c=e.sent,e.next=36;break;case 33:throw e.prev=33,e.t1=e.catch(27),new Error(P(e.t1));case 36:return e.abrupt("break",41);case 37:return F.a.instruction({title:"The anchor is waiting for you to take the action described in the popup"}),e.abrupt("break",41);case 39:return F.a.instruction({title:"There was a problem processing your transaction"}),e.abrupt("break",41);case 41:return e.next=43,new Promise((function(e){return setTimeout(e,2e3)}));case 43:e.next=5;break;case 45:return F.a.instruction({title:"Transaction status `".concat(i,"`")}),e.abrupt("return",{currentStatus:i,trustedAssetAdded:c});case 47:case"end":return e.stop()}}),e,null,[[27,33]])})));return function(t){return e.apply(this,arguments)}}(),Ve=n(188),We=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p,b,h,f,v,m,E,g,x,y,T,w;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.amount,r=t.secretKey,a=t.transactionId,s=t.token,i=t.transferServerUrl,c=t.networkPassphrase,o=t.networkUrl,u=t.assetCode,d=t.assetIssuer,l=S.Keypair.fromSecret(r),p=new O.a.Server(o),b=R.p.INCOMPLETE,h=new URL("".concat(i,"/transaction?id=").concat(a)),F.a.instruction({title:"Polling for updates `".concat(h.toString(),"`")}),f=[R.p.COMPLETED,R.p.ERROR],v={transaction:{}};case 8:if(f.includes(b)){e.next=52;break}return e.next=11,fetch(h.toString(),{headers:{Authorization:"Bearer ".concat(s)}});case 11:return m=e.sent,e.next=14,m.json();case 14:if((v=e.sent).transaction.status===b){e.next=48;break}b=v.transaction.status,F.a.instruction({title:"Transaction `".concat(a,"` is in `").concat(v.transaction.status,"` status")}),e.t0=b,e.next=e.t0===R.p.PENDING_USER_TRANSFER_START?21:e.t0===R.p.PENDING_ANCHOR?38:e.t0===R.p.PENDING_STELLAR?40:e.t0===R.p.PENDING_EXTERNAL?42:e.t0===R.p.PENDING_USER?44:e.t0===R.p.ERROR?46:48;break;case 21:return F.a.instruction({title:"The anchor is waiting for the funds for withdrawal"}),E=Object(Ve.a)(v.transaction.withdraw_memo,v.transaction.withdraw_memo_type),F.a.request({title:"Fetching account sequence number",body:l.publicKey()}),e.next=26,p.accounts().accountId(l.publicKey()).call();case 26:return g=e.sent,x=g.sequence,F.a.response({title:"Fetching account sequence number",body:x}),y=new S.Account(l.publicKey(),x),(T=new S.TransactionBuilder(y,{fee:S.BASE_FEE,networkPassphrase:c}).addOperation(S.Operation.payment({destination:v.transaction.withdraw_anchor_account,asset:new S.Asset(u,d),amount:n})).addMemo(E).setTimeout(0).build()).sign(l),F.a.request({title:"Submitting withdrawal transaction to Stellar",body:T}),e.next=35,p.submitTransaction(T);case 35:return w=e.sent,F.a.response({title:"Submitted withdrawal transaction to Stellar",body:w}),e.abrupt("break",48);case 38:return F.a.instruction({title:"The anchor is processing the transaction"}),e.abrupt("break",48);case 40:return F.a.instruction({title:"The Stellar network is processing the transaction"}),e.abrupt("break",48);case 42:return F.a.instruction({title:"The transaction is being processed by an external system"}),e.abrupt("break",48);case 44:return F.a.instruction({title:"The anchor is waiting for you to take the action described in the popup"}),e.abrupt("break",48);case 46:return F.a.instruction({title:"There was a problem processing your transaction"}),e.abrupt("break",48);case 48:return e.next=50,new Promise((function(e){return setTimeout(e,2e3)}));case 50:e.next=8;break;case 52:return F.a.instruction({title:"Transaction status `".concat(b,"`")}),e.abrupt("return",{currentStatus:b,transaction:v.transaction});case 54:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qe=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p,b,h,f,v;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.amount,r=void 0===n?"":n,a=t.assetCode,s=t.publicKey,i=t.transferServerUrl,c=t.token,o=t.type,u=t.depositFields,d=t.claimableBalanceSupported,F.a.instruction({title:"Starting SEP-6 programmatic flow for deposit"}),l="GET",p="".concat(i,"/deposit"),b=new URL(p),h=Object(E.a)({asset_code:a,account:s,claimable_balance_supported:d.toString(),type:o,amount:r},u),Object(Fe.each)(h,(function(e,t){return b.searchParams.append(t,e)})),F.a.request({title:"".concat(l," `").concat(p,"`"),body:h}),e.next=10,fetch("".concat(b),{method:l,headers:{Authorization:"Bearer ".concat(c)}});case 10:return f=e.sent,e.next=13,f.json();case 13:return v=e.sent,F.a.response({title:"".concat(l," `").concat(p,"`"),body:v}),e.abrupt("return",v);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),He=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p,b,h;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.assetCode,r=t.publicKey,a=t.transferServerUrl,s=t.token,i=t.type,c=t.withdrawFields,o=t.claimableBalanceSupported,F.a.instruction({title:"Starting SEP-6 programmatic flow for withdrawal"}),u="GET",d="".concat(a,"/withdraw"),l=new URL(d),p=Object(E.a)({asset_code:n,account:r,claimable_balance_supported:o.toString(),type:i},c),Object(Fe.each)(p,(function(e,t){return l.searchParams.append(t,e)})),F.a.request({title:"".concat(u," `").concat(d,"`"),body:p}),e.next=10,fetch("".concat(l),{method:u,headers:{Authorization:"Bearer ".concat(s)}});case 10:return b=e.sent,e.next=13,b.json();case 13:if(h=e.sent,200===b.status){e.next=16;break}throw new Error(h.error);case 16:return F.a.response({title:"".concat(u," `").concat(d,"`"),body:h}),e.abrupt("return",h);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ye=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.authEndpoint,r=t.serverSigningKey,a=t.publicKey,s=t.homeDomain,i={account:a,home_domain:s},F.a.instruction({title:"Starting the SEP-10 flow to authenticate the sending anchor\u2019s Stellar account"}),F.a.request({title:"GET `/auth`",body:i}),c=new URL(n),Object.entries(i).forEach((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];c.searchParams.append(n,r)})),e.next=8,fetch(c.toString());case 8:return o=e.sent,e.next=11,o.json();case 11:if(u=e.sent,F.a.response({title:"GET `/auth`",body:u}),u.transaction){e.next=15;break}throw new Error("The response didn\u2019t contain a transaction");case 15:return d=S.Utils.readChallengeTx(u.transaction,r,u.network_passphrase,s,c.host),l=d.tx,e.abrupt("return",l);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Xe=function(e){var t=e.challengeTransaction,n=e.networkPassphrase,r=e.secretKey;F.a.instruction({title:"We\u2019ve received a challenge transaction from the server that we need the sending anchor to sign with their Stellar private key"});var a=t.toEnvelope().toXDR("base64"),s=new S.Transaction(a,n);return s.sign(S.Keypair.fromSecret(r)),F.a.instruction({title:"SEP-10 signed transaction",body:s}),F.a.instruction({title:"SEP-10 signed transaction, `base64` encoded",body:s.toEnvelope().toXDR("base64")}),s},Qe=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.authEndpoint,r=t.signedChallengeTransaction,a={transaction:r.toEnvelope().toXDR("base64")},F.a.instruction({title:"We need to send the signed SEP-10 challenge back to the server to get a JWT token to authenticate our Stellar account with future actions"}),F.a.request({title:"POST `/auth`",body:a}),s=new URLSearchParams(a),e.next=7,fetch(n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s.toString()});case 7:return i=e.sent,e.next=10,i.json();case 10:if(c=e.sent,F.a.response({title:"POST `/auth`",body:c}),c.token){e.next=14;break}throw new Error("No token returned from `/auth`");case 14:return e.abrupt("return",c.token);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ze=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p,b;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.kycServer,a=t.memo,s=t.publicKey,i=t.token,c=t.type,o=t.isNewCustomer,u=Object(E.a)(Object(E.a)({},c?{type:c}:{}),{},{account:s},a?{memo:a,memo_type:"hash"}:{}),F.a.request({title:"GET `/customer`",body:u}),d=new URLSearchParams(u),e.next=6,fetch("".concat(r,"/customer?").concat(d.toString()),{method:"GET",headers:{Authorization:"Bearer ".concat(i),Origin:"https://demo-wallet.stellar.org"}});case 6:return l=e.sent,e.next=9,l.json();case 9:if(p=e.sent,F.a.response({title:"GET `/customer`",body:p}),!o||p.status===R.k.NEEDS_INFO){e.next=13;break}throw new Error("Unexpected status for new customer `".concat(p.status,"`"));case 13:return b=Object.entries(null!==(n=p.fields)&&void 0!==n?n:{}).reduce((function(e,t){var n=Object(w.a)(t,2),r=n[0],a=n[1];return!a.status||a.status===R.j.NOT_PROVIDED||a.status===R.j.REJECTED&&p.status===R.k.NEEDS_INFO?Object(E.a)(Object(E.a)({},e),{},Object(ae.a)({},r,a)):e}),{}),p.fields&&F.a.instruction({title:"Received the following customer fields",body:p.fields}),Object.keys(b).length?F.a.instruction({title:"The following customer fields must be submitted",body:b}):F.a.instruction({title:"No customer fields need to be submitted"}),e.abrupt("return",b);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Je=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.secretKey,r=t.fields,a=t.memo,s=t.token,i=t.kycServer,c=t.isSender,o=S.Keypair.fromSecret(n).publicKey(),u=Object(E.a)(Object(E.a)({account:o},a?{memo:a,memo_type:"hash"}:{}),r),F.a.request({title:"PUT `/customer`",body:u}),d=new FormData,Object.entries(u).forEach((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];d.append(n,r.toString())})),e.next=8,fetch("".concat(i,"/customer"),{headers:{Authorization:"Bearer ".concat(s)},method:"PUT",body:d});case 8:return l=e.sent,e.next=11,l.json();case 11:if(p=e.sent,void 0!==c?F.a.response({title:"PUT `/customer` (".concat(c?"sender":"receiver",")"),body:p}):F.a.response({title:"PUT `/customer`",body:p}),202===l.status){e.next=15;break}throw new Error("Unexpected status for PUT `/customer` request: ".concat(l.status));case 15:return e.abrupt("return",p);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ze=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.assetIssuer,r=t.networkUrl,F.a.request({title:"Getting home domain from asset issuer",body:"Asset issuer ".concat(n)}),a=new O.a.Server(r),e.next=5,a.loadAccount(n);case 5:if(s=e.sent,i=s.home_domain){e.next=9;break}throw new Error("Asset issuer ".concat(n," does not have home domain configured"));case 9:return F.a.response({title:"Received home domain from asset issuer",body:"Asset issuer ".concat(n,", home domain ").concat(i,".")}),e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$e=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sepName,r=t.assetIssuer,a=t.requiredKeys,s=t.networkUrl,i=t.homeDomain,c=i){e.next=6;break}return e.next=5,Ze({assetIssuer:r,networkUrl:s});case 5:c=e.sent;case 6:return F.a.instruction({title:"Checking the `stellar.toml` to find the necessary information for the ".concat(n," transaction")}),e.next=9,C(c);case 9:if(o=e.sent,u=[],d=a.reduce((function(e,t){return o[t]?(F.a.instruction({title:"Received `".concat(t,"` from TOML"),body:o[t]}),Object(E.a)(Object(E.a)({},e),{},Object(ae.a)({},t,o[t].replace(/\/$/,"")))):(u.push("`".concat(t,"`")),e)}),{}),!u.length){e.next=14;break}throw new Error("TOML must contain a ".concat(u.join(", ")," for ").concat(n," transaction"));case 14:return e.abrupt("return",d);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),et=Object(l.c)("sep6DepositAsset/initiateDepositAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f,v,m,S,O,g,y,T,w,A,C,N,k,I,_;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rejectWithValue,a=n.getState,s=t.assetCode,i=t.assetIssuer,c=t.homeDomain,o=H(a()),u=o.data,d=o.secretKey,l=x(a()),p=l.pubnet,b=M(p),h=null===u||void 0===u?void 0:u.id){e.next=8;break}throw new Error("Something is wrong with Account, no public key.");case 8:if(c){e.next=10;break}throw new Error("Something went wrong, home domain is not defined.");case 10:return F.a.instruction({title:"Initiating a SEP-6 deposit"}),e.prev=11,e.next=14,$e({sepName:"SEP-6 deposit",assetIssuer:i,requiredKeys:[R.o.TRANSFER_SERVER],networkUrl:b.url,homeDomain:c});case 14:return f=e.sent,e.next=17,Ke({type:R.b.DEPOSIT,transferServerUrl:f.TRANSFER_SERVER,assetCode:s});case 17:if(v=e.sent,m=v[R.b.DEPOSIT][s],S=m.authentication_required,O=m.min_amount,g=void 0===O?0:O,y=m.max_amount,T=void 0===y?0:y,w={assetCode:s,assetIssuer:i,infoFields:Object(E.a)({},m.fields),minAmount:g,maxAmount:T,customerFields:{},kycServer:"",status:R.a.NEEDS_INPUT,token:"",transferServerUrl:f.TRANSFER_SERVER},!S){e.next=39;break}return e.next=24,$e({sepName:"SEP-6 deposit",assetIssuer:i,requiredKeys:[R.o.WEB_AUTH_ENDPOINT,R.o.SIGNING_KEY,R.o.KYC_SERVER],networkUrl:b.url,homeDomain:c});case 24:return A=e.sent,F.a.instruction({title:"SEP-6 deposit is enabled, and requires authentication so we should go through SEP-10"}),e.next=28,Ye({authEndpoint:A.WEB_AUTH_ENDPOINT,serverSigningKey:A.SIGNING_KEY,publicKey:h,homeDomain:c});case 28:return C=e.sent,N=Xe({secretKey:d,networkPassphrase:b.network,challengeTransaction:C}),e.next=32,Qe({authEndpoint:A.WEB_AUTH_ENDPOINT,signedChallengeTransaction:N});case 32:return k=e.sent,F.a.instruction({title:"Making GET `/customer` request for user"}),e.next=36,ze({publicKey:h,token:k,kycServer:A.KYC_SERVER});case 36:I=e.sent,w=Object(E.a)(Object(E.a)({},w),{},{kycServer:A.KYC_SERVER,token:k}),I&&(w=Object(E.a)(Object(E.a)({},w),{},{customerFields:Object(E.a)(Object(E.a)({},w.customerFields),I)}));case 39:return e.abrupt("return",w);case 42:return e.prev=42,e.t0=e.catch(11),_=P(e.t0),F.a.error({title:"SEP-6 deposit failed",body:_}),e.abrupt("return",r({errorString:_}));case 47:case"end":return e.stop()}}),e,null,[[11,42]])})));return function(t,n){return e.apply(this,arguments)}}()),tt=Object(l.c)("sep6DepositAsset/submitSep6DepositFields",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f,v,m,S,O,E,g,y,T;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.amount,a=t.depositType,s=t.customerFields,i=t.infoFields,c=n.rejectWithValue,o=n.getState,e.prev=2,u=H(o()),d=u.data,l=x(o()),p=l.claimableBalanceSupported,b=(null===d||void 0===d?void 0:d.id)||"",h=H(o()),f=h.secretKey,v=st(o()),m=v.data,S=m.assetCode,O=m.kycServer,E=m.transferServerUrl,g=m.token,!Object.keys(s).length){e.next=12;break}return e.next=12,Je({fields:s,kycServer:O,secretKey:f,token:g});case 12:return e.next=14,qe({amount:r,assetCode:S,publicKey:b,transferServerUrl:E,token:g,type:a.type,depositFields:i,claimableBalanceSupported:p});case 14:return y=e.sent,e.abrupt("return",{status:R.a.CAN_PROCEED,depositResponse:y});case 18:return e.prev=18,e.t0=e.catch(2),T=P(e.t0),F.a.error({title:T}),e.abrupt("return",c({errorString:T}));case 23:case"end":return e.stop()}}),e,null,[[2,18]])})));return function(t,n){return e.apply(this,arguments)}}()),nt=Object(l.c)("sep6DepositAsset/sep6DepositAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f,m,S,O,E,g,y,T,w;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,a=n.getState,e.prev=1,s=H(a()),i=s.secretKey,c=x(a()),o=c.pubnet,u=M(o),d=st(a()),l=d.data,p=l.assetCode,b=l.assetIssuer,h=l.depositResponse,f=l.transferServerUrl,m=l.token,S=function(){var e=Object(v.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(p,":").concat(b),e.next=3,Ne({secretKey:i,networkPassphrase:u.network,networkUrl:u.url,untrustedAsset:{assetString:t,assetCode:p,assetIssuer:b}});case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=10,Ge({transactionId:h.id||"",token:m,transferServerUrl:f,trustAssetCallback:S});case 10:return O=e.sent,E=O.currentStatus,g=void 0===E?"":E,y=O.trustedAssetAdded,T=void 0===y?"":y,e.abrupt("return",{currentStatus:g,status:R.a.SUCCESS,trustedAssetAdded:T});case 18:return e.prev=18,e.t0=e.catch(1),w=P(e.t0),F.a.error({title:"SEP-6 deposit failed",body:w}),e.abrupt("return",r({errorString:w}));case 23:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(t,n){return e.apply(this,arguments)}}()),rt={data:{assetCode:"",assetIssuer:"",currentStatus:"",customerFields:{},depositResponse:{how:""},infoFields:{type:{choices:[]}},minAmount:0,maxAmount:0,kycServer:"",token:"",transferServerUrl:"",trustedAssetAdded:""},status:"",errorString:void 0},at=Object(l.d)({name:"sep6DepositAsset",initialState:rt,reducers:{resetSep6DepositAction:function(){return rt}},extraReducers:function(e){e.addCase(et.pending,(function(e){e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(et.fulfilled,(function(e,t){e.data=Object(E.a)(Object(E.a)({},e.data),t.payload),e.status=t.payload.status})),e.addCase(et.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR})),e.addCase(tt.pending,(function(e){e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(tt.fulfilled,(function(e,t){e.status=t.payload.status,e.data.depositResponse=t.payload.depositResponse})),e.addCase(tt.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR})),e.addCase(nt.pending,(function(e){e.status=R.a.PENDING})),e.addCase(nt.fulfilled,(function(e,t){e.status=t.payload.status,e.data.currentStatus=t.payload.currentStatus,e.data.trustedAssetAdded=t.payload.trustedAssetAdded})),e.addCase(nt.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR}))}}),st=function(e){return e.sep6DepositAsset},it=at.reducer,ct=at.actions.resetSep6DepositAction,ot=Object(l.c)("sep6WithdrawAsset/initiateWithdrawAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f,v,m,S,O,g,y,T,w,A,C;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rejectWithValue,a=n.getState,s=t.assetCode,i=t.assetIssuer,c=t.homeDomain,o=H(a()),u=o.data,d=o.secretKey,l=x(a()),p=l.pubnet,b=M(p),h=null===u||void 0===u?void 0:u.id){e.next=8;break}throw new Error("Something is wrong with Account, no public key.");case 8:if(c){e.next=10;break}throw new Error("Something went wrong, home domain is not defined.");case 10:return F.a.instruction({title:"Initiating a SEP-6 withdrawal"}),e.prev=11,e.next=14,$e({sepName:"SEP-6 withdrawal",assetIssuer:i,requiredKeys:[R.o.TRANSFER_SERVER],networkUrl:b.url,homeDomain:c});case 14:return f=e.sent,e.next=17,Ke({type:R.b.WITHDRAWAL,transferServerUrl:f.TRANSFER_SERVER,assetCode:s});case 17:if(v=e.sent,m=v[R.b.WITHDRAWAL][s],S=m.authentication_required,O={assetCode:s,assetIssuer:i,withdrawTypes:{types:Object(E.a)({},m.types)},fields:{},kycServer:"",status:R.a.NEEDS_INPUT,token:"",transferServerUrl:f.TRANSFER_SERVER},!S){e.next=39;break}return e.next=24,$e({sepName:"SEP-6 withdrawal",assetIssuer:i,requiredKeys:[R.o.WEB_AUTH_ENDPOINT,R.o.SIGNING_KEY,R.o.KYC_SERVER],networkUrl:b.url,homeDomain:c});case 24:return g=e.sent,F.a.instruction({title:"SEP-6 withdrawal is enabled, and requires authentication so we should go through SEP-10"}),e.next=28,Ye({authEndpoint:g.WEB_AUTH_ENDPOINT,serverSigningKey:g.SIGNING_KEY,publicKey:h,homeDomain:c});case 28:return y=e.sent,T=Xe({secretKey:d,networkPassphrase:b.network,challengeTransaction:y}),e.next=32,Qe({authEndpoint:g.WEB_AUTH_ENDPOINT,signedChallengeTransaction:T});case 32:return w=e.sent,F.a.instruction({title:"Making GET `/customer` request for user"}),e.next=36,ze({publicKey:h,token:w,kycServer:g.KYC_SERVER});case 36:A=e.sent,O=Object(E.a)(Object(E.a)({},O),{},{kycServer:g.KYC_SERVER,token:w}),A&&(O=Object(E.a)(Object(E.a)({},O),{},{fields:Object(E.a)(Object(E.a)({},O.fields),A)}));case 39:return e.abrupt("return",O);case 42:return e.prev=42,e.t0=e.catch(11),C=P(e.t0),F.a.error({title:"SEP-6 withdrawal failed",body:C}),e.abrupt("return",r({errorString:C}));case 47:case"end":return e.stop()}}),e,null,[[11,42]])})));return function(t,n){return e.apply(this,arguments)}}()),ut=Object(l.c)("sep6WithdrawAsset/submitSep6WithdrawFields",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f,v,m,S,O,E,g;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.withdrawType,a=t.infoFields,s=t.customerFields,i=n.rejectWithValue,c=n.getState,e.prev=2,o=H(c()),u=o.data,d=o.secretKey,l=x(c()),p=l.claimableBalanceSupported,b=(null===u||void 0===u?void 0:u.id)||"",h=bt(c()),f=h.data,v=f.assetCode,m=f.kycServer,S=f.transferServerUrl,O=f.token,!Object.keys(s).length){e.next=11;break}return e.next=11,Je({fields:s,kycServer:m,secretKey:d,token:O});case 11:return e.next=13,He({assetCode:v,publicKey:b,transferServerUrl:S,token:O,type:r.type,withdrawFields:a,claimableBalanceSupported:p});case 13:return E=e.sent,e.abrupt("return",{status:R.a.CAN_PROCEED,withdrawResponse:E});case 17:return e.prev=17,e.t0=e.catch(2),g=P(e.t0),F.a.error({title:g}),e.abrupt("return",i({errorString:g}));case 22:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t,n){return e.apply(this,arguments)}}()),dt=Object(l.c)("sep6WithdrawAsset/sep6WithdrawAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f,v,m,S,O,E;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,a=n.getState,e.prev=1,s=H(a()),i=s.secretKey,c=x(a()),o=c.pubnet,u=M(o),d=bt(a()),l=d.data,p=l.assetCode,b=l.assetIssuer,h=l.transferServerUrl,f=l.token,v=l.withdrawResponse,e.next=9,We({amount:t,secretKey:i,transactionId:(null===v||void 0===v?void 0:v.id)||"",token:f,transferServerUrl:h,networkPassphrase:u.network,networkUrl:u.url,assetCode:p,assetIssuer:b});case 9:return m=e.sent,S=m.currentStatus,O=m.transaction,e.abrupt("return",{currentStatus:S,transactionResponse:O,status:R.a.SUCCESS});case 15:return e.prev=15,e.t0=e.catch(1),E=P(e.t0),F.a.error({title:"SEP-6 withdrawal failed",body:E}),e.abrupt("return",r({errorString:E}));case 20:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t,n){return e.apply(this,arguments)}}()),lt={data:{assetCode:"",assetIssuer:"",currentStatus:"",withdrawTypes:{types:{}},fields:{},kycServer:"",transferServerUrl:"",trustedAssetAdded:"",token:"",transactionResponse:{},withdrawResponse:{account_id:""}},status:void 0,errorString:void 0},pt=Object(l.d)({name:"sep6WithdrawAsset",initialState:lt,reducers:{resetSep6WithdrawAction:function(){return lt}},extraReducers:function(e){e.addCase(ot.pending,(function(e){e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(ot.fulfilled,(function(e,t){e.data=Object(E.a)(Object(E.a)({},e.data),t.payload),e.status=t.payload.status})),e.addCase(ot.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR})),e.addCase(ut.pending,(function(e){e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(ut.fulfilled,(function(e,t){e.status=t.payload.status,e.data.withdrawResponse=t.payload.withdrawResponse})),e.addCase(ut.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR})),e.addCase(dt.pending,(function(e){e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(dt.fulfilled,(function(e,t){e.status=t.payload.status,e.data.currentStatus=t.payload.currentStatus,e.data.transactionResponse=t.payload.transactionResponse})),e.addCase(dt.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.NEEDS_INPUT}))}}),bt=function(e){return e.sep6WithdrawAsset},ht=pt.reducer,ft=pt.actions.resetSep6WithdrawAction,jt=function(e){var t,n=e.currentStep,r=e.approvalStatus,a=e.didUndergoKyc;return(t={},Object(ae.a)(t,R.n.DISABLED,R.n.STARTING),Object(ae.a)(t,R.n.STARTING,vt({currentStep:n,approvalStatus:r})),Object(ae.a)(t,R.n.PENDING,R.n.DISABLED),Object(ae.a)(t,R.n.TRANSACTION_REVISED,R.n.COMPLETE),Object(ae.a)(t,R.n.ACTION_REQUIRED,R.n.SENT_ACTION_REQUIRED_FIELDS),Object(ae.a)(t,R.n.SENT_ACTION_REQUIRED_FIELDS,a?vt({currentStep:n,approvalStatus:r}):R.n.STARTING),Object(ae.a)(t,R.n.COMPLETE,R.n.DISABLED),t)[n]},vt=function(e){var t,n=e.currentStep,r=e.approvalStatus;return(t={},Object(ae.a)(t,R.m.ACTION_REQUIRED,R.n.ACTION_REQUIRED),Object(ae.a)(t,R.m.PENDING,R.n.PENDING),Object(ae.a)(t,R.m.REVISED,R.n.TRANSACTION_REVISED),Object(ae.a)(t,R.m.SUCCESS,R.n.TRANSACTION_REVISED),Object(ae.a)(t,R.m.REJECTED,n),t)[r]};!function(e){e.STRING="string",e.COUNTRY_CODE="country_code",e.PHONE_NUMBER="phone number",e.DATE="date",e.NUMBER="number",e.BINARY="binary",e.LANGUAGE_CODE="language_code"}(L||(L={}));var mt=[{name:"family_name",type:L.STRING,description:"Family name"},{name:"last_name",type:L.STRING,description:"Last name"},{name:"given_name",type:L.STRING,description:"Given name"},{name:"first_name",type:L.STRING,description:"First name"},{name:"additional_name",type:L.STRING,description:"Middle name or other additional name"},{name:"address_country_code",type:L.COUNTRY_CODE,description:"Country code for current address"},{name:"state_or_province",type:L.STRING,description:"Name of state/province/region/prefecture"},{name:"city",type:L.STRING,description:"Name of city/town"},{name:"postal_code",type:L.STRING,description:"Postal or other code identifying user's locale"},{name:"address",type:L.STRING,description:"Entire address (country, state, postal code, street address, etc...) as a multi-line string"},{name:"mobile_number",type:L.PHONE_NUMBER,description:"Mobile phone number with country code, in E.164 format"},{name:"email_address",type:L.STRING,description:"Email address"},{name:"birth_date",type:L.DATE,description:"Date of birth, e.g. 1976-07-04"},{name:"birth_place",type:L.STRING,description:"Place of birth (city, state, country; as on passport)"},{name:"birth_country_code",type:L.COUNTRY_CODE,description:"ISO Code of country of birth"},{name:"bank_account_number",type:L.STRING,description:"Number identifying bank account"},{name:"bank_number",type:L.STRING,description:"Number identifying bank in national banking system (routing number in US)"},{name:"bank_phone_number",type:L.STRING,description:"Phone number with country code for bank"},{name:"bank_branch_number",type:L.STRING,description:"Number identifying bank branch"},{name:"tax_id",type:L.STRING,description:"Tax identifier of user in their country (social security number in US)"},{name:"tax_id_name",type:L.STRING,description:"Name of the tax ID (SSN or ITIN in the US)"},{name:"occupation",type:L.NUMBER,description:"Occupation ISCO code"},{name:"employer_name",type:L.STRING,description:"Name of employer"},{name:"employer_address",type:L.STRING,description:"Address of employer"},{name:"language_code",type:L.LANGUAGE_CODE,description:"Primary language"},{name:"id_type",type:L.STRING,description:"Passport, drivers_license, id_card, etc..."},{name:"id_country_code",type:L.COUNTRY_CODE,description:"Country issuing passport or photo ID as ISO 3166-1 alpha-3 code"},{name:"id_issue_date",type:L.DATE,description:"ID issue date"},{name:"id_expiration_date",type:L.DATE,description:"ID expiration date"},{name:"id_number",type:L.STRING,description:"Passport or ID number"},{name:"photo_id_front",type:L.BINARY,description:"Image of front of user's photo ID or passport"},{name:"photo_id_back",type:L.BINARY,description:"Image of back of user's photo ID or passport"},{name:"notary_approval_of_photo_id",type:L.BINARY,description:"Image of notary's approval of photo ID or passport"},{name:"ip_address",type:L.STRING,description:"IP address of customer's computer"},{name:"photo_proof_residence",type:L.BINARY,description:"Image of a utility bill, bank statement or similar with the user's name and address"}].reduce((function(e,t){return Object(E.a)(Object(E.a)({},e),{},Object(ae.a)({},t.name,t))}),{}),St=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.isPubnet,r=t.params,a=t.secretKey,s=new O.a.Server(M(n).url),F.a.instruction({title:"Sending payment of ".concat(r.amount," ").concat(r.assetCode),body:"Destination: ".concat(r.destination)}),e.prev=3,e.next=6,Ot({isPubnet:n,params:r,server:s});case 6:i=e.sent,e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(3),new Error("Failed to build transaction, error: ".concat(U(e.t0)));case 12:return e.prev=12,c=S.Keypair.fromSecret(a),e.next=16,i.sign(c);case 16:e.next=21;break;case 18:throw e.prev=18,e.t1=e.catch(12),new Error("Failed to sign transaction, error: ".concat(U(e.t1)));case 21:return F.a.request({title:"Submitting send payment transaction",body:i}),e.next=24,s.submitTransaction(i);case 24:return o=e.sent,F.a.response({title:"Submitted send payment transaction",body:o}),F.a.instruction({title:"Payment of ".concat(r.amount," ").concat(r.assetCode," sent"),body:"Destination: ".concat(r.destination)}),e.abrupt("return",o);case 28:case"end":return e.stop()}}),e,null,[[3,9],[12,18]])})));return function(t){return e.apply(this,arguments)}}(),Ot=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p,b,h,f,v;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.isPubnet,r=t.params,a=t.server,F.a.instruction({title:"Building send payment transaction"}),e.prev=2,i=r.destination,c=r.isDestinationFunded,o=r.amount,u=r.assetCode,d=r.assetIssuer,l=r.publicKey,e.next=6,a.loadAccount(l);case 6:return p=e.sent,b=p.sequence,e.next=10,new O.a.Account(l,b);case 10:return h=e.sent,c?(v=u&&"XLM"!==u?new O.a.Asset(u,d):O.a.Asset.native(),f=O.a.Operation.payment({destination:i,asset:v,amount:o.toString(),withMuxing:!0})):(F.a.instruction({title:"Destination account does not exist, we are creating and funding it"}),f=O.a.Operation.createAccount({destination:i,startingBalance:o.toString()})),e.t0=O.a.TransactionBuilder,e.t1=h,e.t2=S.BASE_FEE,e.t3=M(n).network,e.next=18,a.fetchTimebounds(100);case 18:e.t4=e.sent,e.t5={fee:e.t2,networkPassphrase:e.t3,timebounds:e.t4},s=(s=new e.t0(e.t1,e.t5).addOperation(f)).build(),e.next=27;break;case 24:throw e.prev=24,e.t6=e.catch(2),new Error(P(e.t6));case 27:return e.abrupt("return",s);case 28:case"end":return e.stop()}}),e,null,[[2,24]])})));return function(t){return e.apply(this,arguments)}}(),Et=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p,b,h,f;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.isPubnet,r=t.params,a=new O.a.Server(M(n).url),s=r.approvalServer,e.prev=3,e.next=6,Ot({isPubnet:n,params:r,server:a});case 6:i=e.sent,e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(3),new Error("Failed to build transaction, error: ".concat(U(e.t0)));case 12:return F.a.request({title:"Authorizing SEP-8 payment of ".concat(r.amount," ").concat(r.assetCode),body:"Destination: ".concat(r.destination)}),c=i.toEnvelope().toXDR("base64"),e.next=16,fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tx:c})});case 16:return o=e.sent,e.next=19,o.json();case 19:u=e.sent,e.t1=u.status,e.next=e.t1===R.m.ACTION_REQUIRED?23:e.t1===R.m.PENDING?27:e.t1===R.m.REJECTED?33:e.t1===R.m.REVISED||e.t1===R.m.SUCCESS?34:36;break;case 23:return F.a.response({title:"Action Required",body:"Additional information is needed before we can proceed."}),F.a.instruction({title:u.message}),p=null===(d=u.action_fields)||void 0===d?void 0:d.map((function(e){return mt[e]})),e.abrupt("return",{status:R.m.ACTION_REQUIRED,actionRequiredInfo:{actionFields:p,actionMethod:null!==(l=u.action_method)&&void 0!==l?l:"GET",actionUrl:u.action_url,message:u.message},revisedTransaction:{amount:r.amount,destination:r.destination,submittedTxXdr:c,revisedTxXdr:""}});case 27:return b="The issuer could not determine whether to approve the transaction at this time.",(h=u.timeout)&&(f=new Date(h).toLocaleString(),b+=" You can re-submit the same transaction on ".concat(f,".")),F.a.response({title:"Authorization Pending",body:b}),u.message&&F.a.instruction({title:u.message}),e.abrupt("return",{status:u.status});case 33:throw new Error(u.error);case 34:return F.a.response({title:"Payment transaction revised and authorized \ud83c\udf89.",body:u.message}),e.abrupt("return",{status:u.status,revisedTransaction:{amount:r.amount,destination:r.destination,submittedTxXdr:c,revisedTxXdr:u.tx}});case 36:throw new Error('The SEP-8 flow for "'.concat(u.status,'" status is not supported yet.'));case 37:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),gt=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.actionFields,a=t.actionMethod,s=t.actionUrl,F.a.request({title:"Sending action required fields to SEP-8 server with `".concat(a," ").concat(s,"`"),body:r}),i="application/json",c=JSON.stringify(r),Object.keys(r).some((function(e){return mt[e].type===L.BINARY}))&&(i="multipart/form-data",o=new FormData,Object.entries(r).forEach((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return o.append(n,r)})),c=o),e.next=8,fetch(s,{method:a,headers:{"Content-Type":i},body:c});case 8:return u=e.sent,e.next=11,u.json();case 11:d=e.sent,e.t0=d.result,e.next=e.t0===R.l.NO_FURTHER_ACTION_REQUIRED?15:e.t0===R.l.FOLLOW_NEXT_URL?17:22;break;case 15:return l={result:R.l.NO_FURTHER_ACTION_REQUIRED},e.abrupt("break",23);case 17:if(d.next_url){e.next=19;break}throw new Error('Missing "next_url" parameter.');case 19:return l={result:R.l.FOLLOW_NEXT_URL,nextUrl:d.next_url},d.message&&(l.message=d.message),e.abrupt("break",23);case 22:throw new Error("Unexpected result: ".concat(JSON.stringify(d)));case 23:return F.a.response({title:"Action Required Response",body:d}),p=d.result===R.l.NO_FURTHER_ACTION_REQUIRED?"The SEP-8 server received your information, re-submitting the SEP-8 payment...":"The SEP-8 server received your information, re-submit the SEP-8 payment.",F.a.instruction({title:null!==(n=l.message)&&void 0!==n?n:p}),e.abrupt("return",l);case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xt=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.amount,r=t.assetCode,a=t.destination,s=t.isPubnet,i=t.revisedTxXdr,c=t.secretKey,o=M(s),u=new O.a.Server(o.url),d=S.TransactionBuilder.fromXDR(i,o.network),e.prev=4,l=S.Keypair.fromSecret(c),d.sign(l),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(4),new Error("Failed to sign transaction, error: ".concat(U(e.t0)));case 12:return F.a.request({title:"Submitting send payment transaction",body:d}),e.next=15,u.submitTransaction(d);case 15:return p=e.sent,F.a.response({title:"Submitted send payment transaction",body:p}),F.a.instruction({title:"SEP-8 send payment completed \ud83c\udf89",body:"Payment of ".concat(n," ").concat(r," successfully sent to ").concat(a,".")}),e.abrupt("return",p);case 19:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(t){return e.apply(this,arguments)}}(),yt=Object(l.c)("sep8Send/initiateSep8SendAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rejectWithValue,a=t.assetCode,s=t.assetIssuer,i=t.homeDomain,e.prev=2,i){e.next=5;break}throw new Error("Something went wrong, home domain is not defined.");case 5:return e.next=7,C(i);case 7:if(c=e.sent,o=c.CURRENCIES.find((function(e){return e.code===a&&e.issuer===s}))){e.next=11;break}throw new Error("Couldn't find the desired asset in the anchor toml file.");case 11:if(u=o.approval_criteria,d=o.approval_server,l=o.regulated,u){e.next=14;break}throw new Error("The anchor toml file does not contain an approval criteria.");case 14:if(d){e.next=16;break}throw new Error("The anchor toml file does not contain an approval server.");case 16:if(l){e.next=18;break}throw new Error('The anchor toml file does not specify this asset as "regulated".');case 18:return e.abrupt("return",{approvalCriteria:u,approvalServer:d,assetCode:a,assetIssuer:s,homeDomain:i,isRegulated:l});case 21:return e.prev=21,e.t0=e.catch(2),p=P(e.t0),F.a.error({title:p}),e.abrupt("return",r({errorString:p}));case 26:case"end":return e.stop()}}),e,null,[[2,21]])})));return function(t,n){return e.apply(this,arguments)}}()),Tt=Object(l.c)("sep8Send/sep8ReviseTransactionAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,a=n.getState,s=x(a()),i=s.pubnet,e.prev=2,e.next=5,Et({params:t,isPubnet:i});case 5:return c=e.sent,e.abrupt("return",c);case 9:return e.prev=9,e.t0=e.catch(2),o=U(e.t0),F.a.error({title:o}),e.abrupt("return",r({errorString:o}));case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}()),wt=Object(l.c)("sep8Send/sep8SubmitRevisedTransactionAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,a=n.getState,s=x(a()),i=s.pubnet,c=s.secretKey,o=Nt(a()),u=o.data,d=u.revisedTransaction,l=d.amount,p=d.destination,b=d.revisedTxXdr,e.prev=4,e.next=7,xt({amount:l,destination:p,assetCode:u.assetCode,revisedTxXdr:b,isPubnet:i,secretKey:c});case 7:return h=e.sent,e.abrupt("return",h);case 11:return e.prev=11,e.t0=e.catch(4),f=U(e.t0),F.a.error({title:f}),e.abrupt("return",r({errorString:f}));case 16:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t,n){return e.apply(this,arguments)}}()),At=Object(l.c)("sep8Send/sep8SendActionRequiredFieldsAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,a=t.actionFields,s=t.actionMethod,i=t.actionUrl,e.prev=2,e.next=5,gt({actionFields:a,actionMethod:s,actionUrl:i});case 5:return c=e.sent,e.abrupt("return",c);case 9:return e.prev=9,e.t0=e.catch(2),o=U(e.t0),F.a.error({title:o}),e.abrupt("return",r({errorString:o}));case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}()),Ct={data:{sep8Step:R.n.DISABLED,approvalCriteria:"",approvalServer:"",assetCode:"",assetIssuer:"",homeDomain:"",isRegulated:!1,revisedTransaction:{amount:"",destination:"",submittedTxXdr:"",revisedTxXdr:""},actionRequiredInfo:{actionFields:[],actionMethod:"",actionUrl:"",message:""},actionRequiredResult:{result:"",nextUrl:void 0,message:void 0}},errorString:void 0,status:void 0},Rt=Object(l.d)({name:"sep8Send",initialState:Ct,reducers:{resetSep8SendAction:function(){return Ct},sep8ClearErrorAction:function(e){return Object(E.a)(Object(E.a)({},e),{},{errorString:void 0})}},extraReducers:function(e){e.addCase(yt.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ct;e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(yt.fulfilled,(function(e,t){e.data=Object(E.a)(Object(E.a)(Object(E.a)({},e.data),t.payload),{},{sep8Step:jt({currentStep:e.data.sep8Step})}),e.status=R.a.SUCCESS})),e.addCase(yt.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR})),e.addCase(Tt.pending,(function(e){e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(Tt.fulfilled,(function(e,t){switch(t.payload.status){case R.m.ACTION_REQUIRED:var n=t.payload,r=n.actionRequiredInfo,a=n.revisedTransaction;e.data=Object(E.a)(Object(E.a)({},e.data),{},{actionRequiredInfo:null!==r&&void 0!==r?r:e.data.actionRequiredInfo,revisedTransaction:null!==a&&void 0!==a?a:e.data.revisedTransaction});break;case R.m.PENDING:break;case R.m.REVISED:case R.m.SUCCESS:t.payload.revisedTransaction&&(e.data=Object(E.a)(Object(E.a)({},e.data),{},{revisedTransaction:t.payload.revisedTransaction}));break;default:e.errorString='The SEP-8 flow for "'.concat(t.payload.status,'" status is not supported yet.')}e.status=R.a.SUCCESS,e.data.sep8Step=jt({approvalStatus:t.payload.status,currentStep:e.data.sep8Step,didUndergoKyc:Boolean(e.data.actionRequiredResult.result)})})),e.addCase(Tt.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR})),e.addCase(wt.pending,(function(e){e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(wt.fulfilled,(function(e){e.status=R.a.SUCCESS,e.data.sep8Step=jt({currentStep:e.data.sep8Step})})),e.addCase(wt.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR})),e.addCase(At.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ct;e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(At.fulfilled,(function(e,t){e.data=Object(E.a)(Object(E.a)({},e.data),{},{actionRequiredResult:t.payload,sep8Step:jt({currentStep:e.data.sep8Step})}),e.status=R.a.SUCCESS})),e.addCase(At.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR}))}}),Nt=function(e){return e.sep8Send},kt=Rt.reducer,It=Rt.actions,_t=It.resetSep8SendAction,Pt=It.sep8ClearErrorAction,Dt=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.type,r=t.toml,a=t.assetCode,F.a.instruction({title:"Checking `/info` endpoint to ensure this currency is enabled for ".concat(n===R.b.DEPOSIT?"deposit":"withdrawal")}),s="".concat(r.TRANSFER_SERVER_SEP0024,"/info"),F.a.request({title:"GET `".concat(s,"`")}),e.next=6,fetch(s);case 6:return i=e.sent,e.next=9,i.json();case 9:if(c=e.sent,F.a.response({title:"GET `".concat(s,"`"),body:c}),Object(Fe.get)(c,[n,a,"enabled"])){e.next=13;break}throw new Error("Asset is not enabled in the `/info` endpoint");case 13:return e.abrupt("return",c);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ut=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.assetCode,r=t.publicKey,a=t.sep24TransferServerUrl,s=t.token,i=t.claimableBalanceSupported,F.a.instruction({title:"Starting SEP-24 interactive flow for deposit"}),c=new FormData,o={asset_code:n,account:r,lang:"en",claimable_balance_supported:i.toString()},Object(Fe.each)(o,(function(e,t){return c.append(t,e)})),F.a.request({title:"POST `".concat(a,"/transactions/deposit/interactive`"),body:o}),e.next=8,fetch("".concat(a,"/transactions/deposit/interactive"),{method:"POST",body:c,headers:{Authorization:"Bearer ".concat(s)}});case 8:return u=e.sent,e.next=11,u.json();case 11:if(d=e.sent,F.a.response({title:"POST `".concat(a,"/transactions/deposit/interactive`"),body:d}),d.url){e.next=15;break}throw new Error("No URL returned from POST `/transactions/deposit/interactive`");case 15:return e.abrupt("return",d);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Lt=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.assetCode,r=t.publicKey,a=t.sep24TransferServerUrl,s=t.token,F.a.instruction({title:"Starting SEP-24 interactive flow for withdrawal"}),i=new FormData,c={asset_code:n,account:r,lang:"en"},Object(Fe.each)(c,(function(e,t){return i.append(t,e)})),F.a.request({title:"POST `".concat(a,"/transactions/withdraw/interactive`"),body:c}),e.next=8,fetch("".concat(a,"/transactions/withdraw/interactive"),{method:"POST",body:i,headers:{Authorization:"Bearer ".concat(s)}});case 8:return o=e.sent,e.next=11,o.json();case 11:if(u=e.sent,F.a.response({title:"POST `".concat(a,"/transactions/withdraw/interactive`"),body:u}),u.url){e.next=15;break}throw new Error("No URL returned from POST `/transactions/withdraw/interactive`");case 15:return e.abrupt("return",u);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Bt=function(e){var t=new URL(e),n=open(t.toString(),"popup","width=500,height=800");if(!n)throw new Error("Popups are blocked. You\u2019ll need to enable popups for this demo to work");return n},Mt=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.popup,r=t.transactionId,a=t.token,s=t.sep24TransferServerUrl,i=t.trustAssetCallback,c=R.p.INCOMPLETE,u=new URL("".concat(s,"/transaction?id=").concat(r)),F.a.instruction({title:"Polling for updates `".concat(u.toString(),"`")}),d=[R.p.PENDING_EXTERNAL,R.p.COMPLETED,R.p.ERROR];case 5:if(n.closed||d.includes(c)){e.next=46;break}return e.next=8,fetch(u.toString(),{headers:{Authorization:"Bearer ".concat(a)}});case 8:return l=e.sent,e.next=11,l.json();case 11:if((p=e.sent).transaction.status===c){e.next=42;break}c=p.transaction.status,n.location.href=p.transaction.more_info_url,F.a.instruction({title:"Transaction `".concat(r,"` is in `").concat(p.transaction.status,"` status")}),e.t0=c,e.next=e.t0===R.p.PENDING_USER_TRANSFER_START?19:e.t0===R.p.PENDING_ANCHOR?21:e.t0===R.p.PENDING_STELLAR?23:e.t0===R.p.PENDING_EXTERNAL?25:e.t0===R.p.PENDING_TRUST?27:e.t0===R.p.PENDING_USER?38:e.t0===R.p.ERROR?40:42;break;case 19:return F.a.instruction({title:"The anchor is waiting on you to take the action described in the popup"}),e.abrupt("break",42);case 21:return F.a.instruction({title:"The anchor is processing the transaction"}),e.abrupt("break",42);case 23:return F.a.instruction({title:"The Stellar network is processing the transaction"}),e.abrupt("break",42);case 25:return F.a.instruction({title:"The transaction is being processed by an external system"}),e.abrupt("break",42);case 27:return F.a.instruction({title:"You must add a trustline to the asset in order to receive your deposit"}),e.prev=28,e.next=31,i();case 31:o=e.sent,e.next=37;break;case 34:throw e.prev=34,e.t1=e.catch(28),new Error(P(e.t1));case 37:return e.abrupt("break",42);case 38:return F.a.instruction({title:"The anchor is waiting for you to take the action described in the popup"}),e.abrupt("break",42);case 40:return F.a.instruction({title:"There was a problem processing your transaction"}),e.abrupt("break",42);case 42:return e.next=44,new Promise((function(e){return setTimeout(e,2e3)}));case 44:e.next=5;break;case 46:return F.a.instruction({title:"Transaction status `".concat(c,"`")}),!d.includes(c)&&n.closed&&F.a.instruction({title:"The popup was closed before the transaction reached a terminal status, if your balance is not updated soon, the transaction may have failed."}),e.abrupt("return",{currentStatus:c,trustedAssetAdded:o});case 49:case"end":return e.stop()}}),e,null,[[28,34]])})));return function(t){return e.apply(this,arguments)}}(),Ft=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p,b,h,f,v,m,E,g,x,y,T,w;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.secretKey,r=t.popup,a=t.transactionId,s=t.token,i=t.sep24TransferServerUrl,c=t.networkPassphrase,o=t.networkUrl,u=t.assetCode,d=t.assetIssuer,l=S.Keypair.fromSecret(n),p=new O.a.Server(o),b=R.p.INCOMPLETE,h=new URL("".concat(i,"/transaction?id=").concat(a)),F.a.instruction({title:"Polling for updates `".concat(h.toString(),"`")}),f=[R.p.COMPLETED,R.p.ERROR];case 7:if(r.closed||f.includes(b)){e.next=52;break}return e.next=10,fetch(h.toString(),{headers:{Authorization:"Bearer ".concat(s)}});case 10:return v=e.sent,e.next=13,v.json();case 13:if((m=e.sent).transaction.status===b){e.next=48;break}b=m.transaction.status,r.location.href=m.transaction.more_info_url,F.a.instruction({title:"Transaction `".concat(a,"` is in `").concat(m.transaction.status,"` status")}),e.t0=b,e.next=e.t0===R.p.PENDING_USER_TRANSFER_START?21:e.t0===R.p.PENDING_ANCHOR?38:e.t0===R.p.PENDING_STELLAR?40:e.t0===R.p.PENDING_EXTERNAL?42:e.t0===R.p.PENDING_USER?44:e.t0===R.p.ERROR?46:48;break;case 21:return F.a.instruction({title:"The anchor is waiting for you to send the funds for withdrawal"}),E=Object(Ve.a)(m.transaction.withdraw_memo,m.transaction.withdraw_memo_type),F.a.request({title:"Fetching account sequence number",body:l.publicKey()}),e.next=26,p.accounts().accountId(l.publicKey()).call();case 26:return g=e.sent,x=g.sequence,F.a.response({title:"Fetching account sequence number",body:x}),y=new S.Account(l.publicKey(),x),(T=new S.TransactionBuilder(y,{fee:S.BASE_FEE,networkPassphrase:c}).addOperation(S.Operation.payment({destination:m.transaction.withdraw_anchor_account,asset:new S.Asset(u,d),amount:m.transaction.amount_in})).addMemo(E).setTimeout(0).build()).sign(l),F.a.request({title:"Submitting withdrawal transaction to Stellar",body:T}),e.next=35,p.submitTransaction(T);case 35:return w=e.sent,F.a.response({title:"Submitted withdrawal transaction to Stellar",body:w}),e.abrupt("break",48);case 38:return F.a.instruction({title:"The anchor is processing the transaction"}),e.abrupt("break",48);case 40:return F.a.instruction({title:"The Stellar network is processing the transaction"}),e.abrupt("break",48);case 42:return F.a.instruction({title:"The transaction is being processed by an external system"}),e.abrupt("break",48);case 44:return F.a.instruction({title:"The anchor is waiting for you to take the action described in the popup"}),e.abrupt("break",48);case 46:return F.a.instruction({title:"There was a problem processing your transaction"}),e.abrupt("break",48);case 48:return e.next=50,new Promise((function(e){return setTimeout(e,2e3)}));case 50:e.next=7;break;case 52:return F.a.instruction({title:"Transaction status `".concat(b,"`")}),!f.includes(b)&&r.closed&&F.a.instruction({title:"The popup was closed before the transaction reached a terminal status, if your balance is not updated soon, the transaction may have failed."}),e.abrupt("return",b);case 55:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Kt=Object(l.c)("sep24DepositAsset/depositAssetAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f,m,S,O,E,g,y,T,w,A,C,N;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rejectWithValue,a=n.getState,s=t.assetCode,i=t.assetIssuer,c=t.homeDomain,o=H(a()),u=o.data,d=o.secretKey,l=x(a()),p=l.pubnet,b=l.claimableBalanceSupported,h=M(p),f=null===u||void 0===u?void 0:u.id){e.next=8;break}throw new Error("Something is wrong with Account, no public key.");case 8:if(c){e.next=10;break}throw new Error("Something went wrong, home domain is not defined.");case 10:return F.a.instruction({title:"Initiating a SEP-24 deposit"}),m=function(){var e=Object(v.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(s,":").concat(i),e.next=3,Ne({secretKey:d,networkPassphrase:h.network,networkUrl:h.url,untrustedAsset:{assetString:t,assetCode:s,assetIssuer:i}});case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.prev=12,e.next=15,$e({sepName:"SEP-24 deposit",assetIssuer:i,requiredKeys:[R.o.SIGNING_KEY,R.o.TRANSFER_SERVER_SEP0024,R.o.WEB_AUTH_ENDPOINT],networkUrl:h.url,homeDomain:c});case 15:return S=e.sent,e.next=18,Dt({type:R.b.DEPOSIT,toml:S,assetCode:s});case 18:return F.a.instruction({title:"SEP-24 deposit is enabled, and requires authentication so we should go through SEP-10"}),e.next=21,Ye({authEndpoint:S.WEB_AUTH_ENDPOINT,serverSigningKey:S.SIGNING_KEY,publicKey:f,homeDomain:c});case 21:return O=e.sent,E=Xe({secretKey:d,networkPassphrase:h.network,challengeTransaction:O}),e.next=25,Qe({authEndpoint:S.WEB_AUTH_ENDPOINT,signedChallengeTransaction:E});case 25:return g=e.sent,e.next=28,Ut({assetCode:s,publicKey:f,sep24TransferServerUrl:S.TRANSFER_SERVER_SEP0024,token:g,claimableBalanceSupported:b});case 28:return y=e.sent,T=Bt(y.url),e.next=32,Mt({popup:T,transactionId:y.id,token:g,sep24TransferServerUrl:S.TRANSFER_SERVER_SEP0024,trustAssetCallback:m});case 32:return w=e.sent,A=w.currentStatus,C=w.trustedAssetAdded,e.abrupt("return",{currentStatus:A,trustedAssetAdded:C});case 38:return e.prev=38,e.t0=e.catch(12),N=P(e.t0),F.a.error({title:"SEP-24 deposit failed",body:N}),e.abrupt("return",r({errorString:N}));case 43:case"end":return e.stop()}}),e,null,[[12,38]])})));return function(t,n){return e.apply(this,arguments)}}()),Gt={data:{currentStatus:"",trustedAssetAdded:void 0},status:void 0,errorString:void 0},Vt=Object(l.d)({name:"sep24DepositAsset",initialState:Gt,reducers:{resetSep24DepositAssetAction:function(){return Gt}},extraReducers:function(e){e.addCase(Kt.pending,(function(e){e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(Kt.fulfilled,(function(e,t){e.data=t.payload,e.status=R.a.SUCCESS})),e.addCase(Kt.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR}))}}),Wt=Vt.reducer,qt=Vt.actions.resetSep24DepositAssetAction,Ht=Object(l.c)("sep24WithdrawAsset/withdrawAssetAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f,v,m,S,O,E,g,y;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rejectWithValue,a=n.getState,s=t.assetIssuer,i=t.assetCode,c=t.homeDomain,o=H(a()),u=o.data,d=o.secretKey,l=x(a()),p=l.pubnet,b=M(p),h=null===u||void 0===u?void 0:u.id){e.next=8;break}throw new Error("Something is wrong with Account, no public key.");case 8:if(c){e.next=10;break}throw new Error("Something went wrong, home domain is not defined.");case 10:return e.prev=10,e.next=13,$e({sepName:"SEP-24 withdrawal",assetIssuer:s,requiredKeys:[R.o.SIGNING_KEY,R.o.TRANSFER_SERVER_SEP0024,R.o.WEB_AUTH_ENDPOINT],networkUrl:b.url,homeDomain:c});case 13:return f=e.sent,e.next=16,Dt({type:R.b.WITHDRAWAL,toml:f,assetCode:i});case 16:return F.a.instruction({title:"SEP-24 withdrawal is enabled, and requires authentication so we should go through SEP-10"}),e.next=19,Ye({authEndpoint:f.WEB_AUTH_ENDPOINT,serverSigningKey:f.SIGNING_KEY,publicKey:h,homeDomain:c});case 19:return v=e.sent,m=Xe({secretKey:d,networkPassphrase:b.network,challengeTransaction:v}),e.next=23,Qe({authEndpoint:f.WEB_AUTH_ENDPOINT,signedChallengeTransaction:m});case 23:return S=e.sent,e.next=26,Lt({assetCode:i,publicKey:h,sep24TransferServerUrl:f.TRANSFER_SERVER_SEP0024,token:S});case 26:return O=e.sent,E=Bt(O.url),e.next=30,Ft({secretKey:d,popup:E,transactionId:O.id,token:S,sep24TransferServerUrl:f.TRANSFER_SERVER_SEP0024,networkPassphrase:b.network,networkUrl:b.url,assetCode:i,assetIssuer:s});case 30:return g=e.sent,e.abrupt("return",{currentStatus:g});case 34:return e.prev=34,e.t0=e.catch(10),y=P(e.t0),F.a.error({title:"SEP-24 withdrawal failed",body:y}),e.abrupt("return",r({errorString:y}));case 39:case"end":return e.stop()}}),e,null,[[10,34]])})));return function(t,n){return e.apply(this,arguments)}}()),Yt={data:{currentStatus:""},status:void 0,errorString:void 0},Xt=Object(l.d)({name:"sep24WithdrawAsset",initialState:Yt,reducers:{resetSep24WithdrawAssetAction:function(){return Yt}},extraReducers:function(e){e.addCase(Ht.pending,(function(e){e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(Ht.fulfilled,(function(e,t){e.data=t.payload,e.status=R.a.SUCCESS})),e.addCase(Ht.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR}))}}),Qt=Xt.reducer,zt=Xt.actions.resetSep24WithdrawAssetAction,Jt=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l,p,b,h;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.assetCode,r=t.sendServer,F.a.instruction({title:"Checking `/info` endpoint to see if we need to authenticate"}),F.a.request({title:"GET `/info`"}),e.next=5,fetch("".concat(r,"/info"));case 5:return a=e.sent,e.next=8,a.json();case 8:if(s=e.sent,F.a.response({title:"GET `/info`",body:s}),s.receive){e.next=12;break}throw new Error("`/info` response needs a `receive` property");case 12:if(i=s.receive[n]){e.next=15;break}throw new Error("Could not find asset code ".concat(n," in `/info` response"));case 15:if(i.enabled){e.next=17;break}throw new Error("".concat(n," is not enabled for deposit"));case 17:if(i.fields&&(f=i.fields,Object.entries(f).length)){e.next=19;break}throw new Error("No `fields` object specified in `/info`");case 19:if(i.fields.transaction){e.next=21;break}throw new Error("No `transaction` object specified in `fields`");case 21:return i.sep12?((null===(l=i.sep12.sender)||void 0===l?void 0:l.types)&&(1===(b=Object.keys(i.sep12.sender.types)).length?(c=b[0],F.a.instruction({title:"Using `".concat(c,"` ").concat(i.sep12.sender.types[c].description)})):b.length&&(u=b.map((function(e){return{type:e,description:i.sep12.sender.types[e].description}})),F.a.instruction({title:"Found multiple customer types for senders",body:"".concat(b.join(", "))}))),(null===(p=i.sep12.receiver)||void 0===p?void 0:p.types)&&(1===(h=Object.keys(i.sep12.receiver.types)).length?(o=h[0],F.a.instruction({title:"Using `".concat(o,"` ").concat(i.sep12.receiver.types[o].description)})):h.length&&(d=h.map((function(e){return{type:e,description:i.sep12.receiver.types[e].description}})),F.a.instruction({title:"Found multiple customer types for receivers",body:"".concat(h.join(", "))})))):(i.sender_sep12_type&&(c=i.sender_sep12_type,F.a.instruction({title:"Using `".concat(c,"` type for sending customers")})),i.receiver_sep12_type&&(o=i.receiver_sep12_type,F.a.instruction({title:"Using `".concat(o,"` type for receiving customers")}))),c||u||F.a.instruction({title:"The anchor does not require KYC for sending customers"}),o||d||F.a.instruction({title:"The anchor does not require KYC for receiving customers"}),F.a.instruction({title:"Send is enabled for asset ".concat(n)}),F.a.instruction({title:"The receiving anchor requires the following fields",body:i.fields}),e.abrupt("return",{fields:i.fields,senderType:c,receiverType:o,multipleSenderTypes:u,multipleReceiverTypes:d});case 27:case"end":return e.stop()}var f}),e)})));return function(t){return e.apply(this,arguments)}}(),Zt=n(263),$t=n.n(Zt),en=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.kycServer,r=t.receiverType,a=t.publicKey,s=t.senderType,i=t.token,F.a.instruction({title:"Making GET `/customer` requests for sending and receiving users"}),c={senderSep12Fields:null,receiverSep12Fields:null,info:{senderSep12Memo:"",receiverSep12Memo:""}},!s){e.next=9;break}return o=$t.a.randomBytes(32).toString("base64"),e.next=7,ze({type:s,memo:o,publicKey:a,token:i,kycServer:n,isNewCustomer:!0});case 7:c.senderSep12Fields=e.sent,c.info.senderSep12Memo=o;case 9:if(!r){e.next=15;break}return u=$t.a.randomBytes(32).toString("base64"),e.next=13,ze({type:r,memo:u,publicKey:a,token:i,kycServer:n,isNewCustomer:!0});case 13:c.receiverSep12Fields=e.sent,c.info.receiverSep12Memo=u;case 15:return e.abrupt("return",c);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tn=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.formData,r=t.secretKey,a=t.senderMemo,s=t.receiverMemo,i=t.fields,c=t.token,o=t.kycServer,F.a.instruction({title:"Making PUT `/customer` requests for sending and receiving users"}),u={senderSep12Id:"",receiverSep12Id:""},!i.sender){e.next=8;break}return e.next=6,Je({secretKey:r,fields:n.sender,memo:a,token:c,kycServer:o,isSender:!0});case 6:d=e.sent,u.senderSep12Id=d.id;case 8:if(!i.receiver){e.next=13;break}return e.next=11,Je({secretKey:r,fields:n.receiver,memo:s,token:c,kycServer:o,isSender:!1});case 11:l=e.sent,u.receiverSep12Id=l.id;case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),nn=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.token,r=t.sendServer,a=t.senderId,s=t.receiverId,i=t.transactionFormData,c=t.assetCode,o=t.amount,F.a.instruction({title:"POST relevant field info to create a new payment"}),u={sender_id:a,receiver_id:s,fields:{transaction:i},asset_code:c,amount:o},F.a.request({title:"POST `/transactions`",body:u}),e.next=6,fetch("".concat(r,"/transactions"),{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify(u)});case 6:if(d=e.sent,[200,201].includes(d.status)){e.next=9;break}throw new Error("POST `/transactions` responded with status ".concat(d.status));case 9:return e.next=11,d.json();case 11:return l=e.sent,F.a.response({title:"POST `/transactions`",body:l}),["id","stellar_account_id","stellar_memo_type","stellar_memo"].forEach((function(e){if(!l[e])throw new Error("POST `/transactions` response missing property `".concat(e,"`"))})),e.abrupt("return",{sendMemoType:l.stellar_memo_type,sendMemo:l.stellar_memo,receiverAddress:l.stellar_account_id,transactionId:l.id});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),rn=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.sendServer,r=t.transactionId,a=t.token,F.a.instruction({title:"Polling `/transactions/:id` endpoint until transaction status is `".concat(R.p.PENDING_SENDER,"`")});case 2:if(s===R.p.PENDING_SENDER){e.next=18;break}return F.a.request({title:"GET `/transactions/".concat(r,"`")}),e.next=6,fetch("".concat(n,"/transactions/").concat(r),{headers:{Authorization:"Bearer ".concat(a)}});case 6:if(200===(i=e.sent).status){e.next=9;break}throw new Error("GET `/transactions/".concat(r,"` responded with status `").concat(i.status,"`"));case 9:return e.next=11,i.json();case 11:return c=e.sent,F.a.response({title:"GET `/transactions/".concat(r,"`"),body:c}),s=c.transaction.status,e.next=16,new Promise((function(e){return setTimeout(e,2e3)}));case 16:e.next=2;break;case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),an=n(441),sn=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.sendServer,r=t.transactionId,a=t.token,F.a.instruction({title:"Polling `/transactions/:id` endpoint until transaction status reaches end status"}),F.a.request({title:"GET `/transactions/".concat(r,"`")});case 3:if([R.p.PENDING_EXTERNAL,R.p.COMPLETED,R.p.ERROR].includes(s)){e.next=32;break}return e.next=6,fetch("".concat(n,"/transactions/").concat(r),{headers:{Authorization:"Bearer ".concat(a)}});case 6:if(200===(c=e.sent).status){e.next=9;break}throw new Error("GET `/transactions/".concat(r,"` responded with status `").concat(c.status,"`"));case 9:return e.next=11,c.json();case 11:if(i=e.sent,s===i.transaction.status){e.next=28;break}s=i.transaction.status,F.a.instruction({title:"Transaction `".concat(r,"` is in `").concat(i.transaction.status,"` status")}),e.t0=s,e.next=e.t0===R.p.PENDING_SENDER?18:e.t0===R.p.PENDING_STELLAR?20:e.t0===R.p.PENDING_CUSTOMER_INFO_UPDATE?22:e.t0===R.p.PENDING_TRANSACTION_INFO_UPDATE?24:e.t0===R.p.PENDING_RECEIVER?26:28;break;case 18:return F.a.instruction({title:"Awaiting payment to be initiated by sending anchor"}),e.abrupt("break",28);case 20:return F.a.instruction({title:"Transaction has been submitted to Stellar network, but is not yet confirmed"}),e.abrupt("break",28);case 22:case 24:return F.a.instruction({title:"Certain pieces of information need to be updated by the sending anchor"}),e.abrupt("break",28);case 26:return F.a.instruction({title:"Payment is being processed by the receiving anchor"}),e.abrupt("break",28);case 28:return e.next=30,new Promise((function(e){return setTimeout(e,2e3)}));case 30:e.next=3;break;case 32:if(i){e.next=34;break}throw new Error("Something went wrong, there was no response");case 34:F.a.response({title:"GET `/transactions/".concat(r,"`"),body:i});case 35:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),cn=Object(l.c)("sep31Send/initiateSendAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f,v,m,S,O,E;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rejectWithValue,a=n.getState,e.prev=1,s=x(a()),i=s.pubnet,c=H(a()),o=c.data,u=M(i),d=null===o||void 0===o?void 0:o.id,l=t.assetCode,p=t.assetIssuer,b=t.homeDomain,d){e.next=9;break}throw new Error("Something is wrong with Account, no public key.");case 9:if(b){e.next=11;break}throw new Error("Something went wrong, home domain is not defined.");case 11:return F.a.instruction({title:"Initiating a SEP-31 direct payment"}),e.next=14,$e({sepName:"SEP-31 send",assetIssuer:p,requiredKeys:[R.o.WEB_AUTH_ENDPOINT,R.o.SIGNING_KEY,R.o.DIRECT_PAYMENT_SERVER,R.o.KYC_SERVER],networkUrl:u.url,homeDomain:b});case 14:return h=e.sent,f=h.WEB_AUTH_ENDPOINT,v=h.SIGNING_KEY,m=h.DIRECT_PAYMENT_SERVER,S=h.KYC_SERVER,e.next=21,Jt({assetCode:l,sendServer:m});case 21:return O=e.sent,e.abrupt("return",{publicKey:d,homeDomain:b,assetCode:l,assetIssuer:p,fields:{transaction:O.fields.transaction,sender:{},receiver:{}},senderType:O.senderType,receiverType:O.receiverType,multipleSenderTypes:O.multipleSenderTypes,multipleReceiverTypes:O.multipleReceiverTypes,authEndpoint:f,sendServer:m,kycServer:S,serverSigningKey:v,isTypeSelected:Boolean(!O.multipleSenderTypes&&!O.multipleReceiverTypes)});case 25:return e.prev=25,e.t0=e.catch(1),E=P(e.t0),F.a.error({title:E}),e.abrupt("return",r({errorString:E}));case 30:case"end":return e.stop()}}),e,null,[[1,25]])})));return function(t,n){return e.apply(this,arguments)}}()),on=Object(l.c)("sep31Send/setCustomerTypesAction",(function(e){var t=e.senderType,n=void 0===t?"":t,r=e.receiverType,a=void 0===r?"":r;return n&&F.a.instruction({title:"Using `".concat(n,"` type for sending customers")}),a&&F.a.instruction({title:"Using `".concat(a,"` type for receiving customers")}),{senderType:n,receiverType:a,isTypeSelected:!0}})),un=Object(l.c)("sep31Send/fetchSendFieldsAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f,v,m,S,O,E,g,y,T,w;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,a=n.getState,e.prev=1,s=x(a()),i=s.pubnet,c=H(a()),o=c.secretKey,u=bn(a()),d=u.data,l=M(i),p=d.authEndpoint,b=d.serverSigningKey,h=d.publicKey,f=d.homeDomain,v=d.kycServer,m=d.senderType,S=d.receiverType,O=d.fields,e.next=9,Ye({authEndpoint:p,serverSigningKey:b,publicKey:h,homeDomain:f});case 9:return E=e.sent,g=Xe({secretKey:o,networkPassphrase:l.network,challengeTransaction:E}),e.next=13,Qe({authEndpoint:p,signedChallengeTransaction:g});case 13:return y=e.sent,e.next=16,en({kycServer:v,publicKey:h,token:y,senderType:m,receiverType:S});case 16:return T=e.sent,F.a.instruction({title:"To collect the required information we show a form with all the requested fields from `/info`"}),e.abrupt("return",{token:y,fields:{transaction:O.transaction,sender:T.senderSep12Fields||{},receiver:T.receiverSep12Fields||{}},senderMemo:T.info.senderSep12Memo,receiverMemo:T.info.receiverSep12Memo});case 21:return e.prev=21,e.t0=e.catch(1),w=P(e.t0),F.a.error({title:w}),e.abrupt("return",r({errorString:w}));case 26:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(t,n){return e.apply(this,arguments)}}()),dn=Object(l.c)("sep31Send/submitSep31SendTransactionAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u,d,l,p,b,h,f,v,m,S,O,E,g,y,T,w,A,C;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.amount,a=t.transaction,s=t.sender,i=t.receiver,c=n.rejectWithValue,o=n.getState,e.prev=2,u=H(o()),d=u.secretKey,l=bn(o()),p=l.data,b=x(o()),h=b.pubnet,f=M(h),v=p.token,m=p.assetCode,S=p.assetIssuer,O=p.kycServer,E=p.sendServer,g=p.senderMemo,y=p.receiverMemo,T=p.fields,e.next=10,tn({fields:T,formData:{sender:s,receiver:i},secretKey:d,senderMemo:g,receiverMemo:y,kycServer:O,token:v});case 10:return w=e.sent,e.next=13,nn({amount:r.amount,assetCode:m,senderId:w.senderSep12Id,receiverId:w.receiverSep12Id,transactionFormData:a,sendServer:E,token:v});case 13:return A=e.sent,e.next=16,rn({sendServer:E,transactionId:A.transactionId,token:v});case 16:return e.next=18,Object(an.a)({amount:r.amount,assetCode:m,assetIssuer:S,receiverAddress:A.receiverAddress,secretKey:d,sendMemo:A.sendMemo,sendMemoType:A.sendMemoType,networkUrl:f.url,networkPassphrase:f.network});case 18:return e.next=20,sn({sendServer:E,transactionId:A.transactionId,token:v});case 20:return F.a.instruction({title:"SEP-31 send payment completed"}),e.abrupt("return",!0);case 24:return e.prev=24,e.t0=e.catch(2),C=P(e.t0),F.a.error({title:C}),e.abrupt("return",c({errorString:C}));case 29:case"end":return e.stop()}}),e,null,[[2,24]])})));return function(t,n){return e.apply(this,arguments)}}()),ln={data:{publicKey:"",homeDomain:"",assetCode:"",assetIssuer:"",token:"",fields:{transaction:{},sender:{},receiver:{}},isTypeSelected:!1,senderType:void 0,receiverType:void 0,senderMemo:"",receiverMemo:"",multipleSenderTypes:void 0,multipleReceiverTypes:void 0,authEndpoint:"",sendServer:"",kycServer:"",serverSigningKey:""},errorString:void 0,status:void 0},pn=Object(l.d)({name:"sep31Send",initialState:ln,reducers:{resetSep31SendAction:function(){return ln}},extraReducers:function(e){e.addCase(cn.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln;e.status=R.a.PENDING})),e.addCase(cn.fulfilled,(function(e,t){e.data=Object(E.a)(Object(E.a)({},e.data),t.payload),e.status=t.payload.multipleSenderTypes||t.payload.multipleReceiverTypes?R.a.NEEDS_INPUT:R.a.CAN_PROCEED})),e.addCase(cn.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR})),e.addCase(on.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln;e.status=R.a.PENDING})),e.addCase(on.fulfilled,(function(e,t){e.data=Object(E.a)(Object(E.a)({},e.data),t.payload),e.status=R.a.CAN_PROCEED})),e.addCase(un.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln;e.status=R.a.PENDING})),e.addCase(un.fulfilled,(function(e,t){e.data=Object(E.a)(Object(E.a)({},e.data),t.payload),e.status=R.a.NEEDS_INPUT})),e.addCase(un.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR})),e.addCase(dn.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln;e.status=R.a.PENDING})),e.addCase(dn.fulfilled,(function(e){e.status=R.a.SUCCESS})),e.addCase(dn.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR}))}}),bn=function(e){return e.sep31Send},hn=pn.reducer,fn=pn.actions.resetSep31SendAction,jn={errorString:"",items:[],status:void 0},vn=Object(l.c)("logs/addLog",(function(e){return e})),mn=Object(l.d)({name:"logs",initialState:jn,reducers:{clearLogsAction:function(){return jn},logAction:function(e,t){e.items=[].concat(Object(d.a)(e.items),[t.payload])}},extraReducers:function(e){e.addCase(vn.pending,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jn;e.status=R.a.PENDING})),e.addCase(vn.fulfilled,(function(e,t){e.items=[].concat(Object(d.a)(e.items),[t.payload]),e.status=R.a.SUCCESS}))}}),Sn=mn.reducer,On=mn.actions,En=(On.logAction,On.clearLogsAction),gn=Object(l.c)("sendPayment/sendPaymentAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o,u;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,a=n.getState,s=x(a()),i=s.pubnet,c=s.secretKey,e.prev=2,e.next=5,St({params:t,secretKey:c,isPubnet:i});case 5:o=e.sent,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(2),u=U(e.t0),F.a.error({title:u}),e.abrupt("return",r({errorString:u}));case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n){return e.apply(this,arguments)}}()),xn={data:null,status:void 0,errorString:void 0},yn=Object(l.d)({name:"sendPayment",initialState:xn,reducers:{resetSendPaymentAction:function(){return xn}},extraReducers:function(e){e.addCase(gn.pending,(function(e){e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(gn.fulfilled,(function(e,t){e.data=t.payload,e.status=R.a.SUCCESS})),e.addCase(gn.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR}))}}),Tn=yn.reducer,wn=yn.actions.resetSendPaymentAction,An=Object(l.c)("trustAsset/trustAssetAction",function(){var e=Object(v.a)(j.a.mark((function e(t,n){var r,a,s,i,c,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,a=n.getState,s=x(a()),i=s.pubnet,c=s.secretKey,o=M(i),e.prev=3,e.t0=t.assetString,e.t1=JSON,e.next=8,Ne({secretKey:c,untrustedAsset:t,networkUrl:o.url,networkPassphrase:o.network});case 8:return e.t2=e.sent,e.t3=e.t1.stringify.call(e.t1,e.t2),e.abrupt("return",{assetString:e.t0,response:e.t3});case 13:return e.prev=13,e.t4=e.catch(3),e.abrupt("return",r({errorString:U(e.t4)}));case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t,n){return e.apply(this,arguments)}}()),Cn={assetString:"",data:null,status:void 0,errorString:void 0},Rn=Object(l.d)({name:"trustAsset",initialState:Cn,reducers:{resetTrustAssetAction:function(){return Cn}},extraReducers:function(e){e.addCase(An.pending,(function(e){e.errorString=void 0,e.status=R.a.PENDING})),e.addCase(An.fulfilled,(function(e,t){e.assetString=t.payload.assetString,e.data=t.payload.response,e.status=R.a.SUCCESS})),e.addCase(An.rejected,(function(e,t){var n;e.errorString=null===(n=t.payload)||void 0===n?void 0:n.errorString,e.status=R.a.ERROR}))}}),Nn=Rn.reducer,kn=Rn.actions.resetTrustAssetAction,In="RESET",_n=Object(p.a)({account:Y,activeAsset:Z,allAssets:Ae,assetOverrides:de,claimAsset:Pe,claimableBalances:Me,logs:Sn,sendPayment:Tn,sep6DepositAsset:it,sep6WithdrawAsset:ht,sep8Send:kt,sep24DepositAsset:Wt,sep24WithdrawAsset:Qt,sep31Send:hn,settings:y,trustAsset:Nn,untrustedAssets:Oe}),Pn=Object(l.b)(In),Dn=Object(l.a)({reducer:function(e,t){var n=t.type===In?void 0:e;return _n(n,t)},middleware:Object(d.a)(Object(l.e)({serializableCheck:{isSerializable:function(e){return"function"===typeof e||"symbol"===typeof e||(h.a.isBigNumber(e)||Object(l.f)(e))}}}))}),Un=n(5),Ln=n(0),Bn=function(e){var t=e.onClose,n=Object(Un.useState)([]),r=Object(w.a)(n,2),a=r[0],s=r[1],u=Object(c.b)(),l=Object(i.g)();Object(Un.useEffect)((function(){s(function(){var e=[R.i.ASSET_OVERRIDES,R.i.UNTRUSTED_ASSETS,R.i.CLAIMABLE_BALANCE_SUPPORTED],t=new URLSearchParams(window.location.search);return e.reduce((function(e,n){return t.has(n)?[].concat(Object(d.a)(e),[n]):e}),[])}())}),[]);return Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)("p",{children:"You can reload the account using your secret key or press back in your browser to sign back in."}),a.length>0&&Object(Ln.jsxs)(o.InfoBlock,{variant:o.InfoBlock.variant.warning,children:[Object(Ln.jsx)("p",{children:"You have session data (".concat(function(){var e,t=(e={},Object(ae.a)(e,R.i.ASSET_OVERRIDES,"home domain overrides"),Object(ae.a)(e,R.i.UNTRUSTED_ASSETS,"untrusted assets"),Object(ae.a)(e,R.i.CLAIMABLE_BALANCE_SUPPORTED,"claimable balance supported"),e);return a.map((function(e){return t[e]})).join(", ")}(),") that will be lost when you sign out. You can copy the URL to save it.")}),Object(Ln.jsx)("div",{className:"SessionParamsWrapper",children:Object(Ln.jsx)(o.CopyText,{textToCopy:window.location.toString(),tooltipPosition:o.CopyText.tooltipPosition.right,showTooltip:!0,children:Object(Ln.jsx)(o.TextLink,{iconLeft:Object(Ln.jsx)(o.Icon.Copy,{}),children:"Copy URL"})})})]})]}),Object(Ln.jsxs)(o.Modal.Footer,{children:[Object(Ln.jsx)(o.Button,{onClick:function(){u(Pn()),l.push({pathname:"/"}),t()},children:"Sign out"}),Object(Ln.jsx)(o.Button,{variant:o.Button.variant.secondary,onClick:t,children:"Go back"})]})]})},Mn=n(459),Fn=n.n(Mn),Kn=n(460),Gn=n.n(Kn);function Vn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(c.c)((function(e){return Gn()(e,t)}),Fn.a)}var Wn=function(){var e=Object(Un.useState)(!1),t=Object(w.a)(e,2),n=t[0],r=t[1],a=Vn("account").account,s=function(){r(!1)};return Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Layout.Header,Object(E.a)(Object(E.a)({projectTitle:"Demo Wallet"},a.isAuthenticated?{onSignOut:function(){return r(!0)}}:{}),{},{hasDarkModeToggle:!0})),Object(Ln.jsx)(o.Modal,{visible:n,onClose:s,parentId:se.a,children:Object(Ln.jsx)(Bn,{onClose:s})})]})},qn=function(e){var t=e.currentVal,n=e.newVal,r=e.removeVal,a=t?t.split(","):[];if(n){if(a.includes(n))throw new Error("".concat(n," was already added"));return[].concat(Object(d.a)(a),[n]).join(",")}return r?a.filter((function(e){return e!==r})).join(","):t},Hn=function(e){var t=Object.entries(e).reduce((function(e,t){var n=Object(w.a)(t,2),r=n[0],a=n[1];return"assetString"!==r?[].concat(Object(d.a)(e),["".concat(r).concat(se.d).concat(a)]):e}),[]);return"".concat(t.join(se.c))},Yn={update:function(e,t,n){var r=n||new URLSearchParams(window.location.search),a=r.get(e)||"";switch(e){case R.i.PUBNET:"true"===t?r.set(R.i.PUBNET,t):r.delete(R.i.PUBNET);break;case R.i.CLAIMABLE_BALANCE_SUPPORTED:"true"===t?r.set(R.i.CLAIMABLE_BALANCE_SUPPORTED,t):r.delete(R.i.CLAIMABLE_BALANCE_SUPPORTED);break;case R.i.SECRET_KEY:r.set(R.i.SECRET_KEY,t);break;case R.i.UNTRUSTED_ASSETS:r.set(R.i.UNTRUSTED_ASSETS,qn({currentVal:a,newVal:t}));break;default:throw new Error("Search param `".concat(Yn,"` does not exist"))}return"?".concat(r.toString())},remove:function(e,t,n){var r=n||new URLSearchParams(window.location.search),a=r.get(e)||"",s=qn({currentVal:a,removeVal:t});return s?r.set(e,s):r.delete(e),"?".concat(r.toString())},updateKeyPair:function(e){var t=e.param,n=e.itemId,r=e.keyPairs,a=e.urlSearchParams||new URLSearchParams(window.location.search),s=a.get(t)||"",i=s?s.split(","):[],c=ie(s);if(c.find((function(e){return e.assetString===n}))){var o=c.reduce((function(e,t){return t.assetString===n?[].concat(Object(d.a)(e),[Object(E.a)(Object(E.a)({},t),r)]):[].concat(Object(d.a)(e),[t])}),[]).reduce((function(e,t){return[].concat(Object(d.a)(e),["".concat(t.assetString).concat(se.c).concat(Hn(t))])}),[]);a.set(t,o.join(","))}else{var u=[].concat(Object(d.a)(i),["".concat(n).concat(se.c).concat(Hn(r))]).join(",");a.set(t,u)}return"?".concat(a.toString())},removeKeyPair:function(e){var t=e.param,n=e.itemId,r=e.urlSearchParams||new URLSearchParams(window.location.search),a=r.get(t)||"",s=ie(a).filter((function(e){return e.assetString!==n}));if(s.length){var i=s.reduce((function(e,t){return[].concat(Object(d.a)(e),["".concat(t.assetString).concat(se.c).concat(Hn(t))])}),[]);r.set(t,i.join(","))}else r.delete(t);return"?".concat(r.toString())}},Xn=function(e){var t=e.onClose,n=Vn("settings").settings,r=Object(i.g)();return Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Modal.Heading,{children:"Configuration"}),Object(Ln.jsx)(o.Modal.Body,{children:Object(Ln.jsxs)("div",{className:"ConfigurationItem",children:[Object(Ln.jsx)("label",{htmlFor:"claimable-balance-supported",children:"Claimable balance supported"}),Object(Ln.jsx)(o.Toggle,{id:"claimable-balance-supported",checked:n.claimableBalanceSupported,onChange:function(){r.push(Yn.update(R.i.CLAIMABLE_BALANCE_SUPPORTED,(!n.claimableBalanceSupported).toString()))}})]})}),Object(Ln.jsx)(o.Modal.Footer,{children:Object(Ln.jsx)(o.Button,{onClick:t,children:"Close"})})]})},Qn=function(){var e=Object(Un.useState)(!1),t=Object(w.a)(e,2),n=t[0],r=t[1],a=Vn("account").account,s=function(){r(!1)};return Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Layout.Footer,{gitHubLink:"https://github.com/stellar/stellar-demo-wallet",hideTopBorder:!0,children:a.isAuthenticated&&Object(Ln.jsx)("div",{children:Object(Ln.jsx)(o.TextLink,{onClick:function(){return r(!0)},children:"Configuration"})})}),Object(Ln.jsx)(o.Modal,{visible:n,onClose:s,parentId:se.a,children:Object(Ln.jsx)(Xn,{onClose:s})})]})},zn=n(265),Jn=n.n(zn),Zn=n(461),$n=n.n(Zn),er={base00:"var(--pal-background-primary)",base01:"var(--pal-background-primary)",base02:"var(--pal-background-primary)",base03:"var(--pal-text-primary)",base04:"var(--pal-text-link)",base05:"var(--pal-text-primary)",base06:"var(--pal-text-primary)",base07:"var(--pal-text-primary)",base08:"var(--pal-text-primary)",base09:"var(--pal-text-primary)",base0A:"var(--pal-text-primary)",base0B:"var(--pal-text-primary)",base0C:"var(--pal-text-primary)",base0D:"var(--pal-text-link)",base0E:"var(--pal-text-link)",base0F:"var(--pal-text-link)"},tr=function(e){var t=e.src,n=e.collapseStringsAfterLength,r=void 0===n?15:n,a=e.displayDataTypes,s=void 0===a||a,i=e.collapsed,c=void 0!==i&&i,o=e.theme,u=void 0===o?er:o;return Object(Ln.jsx)($n.a,{src:t,collapseStringsAfterLength:r,displayDataTypes:s,collapsed:c,theme:u})},nr=n(462),rr=n(463),ar=n.n(rr);n(1057);Jn.a.setOptions({gfm:!1});var sr,ir={instruction:Object(Ln.jsx)(o.Icon.MessageSquare,{}),error:Object(Ln.jsx)(o.Icon.XCircle,{}),request:Object(Ln.jsx)(o.Icon.ArrowRight,{}),response:Object(Ln.jsx)(o.Icon.ArrowLeft,{})},cr={light:{base00:"var(--pal-background-primary)",base01:"var(--pal-background-primary)",base02:"var(--pal-background-primary)",base03:"var(--pal-text-primary)",base04:"var(--pal-text-primary)",base05:"var(--pal-text-primary)",base06:"var(--pal-text-primary)",base07:"var(--pal-text-primary)",base08:"var(--pal-text-primary)",base09:"var(--pal-text-primary)",base0A:"var(--pal-text-primary)",base0B:"var(--pal-text-primary)",base0C:"var(--pal-text-primary)",base0D:"var(--pal-text-primary)",base0E:"var(--pal-text-primary)",base0F:"var(--pal-text-primary)"},dark:{base00:"var(--pal-example-code)",base01:"var(--pal-example-code)",base02:"var(--pal-example-code)",base03:"var(--pal-brand-primary-on)",base04:"var(--pal-brand-primary-on)",base05:"var(--pal-brand-primary-on)",base06:"var(--pal-brand-primary-on)",base07:"var(--pal-brand-primary-on)",base08:"var(--pal-brand-primary-on)",base09:"var(--pal-brand-primary-on)",base0A:"var(--pal-brand-primary-on)",base0B:"var(--pal-brand-primary-on)",base0C:"var(--pal-brand-primary-on)",base0D:"var(--pal-brand-primary-on)",base0E:"var(--pal-brand-primary-on)",base0F:"var(--pal-brand-primary-on)"}},or=function(e){var t=e.title,n=e.variant,r=e.body,a=Object(Un.useState)(!1),s=Object(w.a)(a,2),i=s[0],c=s[1];Object(Un.useEffect)((function(){var e=setTimeout((function(){c(!0),clearTimeout(e)}),150)}),[]);var o,u=r?JSON.parse("".concat(r)):r;return Object(Ln.jsxs)("div",{className:"LogItem LogItem--".concat(n," ").concat(i?"LogItem--open":""),children:[Object(Ln.jsxs)("div",{className:"LogItem__header",children:[Object(Ln.jsx)("div",{className:"LogItem__icon",children:ir[n]}),Object(Ln.jsx)("div",{className:"LogItem__title",children:(o=Jn()(t),Object(nr.a)(ar.a.sanitize(o,{USE_PROFILES:{html:!0}})))})]}),u&&Object(Ln.jsx)("div",{className:"LogItem__body",children:"object"===typeof u?Object(Ln.jsx)(tr,{src:u,collapseStringsAfterLength:15,displayDataTypes:!1,collapsed:1,theme:n===R.f.INSTRUCTION||n===R.f.ERROR?cr.light:cr.dark}):u})]})},ur=function(){var e=Vn("account","logs"),t=e.account,n=e.logs,r=Object(c.b)();Object(Un.useEffect)((function(){var e=function(e){var t=e.detail,n=t.timestamp,a=t.type,s=t.title,i=t.body;r(vn({timestamp:n,type:a,title:s,body:JSON.stringify(i)}))};return document.addEventListener(se.b,e),document.removeEventListener(se.b,e,!0)}),[r]);return t.isAuthenticated?Object(Ln.jsxs)("div",{className:"SplitContainer Logs",children:[Object(Ln.jsx)("div",{className:"Logs__container",children:Object(Ln.jsx)("div",{className:"Logs__content",children:Object(Ln.jsx)(o.Layout.Inset,{children:Object(Ln.jsx)("div",{className:"Logs__wrapper",children:n.items.length?n.items.map((function(e,t){return Object(Ln.jsx)(or,{variant:e.type,title:e.title,body:e.body},"".concat(e.timestamp,"-").concat(t))})):Object(Ln.jsx)("p",{children:"No logs to show"})})})})}),Object(Ln.jsx)("div",{className:"Logs__footer",children:Object(Ln.jsxs)(o.Layout.Inset,{children:[Object(Ln.jsx)(o.TextLink,{onClick:function(){if(n.items.length){var e="stellar-dw-logs-".concat(Date.now(),".md"),t=function(e){var t="".concat(new Date,"\n\n"),n="[URL](".concat(window.location.toString(),")\n\n"),r="".concat("# Stellar Demo Wallet logs\n\n").concat(t).concat(n).concat("---\n\n");return e.reduce((function(t,n,r){var a=r===e.length-1,s="**".concat(n.type,":** ").concat(n.title,"\n"),i=n.body?JSON.parse("".concat(n.body)):null;return i&&(i="string"===typeof i?i:JSON.stringify(i,null,2),s+="\n```javascript\n".concat(i,"\n```\n")),a||(s+="\n"),"".concat(t).concat(s)}),r)}(n.items),r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,".concat(encodeURIComponent(t))),r.setAttribute("download",e),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},disabled:!n.items.length,children:"Download logs"}),Object(Ln.jsx)(o.TextLink,{onClick:function(){return r(En())},disabled:!n.items.length,children:"Clear logs"})]})})]}):Object(Ln.jsx)("div",{className:"SplitContainer Logs",children:Object(Ln.jsx)("div",{className:"Logs__content",children:Object(Ln.jsx)("div",{className:"Logs__empty",children:"Operation logs will appear here once a transaction begins"})})})},dr=n(189),lr=function(e){var t=e.children,n=Object(dr.a)(e,["children"]),r=Vn("account").account,a=Object(i.h)();return Object(Ln.jsx)(i.b,Object(E.a)(Object(E.a)({},n),{},{render:function(){return r.isAuthenticated?t:Object(Ln.jsx)(i.a,{to:{pathname:"/",search:a.search}})}}))},pr=function(e){var t=e.children,n=Vn("account").account,r=Object(c.b)(),a=Object(i.g)(),s=Object(i.h)(),o=new URLSearchParams(s.search),u=o.get(R.i.PUBNET),l=o.get(R.i.SECRET_KEY),p=o.get(R.i.UNTRUSTED_ASSETS),b=o.get(R.i.ASSET_OVERRIDES),h=o.get(R.i.CLAIMABLE_BALANCE_SUPPORTED);return Object(Un.useEffect)((function(){r(T(Object(ae.a)({},R.i.PUBNET,"true"===u)))}),[u,r]),Object(Un.useEffect)((function(){if(r(T(Object(ae.a)({},R.i.SECRET_KEY,l||""))),l)try{var e=S.Keypair.fromSecret(l);r(K({publicKey:e.publicKey(),secretKey:e.secret()})),r(Ue({publicKey:e.publicKey()}))}catch(t){F.a.error({title:"Fetch account error",body:P(t)})}}),[l,r]),Object(Un.useEffect)((function(){var e=null===p||void 0===p?void 0:p.split(",").reduce((function(e,t){return e.includes(t)?e:[].concat(Object(d.a)(e),[t])}),[]).join(",");r(T(Object(ae.a)({},R.i.UNTRUSTED_ASSETS,e||"")))}),[p,r]),Object(Un.useEffect)((function(){r(T(Object(ae.a)({},R.i.ASSET_OVERRIDES,b||"")))}),[b,r]),Object(Un.useEffect)((function(){r(T(Object(ae.a)({},R.i.CLAIMABLE_BALANCE_SUPPORTED,"true"===h)))}),[h,r]),Object(Un.useEffect)((function(){n.status===R.a.SUCCESS&&a.push({pathname:"/account",search:a.location.search})}),[n.status,a]),Object(Ln.jsx)(Ln.Fragment,{children:t})},br=function(){var e,t=Vn("account","settings"),n=t.account;return t.settings.pubnet&&(null===(e=n.data)||void 0===e?void 0:e.id)?Object(Ln.jsx)(o.StatusBar,{variant:o.StatusBar.variant.error,children:"WARNING: You\u2019ve connected a real account to this demo. You are not on the test server. Any actions you take here will affect actual assets."}):null},hr=(n(1058),function(e){var t=e.parentId,n=e.visible,r=e.children,s=document.getElementById(t),i=Object(Un.useState)(n),c=Object(w.a)(i,2),u=c[0],d=c[1],l=Object(Un.useState)(!1),p=Object(w.a)(l,2),b=p[0],h=p[1];return Object(Un.useLayoutEffect)((function(){if(n)d(!0),setTimeout((function(){h(!0)}),150);else var e=setTimeout((function(){h(!1),clearTimeout(e),setTimeout((function(){d(!1)}),400)}),600)}),[n]),s&&u?a.a.createPortal(Object(Ln.jsx)("div",{className:"ToastBanner ".concat(b?"open":""),children:Object(Ln.jsx)(o.Layout.Inset,{children:r})}),s):null}),fr=function(e){return e?"".concat(e.slice(0,5),"\u2026").concat(e.slice(-5)):""},jr=function(){var e,t,n=Vn("account").account,r=Object(Un.useState)(!1),a=Object(w.a)(r,2),s=a[0],i=a[1],u=Object(c.b)(),d=Object(Un.useCallback)((function(){var e;(null===(e=n.data)||void 0===e?void 0:e.id)&&(u(K({publicKey:n.data.id,secretKey:n.secretKey})),u(Ue({publicKey:n.data.id})))}),[null===(e=n.data)||void 0===e?void 0:e.id,n.secretKey,u]);if(!(null===(t=n.data)||void 0===t?void 0:t.id))return null;var l=n.status===R.a.PENDING;return Object(Ln.jsxs)(o.Layout.Inset,{children:[Object(Ln.jsxs)("div",{className:"Account",children:[Object(Ln.jsxs)("div",{className:"AccountInfo",children:[Object(Ln.jsxs)("div",{className:"AccountInfoRow",children:[Object(Ln.jsx)("div",{className:"AccountInfoCell AccountLabel",children:"Public"}),Object(Ln.jsx)("div",{className:"AccountInfoCell",children:fr(n.data.id)}),Object(Ln.jsx)("div",{className:"AccountInfoCell CopyButton",children:Object(Ln.jsx)(o.CopyText,{textToCopy:n.data.id,children:Object(Ln.jsx)(o.TextLink,{children:"Copy"})})})]}),Object(Ln.jsxs)("div",{className:"AccountInfoRow",children:[Object(Ln.jsx)("div",{className:"AccountInfoCell AccountLabel",children:"Secret"}),Object(Ln.jsx)("div",{className:"AccountInfoCell",children:fr(n.secretKey)}),Object(Ln.jsx)("div",{className:"AccountInfoCell CopyButton",children:Object(Ln.jsx)(o.CopyText,{textToCopy:n.secretKey,children:Object(Ln.jsx)(o.TextLink,{children:"Copy"})})})]})]}),Object(Ln.jsxs)("div",{className:"AccountInfo",children:[Object(Ln.jsx)("div",{className:"AccountInfoRow",children:Object(Ln.jsxs)("div",{className:"AccountInfoCell",children:[n.isUnfunded&&Object(Ln.jsx)("div",{className:"InfoButtonWrapper",children:Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["Clicking create will fund your test account with XLM. If you\u2019re testing SEP-24 you may want to leave this account unfunded."," ",Object(Ln.jsx)(o.TextLink,{href:"https://developers.stellar.org/docs/tutorials/create-account/#create-account",children:"Learn more"})]}),children:Object(Ln.jsx)(o.TextLink,{onClick:function(){var e;(null===(e=n.data)||void 0===e?void 0:e.id)&&u(V(n.data.id))},disabled:l,children:"Create account"})})}),!n.isUnfunded&&Object(Ln.jsx)(o.TextLink,{onClick:function(){return i(!s)},children:"".concat(s?"Hide":"Show"," account details")})]})}),Object(Ln.jsx)("div",{className:"AccountInfoRow",children:Object(Ln.jsx)("div",{className:"AccountInfoCell",children:Object(Ln.jsx)("div",{className:"InfoButtonWrapper",children:Object(Ln.jsx)(o.DetailsTooltip,{details:"If you performed account actions elsewhere, like in the Stellar Laboratory, click here to update.",children:Object(Ln.jsx)(o.TextLink,{onClick:d,disabled:l,children:"Refresh account"})})})})})]})]}),s&&Object(Ln.jsxs)("div",{className:"AccountDetails Section",children:[Object(Ln.jsx)(o.Heading2,{children:"Account details"}),Object(Ln.jsx)("div",{className:"AccountDetailsContent",children:Object(Ln.jsx)(tr,{src:n.data})})]}),Object(Ln.jsx)(hr,{parentId:"app-wrapper",visible:l,children:Object(Ln.jsxs)("div",{className:"Layout__inline",children:[Object(Ln.jsx)("span",{children:"Updating account"}),Object(Ln.jsx)(o.Loader,{})]})})]})},vr=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.assetCode,r=t.assetIssuer,a=t.networkUrl,s=t.accountBalances,i="".concat(n,":").concat(r),!s||!(null===s||void 0===s?void 0:s[i])){e.next=4;break}throw new Error("Asset `".concat(i,"` is already trusted"));case 4:return c=new S.Server(a),e.next=7,c.assets().forCode(n).forIssuer(r).call();case 7:if(e.sent.records.length){e.next=10;break}throw new Error("Asset `".concat(i,"` does not exist"));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mr=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=A(t),e.next=7;break;case 4:throw e.prev=4,e.t0=e.catch(0),new Error("Anchor home domain is not a valid URL using HTTPS");case 7:if(e.prev=7,"http:"!==n.protocol){e.next=14;break}return e.next=11,S.StellarTomlResolver.resolve(n.host,{allowHttp:!0});case 11:e.t1=e.sent,e.next=17;break;case 14:return e.next=16,S.StellarTomlResolver.resolve(n.host);case 16:e.t1=e.sent;case 17:if((r=e.t1).CURRENCIES){e.next=20;break}throw new Error("The home domain specified does not have a `CURRENCIES` section on its TOML file");case 20:return e.abrupt("return",r.CURRENCIES);case 23:throw e.prev=23,e.t2=e.catch(7),new Error("`".concat(t,"` is not a valid home domain, TOML file was not found"));case 26:case"end":return e.stop()}}),e,null,[[0,4],[7,23]])})));return function(t){return e.apply(this,arguments)}}(),Sr=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.assetIssuer,r=t.homeDomain,a=t.networkUrl,s=new S.Server(a),e.next=4,s.loadAccount(n);case 4:if(i=e.sent,(c=i.home_domain)===r){e.next=9;break}return F.a.instruction({title:"Entered home domain `".concat(r,"` will override asset\u2019s home domain `").concat(c||"not configured","`")}),e.abrupt("return",r);case 9:return e.abrupt("return",void 0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Or=function(e,t){return e&&e.length?e.map((function(e){return e[t]})).join(", "):""},Er=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c,o,u,d,l;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.assetCode,r=t.homeDomain,a=t.issuerPublicKey,s=t.networkUrl,i=t.accountBalances,e.next=3,mr(r);case 3:if(c=e.sent,o=c.filter((function(e){return e.code===n})),u=Or(c,"code"),d=Or(o,"issuer"),o.length){e.next=9;break}throw new Error("Unable to find the ".concat(n," asset on `").concat(r,"` TOML file.\n      Available assets: ").concat(u,"."));case 9:if(!a){e.next=23;break}if(!o.find((function(e){return e.issuer===a}))){e.next=20;break}return e.next=14,vr({assetCode:n,assetIssuer:a,networkUrl:s,accountBalances:i});case 14:return e.t0=n,e.t1=a,e.next=18,Sr({assetIssuer:a,homeDomain:r,networkUrl:s});case 18:return e.t2=e.sent,e.abrupt("return",{assetCode:e.t0,assetIssuer:e.t1,homeDomain:e.t2});case 20:throw new Error("Unable to find the ".concat(n," asset from issuer `").concat(a,"` on `").concat(r,"` TOML file.\n      Available issuers for ").concat(n,": ").concat(d,"."));case 23:if(1!==o.length){e.next=33;break}return l=o[0].issuer,e.next=27,vr({assetCode:n,assetIssuer:l,networkUrl:s,accountBalances:i});case 27:return e.t3=n,e.t4=l,e.next=31,Sr({assetIssuer:l,homeDomain:r,networkUrl:s});case 31:return e.t5=e.sent,e.abrupt("return",{assetCode:e.t3,assetIssuer:e.t4,homeDomain:e.t5});case 33:throw new Error("Multiple issuers found for asset ".concat(n,", please provide issuer public key.\n          Available issuers for ").concat(n,": ").concat(d,"."));case 34:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),gr=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r,a,s,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.assetCode,r=t.homeDomain,a=t.issuerPublicKey,s=t.accountBalances,i=t.networkUrl,F.a.instruction({title:"Validating untrusted asset ".concat(n)}),!n||r||a){e.next=4;break}throw new Error("Home domain OR issuer public key is required with asset code");case 4:if(!a||r){e.next=8;break}return e.next=7,vr({assetCode:n,assetIssuer:a,networkUrl:i,accountBalances:s});case 7:return e.abrupt("return",{assetCode:n,assetIssuer:a});case 8:if(!r){e.next=18;break}return e.prev=9,e.next=12,Er({assetCode:n,homeDomain:r,issuerPublicKey:a,networkUrl:i,accountBalances:s});case 12:return e.abrupt("return",e.sent);case 15:throw e.prev=15,e.t0=e.catch(9),new Error(P(e.t0));case 18:throw c="No asset was found matching provided information",F.a.error({title:c,body:{assetCode:n,homeDomain:r,issuerPublicKey:a}}),new Error(c);case 21:case"end":return e.stop()}}),e,null,[[9,15]])})));return function(t){return e.apply(this,arguments)}}(),xr=function(e){var t=e.onClose,n=Vn("account","settings","untrustedAssets"),r=n.account,a=n.settings,s=n.untrustedAssets,c=Object(Un.useState)(!1),u=Object(w.a)(c,2),d=u[0],l=u[1],p=Object(Un.useState)(""),b=Object(w.a)(p,2),h=b[0],f=b[1],m=Object(Un.useState)(""),S=Object(w.a)(m,2),O=S[0],E=S[1],g=Object(Un.useState)(""),x=Object(w.a)(g,2),y=x[0],T=x[1],A=Object(Un.useState)(""),C=Object(w.a)(A,2),N=C[0],k=C[1],I=Object(i.g)();Object(Un.useEffect)((function(){return function(){return f(""),E(""),T(""),k(""),void l(!1)}}),[]),Object(Un.useEffect)((function(){s.status===R.a.SUCCESS&&t(),s.errorString&&k(s.errorString)}),[s.status,s.errorString,t]);var _=function(){var e=Object(v.a)(j.a.mark((function e(){var t,n,s,i,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k(""),O||y){e.next=6;break}return t="Home domain OR issuer public key is required with asset code",F.a.error({title:t}),k(t),e.abrupt("return");case 6:return l(!0),e.prev=7,e.next=10,gr({assetCode:h,homeDomain:O,issuerPublicKey:y,accountBalances:null===(n=r.data)||void 0===n?void 0:n.balances,networkUrl:M(a.pubnet).url});case 10:s=e.sent,i=Yn.update(R.i.UNTRUSTED_ASSETS,"".concat(s.assetCode,":").concat(s.assetIssuer)),s.homeDomain&&(i=Yn.updateKeyPair({param:R.i.ASSET_OVERRIDES,itemId:"".concat(s.assetCode,":").concat(s.assetIssuer),keyPairs:{homeDomain:O},urlSearchParams:new URLSearchParams(i)})),I.push(i),l(!1),e.next=23;break;case 17:e.prev=17,e.t0=e.catch(7),c=P(e.t0),F.a.error({title:c}),k(c),l(!1);case 23:case"end":return e.stop()}}),e,null,[[7,17]])})));return function(){return e.apply(this,arguments)}}(),D=d||s.status===R.a.PENDING;return Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Modal.Heading,{children:"Add asset"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)("p",{children:"Required: asset code AND (home domain OR issuer)"}),Object(Ln.jsx)(o.Input,{id:"aa-asset-code",label:Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["Assets are identified by 1) their code and 2) either a home domain or the public key of the issuing account."," ",Object(Ln.jsx)(o.TextLink,{href:"https://developers.stellar.org/docs/issuing-assets/publishing-asset-info/",children:"Learn more"})]}),isInline:!0,tooltipPosition:o.DetailsTooltip.tooltipPosition.left,children:Object(Ln.jsx)(Ln.Fragment,{children:"Asset code"})}),onChange:function(e){k(""),f(e.target.value)},value:h,placeholder:"ex: USDC, EURT, NGNT"}),Object(Ln.jsx)(o.Input,{id:"aa-home-domain",label:Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["Domain where the well-known TOML file can be found for this asset."," ",Object(Ln.jsx)(o.TextLink,{href:"https://developers.stellar.org/docs/issuing-assets/publishing-asset-info/#what-is-a-stellartoml",children:"Learn more"})]}),isInline:!0,tooltipPosition:o.DetailsTooltip.tooltipPosition.left,children:Object(Ln.jsx)(Ln.Fragment,{children:"Anchor home domain"})}),onChange:function(e){k(""),E(e.target.value)},value:O,placeholder:"ex: example.com"}),Object(Ln.jsx)(o.Input,{id:"aa-public-key",label:Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["Public key for the Asset Issuer."," ",Object(Ln.jsx)(o.TextLink,{href:"https://developers.stellar.org/docs/issuing-assets/how-to-issue-an-asset",children:"Learn more"})]}),isInline:!0,tooltipPosition:o.DetailsTooltip.tooltipPosition.left,children:Object(Ln.jsx)(Ln.Fragment,{children:"Issuer public key"})}),onChange:function(e){k(""),T(e.target.value)},value:y,placeholder:"ex: GCDNJUBQSX7AJWLJACMJ7I4BC3Z47BQUTMHEICZLE6MU4KQBRYG5JY6B"}),N&&Object(Ln.jsx)(o.InfoBlock,{variant:o.InfoBlock.variant.error,children:Object(Ln.jsx)("p",{children:N})})]}),Object(Ln.jsx)(o.Modal.Footer,{children:Object(Ln.jsx)(o.Button,{onClick:_,disabled:!h,isLoading:D,children:"Add"})})]})},yr=[{assetCode:"USDC",issuerPublicKey:"GBBD47IF6LWK7P7MDEVSCWR7DPUWV3NY3DTQEVFL4NAT4AQH3ZLLFLA5"},{assetCode:"SRT",homeDomain:"testanchor.stellar.org"},{assetCode:"MYASSET",homeDomain:"sep8-server.dev.stellar.org"}],Tr=function(e){return yr.filter((function(t){return!e.some((function(e){return e.assetCode===t.assetCode&&(e.homeDomain===t.homeDomain||e.assetIssuer===t.issuerPublicKey)}))}))},wr=function(e){var t=e.onClose,n=Vn("account","allAssets","settings","untrustedAssets"),r=n.account,a=n.allAssets,s=n.settings,c=n.untrustedAssets,u=Object(Un.useState)([]),d=Object(w.a)(u,2),l=d[0],p=d[1],b=Object(Un.useState)({}),h=Object(w.a)(b,2),f=h[0],m=h[1],S=Object(Un.useState)(!1),O=Object(w.a)(S,2),g=O[0],x=O[1],y=Object(Un.useState)(""),T=Object(w.a)(y,2),A=T[0],C=T[1],N=Object(i.g)();Object(Un.useEffect)((function(){p(Tr(a.data))}),[a]),Object(Un.useEffect)((function(){c.status===R.a.SUCCESS&&t(),c.errorString&&C(c.errorString)}),[t,c.errorString,c.status]);var k=function(e){return"".concat(e.assetCode,":").concat(e.homeDomain||e.issuerPublicKey)},I=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,a,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(""),x(!0),e.prev=2,e.next=5,Promise.all(t.map(function(){var e=Object(v.a)(j.a.mark((function e(t){var n,a,i,c,o,u;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.assetCode,i=t.issuerPublicKey,(c=t.homeDomain)||i){e.next=4;break}throw o="Home domain OR issuer public key is required with asset code ".concat(a),new Error(o);case 4:return e.next=6,gr({assetCode:a,homeDomain:c,issuerPublicKey:i,accountBalances:null===(n=r.data)||void 0===n?void 0:n.balances,networkUrl:M(s.pubnet).url});case 6:return u=e.sent,e.abrupt("return","".concat(u.assetCode,":").concat(u.assetIssuer));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:n=e.sent,a=Yn.update(R.i.UNTRUSTED_ASSETS,n.join(",")),N.push(a),e.next=17;break;case 10:return e.prev=10,e.t0=e.catch(2),i=P(e.t0),F.a.error({title:i}),C(i),x(!1),e.abrupt("return");case 17:x(!1);case 18:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),_=g||c.status===R.a.PENDING;return Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Modal.Heading,{children:"Add preset asset"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)("p",{children:"Select one or more assets"}),Object(Ln.jsx)("div",{className:"PresetAssets",children:l.map((function(e){var t=e.homeDomain,n=e.issuerPublicKey,r=k(e),a=M(s.pubnet).url.replace("https:",""),i=t&&"//".concat(t,"/.well-known/stellar.toml")||n&&"".concat(a,"/accounts/").concat(n),c=t||n&&fr(n);return Object(Ln.jsxs)("div",{className:"PresetAssetRow",children:[Object(Ln.jsx)(o.Checkbox,{id:r,label:"",checked:Boolean(f[r]),onChange:function(){var e=Object(E.a)({},f);e[r]=!f[r],m(e)},disabled:_}),Object(Ln.jsxs)("div",{children:[Object(Ln.jsx)("div",{className:"PresetAssetCode",children:e.assetCode}),Object(Ln.jsx)("div",{className:"PresetAssetIssuer",children:c&&Object(Ln.jsx)(o.TextLink,{href:i,children:c})})]})]},"preset-asset-".concat(r))}))}),A&&Object(Ln.jsx)(o.InfoBlock,{variant:o.InfoBlock.variant.error,children:Object(Ln.jsx)("p",{children:A})})]}),Object(Ln.jsx)(o.Modal.Footer,{children:Object(Ln.jsx)(o.Button,{onClick:function(){var e=l.flatMap((function(e){var t=k(e);return f[t]?e:[]}));I(e)},disabled:!Object.values(f).some((function(e){return!0===e})),isLoading:_,children:"Confirm"})})]})},Ar=function(e){var t=e.onClose,n=Vn("activeAsset").activeAsset;if(!(null===n||void 0===n?void 0:n.action))return null;var r=n.action,a=r.title,s=r.description,i=r.callback,c=r.options;return Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Modal.Heading,{children:a}),Object(Ln.jsxs)(o.Modal.Body,{children:[s&&("string"===typeof s?Object(Ln.jsx)("p",{children:s}):s),c&&Object(Ln.jsx)("p",{children:c})]}),Object(Ln.jsxs)(o.Modal.Footer,{children:[Object(Ln.jsx)(o.Button,{onClick:function(){i()},children:"Start"}),Object(Ln.jsx)(o.Button,{variant:o.Button.variant.secondary,onClick:t,children:"Cancel"})]})]})},Cr=function(e){var t=e.asset,n=e.onClose,r=Vn("settings").settings,a=Object(i.g)(),s=Object(Un.useState)(""),c=Object(w.a)(s,2),u=c[0],d=c[1],l=Object(Un.useState)(""),p=Object(w.a)(l,2),b=p[0],h=p[1],f=Object(Un.useState)(!1),m=Object(w.a)(f,2),S=m[0],O=m[1],E=function(){var e=Object(v.a)(j.a.mark((function e(){var s,i,c,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(""),O(!0),s=t.assetCode,i=t.assetIssuer,c=M(r.pubnet).url,e.prev=4,e.next=7,Er({assetCode:s,homeDomain:u,issuerPublicKey:i,networkUrl:c});case 7:if(!e.sent.homeDomain){e.next=13;break}a.push(Yn.updateKeyPair({param:R.i.ASSET_OVERRIDES,itemId:"".concat(t.assetCode,":").concat(t.assetIssuer),keyPairs:{homeDomain:u}})),n(),e.next=14;break;case 13:throw new Error("Override home domain is the same as ".concat(t.assetCode," asset home domain"));case 14:e.next=22;break;case 16:e.prev=16,e.t0=e.catch(4),o=P(e.t0),h(o),F.a.error({title:o}),O(!1);case 22:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(){return e.apply(this,arguments)}}();return Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Modal.Heading,{children:"Override home domain"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)("p",{children:"Asset ".concat(t.assetCode," currently has ").concat(t.homeDomain||"no"," home domain.")}),Object(Ln.jsx)(o.Input,{id:"hdo-home-domain",label:"Anchor home domain",onChange:function(e){h(""),d(e.target.value)},value:u,placeholder:"ex: example.com"}),b&&Object(Ln.jsx)(o.InfoBlock,{variant:o.InfoBlock.variant.error,children:Object(Ln.jsx)("p",{children:b})})]}),Object(Ln.jsxs)(o.Modal.Footer,{children:[Object(Ln.jsx)(o.Button,{onClick:E,disabled:!u,isLoading:S,children:"Override"}),Object(Ln.jsx)(o.Button,{onClick:n,disabled:S,variant:o.Button.variant.secondary,children:"Cancel"})]})]})},Rr=function(e){var t,n=e.asset,r=Object(Un.useState)(""),a=Object(w.a)(r,2),s=a[0],u=a[1],d=Vn("assetOverrides").assetOverrides,l=Object(c.b)(),p=Object(i.g)();!function(e){e.REMOVE_ASSET_OVERRIDE="REMOVE_ASSET_OVERRIDE",e.ASSET_OVERRIDE="ASSET_OVERRIDE"}(t||(t={}));var b=function(e){var r;switch(u(e),e){case t.ASSET_OVERRIDE:r={assetString:n.assetString,title:"",callback:function(){}};break;case t.REMOVE_ASSET_OVERRIDE:r={assetString:n.assetString,title:"Remove ".concat(n.assetCode," home domain override"),description:"Asset ".concat(n.assetCode,"\u2019s home domain ").concat(n.homeDomain," override will be removed. Original home domain will be used, if it exists."),callback:h}}l(ee(r))},h=function(){p.push(Yn.removeKeyPair({param:R.i.ASSET_OVERRIDES,itemId:n.assetString})),F.a.instruction({title:"Asset\u2019s ".concat(n.assetCode," home domain override `").concat(n.homeDomain,"` removed")}),f()},f=function(){u(""),l(ne())};return d.status===R.a.PENDING?Object(Ln.jsx)(o.Loader,{}):Object(Ln.jsxs)(Ln.Fragment,{children:[n.homeDomain?Object(Ln.jsx)(o.IconButton,{icon:Object(Ln.jsx)(o.Icon.Edit2,{}),altText:"Edit home domain",onClick:function(){return b(t.ASSET_OVERRIDE)}}):Object(Ln.jsx)(o.TextLink,{onClick:function(){return b(t.ASSET_OVERRIDE)},children:"Add home domain"}),n.isOverride&&Object(Ln.jsx)(o.IconButton,{icon:Object(Ln.jsx)(o.Icon.XCircle,{}),altText:"Remove home domain override",onClick:function(){return b(t.REMOVE_ASSET_OVERRIDE)},variant:o.IconButton.variant.error}),Object(Ln.jsxs)(o.Modal,{visible:Boolean(s),onClose:f,parentId:se.a,children:[s===t.REMOVE_ASSET_OVERRIDE&&Object(Ln.jsx)(Ar,{onClose:f}),s===t.ASSET_OVERRIDE&&Object(Ln.jsx)(Cr,{asset:n,onClose:f})]})]})},Nr=function(e){var t=e.activeAction,n=e.asset,r=e.onAction,a=e.children,s=n.assetString,i=n.assetCode,c=n.assetIssuer,u=n.total,d=n.supportedActions,l=n.isUntrusted,p=n.notExist,b=n.homeDomain,h=(null===t||void 0===t?void 0:t.assetString)===s,f=Boolean(t),j=Object(Un.useState)(""),v=Object(w.a)(j,2),m=v[0],S=v[1];Object(Un.useEffect)((function(){h||S("")}),[h]);var O=function(e){var t=e.target.value;S(t),r&&r(t,n)};return Object(Ln.jsxs)("div",{className:"BalanceRow Layout__inset ".concat(h?"active":""," ").concat(f?"disabled":""),children:[Object(Ln.jsx)("div",{className:"BalanceCell BalanceInfo",children:p?Object(Ln.jsx)("div",{className:"BalanceAmount error",children:"".concat(i,":").concat(fr(c)," does not exist")}):Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)("div",{className:"BalanceAmount",children:"".concat(u||"0"," ").concat(i)}),Object(Ln.jsxs)("div",{className:"BalanceOptions Layout__inline",children:[b&&Object(Ln.jsx)(o.TextLink,{href:"//".concat(b,"/.well-known/stellar.toml"),variant:o.TextLink.variant.secondary,underline:!0,children:b}),!n.isClaimableBalance&&n.assetType!==R.e.NATIVE&&Object(Ln.jsx)(Rr,{asset:n})]})]})}),(null===d||void 0===d?void 0:d.sep8)&&Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["Payments with regulated assets need to be approved by the asset issuer. For more information please refer to ",Object(Ln.jsx)(o.TextLink,{href:"https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0008.md",children:"SEP-8"}),"."]}),children:Object(Ln.jsx)("span",{children:"Regulated"})}),Object(Ln.jsxs)("div",{className:"BalanceCell BalanceActions",children:[a&&Object(Ln.jsx)("div",{className:"CustomCell",children:a}),function(){var e,t,a;return r?l&&(null===(e=n.supportedActions)||void 0===e?void 0:e.sep8)?null:Object(Ln.jsx)("div",{className:"BalanceCellSelect",children:Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["What you can do with an asset (deposit, withdraw, or send) depends on what transactions the anchor supports."," ",Object(Ln.jsx)(o.TextLink,{href:"https://developers.stellar.org/docs/anchoring-assets",children:"Learn more"})]}),children:Object(Ln.jsxs)(o.Select,{id:"".concat(s,"-actions"),onChange:O,disabled:f,value:m,children:[Object(Ln.jsx)("option",{value:"",children:"Select action"}),!l&&!(null===(t=n.supportedActions)||void 0===t?void 0:t.sep8)&&Object(Ln.jsx)("option",{value:R.c.SEND_PAYMENT,children:"Send payment"}),(null===d||void 0===d?void 0:d.sep6)&&Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)("option",{value:R.c.SEP6_DEPOSIT,children:"SEP-6 Deposit"}),!l&&Object(Ln.jsx)("option",{value:R.c.SEP6_WITHDRAW,children:"SEP-6 Withdraw"})]}),!l&&(null===(a=n.supportedActions)||void 0===a?void 0:a.sep8)&&Object(Ln.jsx)("option",{value:R.c.SEP8_SEND_PAYMENT,children:"SEP-8 Send"}),(null===d||void 0===d?void 0:d.sep24)&&Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)("option",{value:R.c.SEP24_DEPOSIT,children:"SEP-24 Deposit"}),!l&&Object(Ln.jsx)("option",{value:R.c.SEP24_WITHDRAW,children:"SEP-24 Withdraw"})]}),!l&&(null===d||void 0===d?void 0:d.sep31)&&Object(Ln.jsx)("option",{value:R.c.SEP31_SEND,children:"SEP-31 Send"})]})})}):null}()]})]},s)},kr=function(e){var t=e.onAssetAction,n=e.onSend,r=Vn("activeAsset","allAssets"),a=r.activeAsset,s=r.allAssets.data.filter((function(e){return e.category===R.d.TRUSTED})),i=Object(c.b)(),u=function(e){var r=e.actionId,a=e.balance;if(r){var s,c={assetString:a.assetString,balance:a};switch(r){case R.c.SEND_PAYMENT:s=Object(E.a)(Object(E.a)({},c),{},{title:"Send ".concat(a.assetCode),description:Object(Ln.jsxs)("p",{children:["Send ".concat(a.assetCode," on-chain to another account.")," ",Object(Ln.jsx)(o.TextLink,{href:"https://developers.stellar.org/docs/tutorials/send-and-receive-payments/",children:"Learn more"})]}),callback:n});break;case R.c.SEP6_DEPOSIT:s=Object(E.a)(Object(E.a)({},c),{},{title:"SEP-6 deposit ".concat(a.assetCode," (with Trusted Asset)"),description:"Start SEP-6 deposit of trusted asset ".concat(a.assetCode,"?"),callback:function(){i(et(a))}});break;case R.c.SEP6_WITHDRAW:s=Object(E.a)(Object(E.a)({},c),{},{title:"SEP-6 withdrawal ".concat(a.assetCode),description:"Start SEP-6 withdrawal of ".concat(a.assetCode,"?"),callback:function(){i(ot(a))}});break;case R.c.SEP8_SEND_PAYMENT:s=Object(E.a)(Object(E.a)({},c),{},{title:"SEP-8 send ".concat(a.assetCode),description:Object(Ln.jsxs)("p",{children:["Payments with regulated assets need to be approved by the asset issuer. For more information please refer to"," ",Object(Ln.jsx)(o.TextLink,{href:"https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0008.md",children:"SEP-8"}),"."]}),callback:function(){i(yt(a))}});break;case R.c.SEP24_DEPOSIT:s=Object(E.a)(Object(E.a)({},c),{},{title:"SEP-24 deposit ".concat(a.assetCode," (with Trusted Asset)"),description:"Start SEP-24 deposit of trusted asset ".concat(a.assetCode,"?"),callback:function(){i(Kt(a))}});break;case R.c.SEP24_WITHDRAW:s=Object(E.a)(Object(E.a)({},c),{},{title:"SEP-24 withdrawal ".concat(a.assetCode),description:"Start SEP-24 withdrawal of ".concat(a.assetCode,"?"),callback:function(){i(Ht(a))}});break;case R.c.SEP31_SEND:var u="Start SEP-31 send to ".concat(a.assetCode,"?\n\n");u+="Please be aware that specifically in the case of demo-ing SEP-31 in the Demo Wallet the public and secret keys don't represent the Sending Client but instead the Sending Anchor's account.\n\n",u+="In SEP-31, the only Stellar transaction happening is between the Sending and the Receiving anchors.",s=Object(E.a)(Object(E.a)({},c),{},{title:"SEP-31 send ".concat(a.assetCode),description:u,callback:function(){i(cn(a))}})}s&&t(s)}},l=function(){if(!s)return null;var e={native:[],other:[]};return s.map((function(t){return t.assetType===R.e.NATIVE?e.native=[].concat(Object(d.a)(e.native),[t]):e.other=[].concat(Object(d.a)(e.other),[t]),e})),e}();return l?Object(Ln.jsxs)(Ln.Fragment,{children:[l.native.map((function(e){return Object(Ln.jsx)(Nr,{activeAction:a.action,asset:e,onAction:function(e,t){return u({actionId:e,balance:t})}},e.assetString)})),l.other.map((function(e){return Object(Ln.jsx)(Nr,{activeAction:a.action,asset:e,onAction:function(e,t){return u({actionId:e,balance:t})}},e.assetString)}))]}):null},Ir=function(e){var t=e.onAssetAction,n=Vn("activeAsset","claimableBalances"),r=n.activeAsset,a=n.claimableBalances.data.records,s=Object(c.b)();return a&&a.length?Object(Ln.jsxs)("div",{className:"ClaimableBalances",children:[Object(Ln.jsx)(o.Layout.Inset,{children:Object(Ln.jsx)(o.Heading2,{children:"Claimable Balances"})}),Object(Ln.jsx)("div",{className:"Balances",children:a.map((function(e){return Object(Ln.jsx)(Nr,{activeAction:r.action,asset:e,children:Object(Ln.jsx)(o.TextLink,{onClick:function(){return function(e){t({assetString:e.assetString,balance:e,title:"Claim balance ".concat(e.assetCode),description:"Claimable balance description ".concat(e.total," ").concat(e.assetCode),callback:function(){return s(ke(e))}})}(e)},disabled:Boolean(r.action),children:"Claim"})},e.assetString)}))})]}):null},_r=function(e){var t=e.onAssetAction,n=Vn("account","activeAsset","allAssets","settings","trustAsset"),r=n.account,a=n.activeAsset,s=n.allAssets,u=n.settings,d=n.trustAsset,l=Object(c.b)(),p=Object(i.g)(),b=s.data.filter((function(e){return e.category===R.d.UNTRUSTED}));Object(Un.useEffect)((function(){u.untrustedAssets&&l(fe(u.untrustedAssets))}),[u.untrustedAssets,l]);var h=function(e){var n=e.actionId,r=e.asset;if(n){var a,s={assetString:r.assetString,balance:r},i="A lumen is the only asset type that can be used on the Stellar network that doesn\u2019t require an issuer or a trustline.";switch(n){case R.c.SEP6_DEPOSIT:a=Object(E.a)(Object(E.a)({},s),{},{title:"SEP-6 deposit ".concat(r.assetCode," (with untrusted Asset)"),description:"Start SEP-6 deposit of untrusted asset ".concat(r.assetCode,"? ").concat(i),callback:function(){return function(e){l(et(e))}(r)}});break;case R.c.SEP24_DEPOSIT:a=Object(E.a)(Object(E.a)({},s),{},{title:"SEP-24 deposit ".concat(r.assetCode," (with untrusted Asset)"),description:"Start SEP-24 deposit of untrusted asset ".concat(r.assetCode,"? ").concat(i),callback:function(){return function(e){l(Kt(e))}(r)}});break;case R.c.TRUST_ASSET:a=Object(E.a)(Object(E.a)({},s),{},{title:"Add Trustline \u201cTrust Asset ".concat(r.assetCode,"\u201d?"),description:Object(Ln.jsxs)("p",{children:["You are about to create a trustline to asset"," ",Object(Ln.jsx)("code",{children:"".concat(r.assetCode,":").concat(r.assetIssuer)}),". This will allow you to hold this asset."," ",Object(Ln.jsx)(o.TextLink,{href:"https://developers.stellar.org/docs/issuing-assets/anatomy-of-an-asset/#trustlines",children:"Learn more"})]}),callback:function(){return function(e){var t=e.assetString,n=e.assetCode,r=e.assetIssuer;l(An({assetString:t,assetCode:n,assetIssuer:r}))}(r)}});break;case R.c.REMOVE_ASSET:a=Object(E.a)(Object(E.a)({},s),{},{title:"Remove asset ".concat(r.assetCode),description:Object(Ln.jsxs)("p",{children:["Asset ",Object(Ln.jsx)("code",{children:"".concat(r.assetCode,":").concat(r.assetIssuer)})," ","does not exist, remove it?"]}),callback:function(){return function(e){var t=e.assetString;p.push(Yn.remove(R.i.UNTRUSTED_ASSETS,t)),l(je(t)),F.a.instruction({title:"Untrusted asset `".concat(t,"` removed")}),l(ge()),l(ne())}(r)}})}a&&t(a)}},f=Boolean(a.action)||d.status===R.a.PENDING;return Object(Ln.jsx)(Ln.Fragment,{children:b.map((function(e){return e.isUntrusted?Object(Ln.jsx)(Nr,{activeAction:a.action,asset:e,onAction:function(e,t){return h({actionId:e,asset:t})},children:Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["Adding a trustline means you trust an issuer to redeem its credit. If you\u2019re testing SEP-24 or SEP-6 you may not want to do this."," ",Object(Ln.jsx)(o.TextLink,{href:"https://developers.stellar.org/docs/issuing-assets/anatomy-of-an-asset/#trustlines",children:"Learn more"})]}),children:Object(Ln.jsx)(o.TextLink,{onClick:function(){return h({actionId:R.c.TRUST_ASSET,asset:e})},disabled:r.isUnfunded||f,children:"Add trustline"})})},e.assetString):Object(Ln.jsx)(Nr,{activeAction:a.action,asset:e,children:Object(Ln.jsx)(o.TextLink,{onClick:function(){return h({actionId:R.c.REMOVE_ASSET,asset:e})},disabled:f,children:"Remove"})},e.assetString)}))})},Pr=function(e){var t,n,r,a,s=e.onSendPayment,u=Vn("account","activeAsset","allAssets","assetOverrides","claimAsset","sep6DepositAsset","sep6WithdrawAsset","sep24DepositAsset","sep24WithdrawAsset","sep31Send","settings","trustAsset","untrustedAssets"),d=u.account,l=u.activeAsset,p=u.allAssets,b=u.assetOverrides,h=u.claimAsset,f=u.sep6DepositAsset,j=u.sep6WithdrawAsset,v=u.sep24DepositAsset,m=u.sep24WithdrawAsset,S=u.sep31Send,O=u.settings,E=u.trustAsset,g=u.untrustedAssets,x=Object(Un.useState)(""),y=Object(w.a)(x,2),T=y[0],A=y[1],C=Object(Un.useState)(),N=Object(w.a)(C,2),k=N[0],I=N[1],_=Object(c.b)(),P=Object(i.g)();!function(e){e.ADD_ASSET="ADD_ASSET",e.ADD_PRESET_ASSET="ADD_PRESET_ASSET",e.CONFIRM_ACTION="CONFIRM_ACTION"}(a||(a={}));var D=Object(Un.useCallback)((function(e){e&&(P.push(Yn.remove(R.i.UNTRUSTED_ASSETS,e)),_(je(e)))}),[P,_]),U=Object(Un.useCallback)((function(){var e;(null===(e=d.data)||void 0===e?void 0:e.id)&&_(K({publicKey:d.data.id,secretKey:d.secretKey}))}),[null===(t=d.data)||void 0===t?void 0:t.id,d.secretKey,_]),L=Object(Un.useCallback)((function(){var e;(null===(e=d.data)||void 0===e?void 0:e.id)&&_(Ue({publicKey:d.data.id}))}),[null===(n=d.data)||void 0===n?void 0:n.id,_]),B=function(){A(""),_(ne())},M=function(e){var t=e.assetString,n=e.balance,r=e.callback,s=e.title,i=e.description,c=e.options;A(a.CONFIRM_ACTION),_(ee({assetString:t,title:s,description:i,callback:function(){A(""),r(n)},options:c}))},F=Object(Un.useCallback)((function(e){var t=e.status,n=e.message;t&&(t!==R.a.SUCCESS&&t!==R.a.ERROR||_(ne()),t!==R.a.PENDING&&t!==R.a.NEEDS_INPUT||(_(te(R.a.PENDING)),I(n)))}),[_]);return Object(Un.useEffect)((function(){l.action||I(void 0)}),[l.action]),Object(Un.useEffect)((function(){d.status===R.a.SUCCESS&&(_(Q()),_(ye()))}),[d.status,_]),Object(Un.useEffect)((function(){p.status===R.a.SUCCESS&&_(Ce())}),[p.status,_]),Object(Un.useEffect)((function(){_(ce(O.assetOverrides))}),[O.assetOverrides,_]),Object(Un.useEffect)((function(){b.status===R.a.SUCCESS&&(_(pe()),_(ye()))}),[b.status,_]),Object(Un.useEffect)((function(){E.status===R.a.SUCCESS&&(P.push(Yn.remove(R.i.UNTRUSTED_ASSETS,E.assetString)),_(je(E.assetString)),_(kn()),U()),F({status:E.status,message:"Trust asset in progress"})}),[E.status,E.assetString,U,F,_,P]),Object(Un.useEffect)((function(){f.status===R.a.SUCCESS&&f.data.trustedAssetAdded&&D(f.data.trustedAssetAdded),f.data.currentStatus===R.p.COMPLETED&&(U(),L()),F({status:f.status,message:"SEP-6 deposit in progress"})}),[f.status,f.data.currentStatus,f.data.trustedAssetAdded,U,L,D,F]),Object(Un.useEffect)((function(){j.status===R.a.SUCCESS&&j.data.currentStatus===R.p.COMPLETED&&U(),F({status:j.status,message:"SEP-6 withdrawal in progress"})}),[j.status,j.data.currentStatus,U,F]),Object(Un.useEffect)((function(){v.status===R.a.SUCCESS&&(_(qt()),v.data.trustedAssetAdded&&D(v.data.trustedAssetAdded),v.data.currentStatus===R.p.COMPLETED&&(U(),L())),F({status:v.status,message:"SEP-24 deposit in progress"})}),[v.status,v.data.currentStatus,v.data.trustedAssetAdded,U,L,D,F,_,P]),Object(Un.useEffect)((function(){m.status===R.a.SUCCESS&&(_(zt()),m.data.currentStatus===R.p.COMPLETED&&U()),F({status:m.status,message:"SEP-24 withdrawal in progress"})}),[m.status,m.data.currentStatus,U,F,_,P]),Object(Un.useEffect)((function(){h.status===R.a.SUCCESS&&(D(h.data.trustedAssetAdded),_(De()),U(),L()),F({status:h.status,message:"Claim asset in progress"})}),[h.status,h.data.trustedAssetAdded,null===(r=d.data)||void 0===r?void 0:r.id,U,L,D,F,_]),Object(Un.useEffect)((function(){F({status:S.status,message:"SEP-31 send in progress"})}),[S.status,F]),Object(Un.useEffect)((function(){g.status!==R.a.SUCCESS&&g.status!==R.a.ERROR||(_(ye()),_(ge()),_(ne()))}),[g.status,_]),Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsxs)("div",{className:"Section",children:[Object(Ln.jsx)(o.Layout.Inset,{children:Object(Ln.jsx)(o.Heading2,{children:"Balances"})}),Object(Ln.jsxs)("div",{className:"Balances",children:[Object(Ln.jsx)(kr,{onSend:s,onAssetAction:M}),Object(Ln.jsx)(_r,{onAssetAction:M})]}),Object(Ln.jsx)(o.Layout.Inset,{children:Object(Ln.jsxs)("div",{className:"BalancesButtons",children:[Object(Ln.jsx)(o.Button,{onClick:function(){return A(a.ADD_ASSET)},disabled:Boolean(l.action),children:"Add asset"}),!O.pubnet&&Tr(p.data).length>0&&Object(Ln.jsx)(o.TextLink,{onClick:function(){return A(a.ADD_PRESET_ASSET)},disabled:Boolean(l.action),children:"Select from preset assets"})]})})]}),Object(Ln.jsx)(Ir,{onAssetAction:M}),Object(Ln.jsxs)(o.Modal,{visible:Boolean(T),onClose:B,parentId:se.a,children:[T===a.CONFIRM_ACTION&&Object(Ln.jsx)(Ar,{onClose:B}),T===a.ADD_ASSET&&Object(Ln.jsx)(xr,{onClose:B}),T===a.ADD_PRESET_ASSET&&Object(Ln.jsx)(wr,{onClose:B})]}),Object(Ln.jsx)(hr,{parentId:"app-wrapper",visible:Boolean(k),children:Object(Ln.jsxs)("div",{className:"Layout__inline",children:[Object(Ln.jsx)("div",{children:k}),Object(Ln.jsx)(o.Loader,{})]})})]})},Dr=(n(1059),function(e){var t=e.message,n=e.marginTop,r=void 0===n?"0":n,a=e.marginBottom,s=void 0===a?"0":a,i=e.textAlign,c=void 0===i?"left":i;return t?Object(Ln.jsx)("div",{className:"ErrorMessage",style:{marginTop:r,marginBottom:s,textAlign:c},children:t}):null}),Ur=function(e){var t=e.asset,n=e.onClose,r=Vn("account","sendPayment","settings"),a=r.account,s=r.sendPayment,i=r.settings,u=a.data,d=a.secretKey,l=Object(c.b)(),p=Object(Un.useState)(""),b=Object(w.a)(p,2),h=b[0],f=b[1],O=Object(Un.useState)(""),E=Object(w.a)(O,2),g=E[0],x=E[1],y=Object(Un.useState)(null===t||void 0===t?void 0:t.assetCode),T=Object(w.a)(y,2),A=T[0],C=T[1],N=Object(Un.useState)((null===t||void 0===t?void 0:t.assetIssuer)||""),k=Object(w.a)(N,2),I=k[0],_=k[1],P=Object(Un.useState)(!0),D=Object(w.a)(P,2),U=D[0],L=D[1],B=function(){f(""),x(""),C(""),_(""),L(!0)};Object(Un.useEffect)((function(){return function(){l(wn()),l(ne()),B()}}),[l]),Object(Un.useEffect)((function(){s.status===R.a.SUCCESS&&(null===u||void 0===u?void 0:u.id)&&(l(K({publicKey:u.id,secretKey:d})),l(wn()),l(ne()),B(),n())}),[s.status,d,null===u||void 0===u?void 0:u.id,l,n]);var F=function(){var e=Object(v.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h&&S.StrKey.isValidEd25519PublicKey(h)){e.next=2;break}return e.abrupt("return");case 2:return t=new m.a({serverUrl:M(i.pubnet).url,accountOrKey:h,networkPassphrase:M(i.pubnet).network}),e.t0=L,e.next=6,t.isAccountFunded();case 6:e.t1=e.sent,(0,e.t0)(e.t1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Modal.Heading,{children:"Send payment"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)(o.Input,{id:"send-destination",label:"Destination",value:h,onChange:function(e){return f(e.target.value)},onBlur:function(){F()}}),Object(Ln.jsx)(o.Input,{id:"send-amount",label:"Amount",type:"number",value:g,onChange:function(e){return x(e.target.value)}}),Object(Ln.jsx)(o.Input,{id:"send-asset-code",label:"Asset code",value:A,onChange:function(e){return C(e.target.value)}}),(null===t||void 0===t?void 0:t.assetType)!==R.e.NATIVE&&Object(Ln.jsx)(o.Input,{id:"send-asset-issuer",label:"Asset issuer",value:I,onChange:function(e){return _(e.target.value)}}),!U&&Object(Ln.jsxs)(o.InfoBlock,{children:["The destination account doesn\u2019t exist. A create account operation will be used to create this account."," ",Object(Ln.jsx)(o.TextLink,{href:"https://developers.stellar.org/docs/tutorials/create-account/",children:"Learn more about account creation"})]}),Object(Ln.jsx)(Dr,{message:s.errorString})]}),Object(Ln.jsx)(o.Modal.Footer,{children:Object(Ln.jsx)(o.Button,{onClick:function(){if(null===u||void 0===u?void 0:u.id){var e={destination:h,isDestinationFunded:U,amount:g,assetCode:A,assetIssuer:I,publicKey:u.id};l(gn(e))}},isLoading:s.status===R.a.PENDING,children:"Submit"})})]})},Lr=function(){var e=Vn("sep6DepositAsset").sep6DepositAsset,t=e.data.depositResponse,n={amount:"",depositType:{type:""},infoFields:{},customerFields:{}},r=Object(Un.useState)(n),a=Object(w.a)(r,2),s=a[0],i=a[1],u=Object(c.b)(),d=Object(Un.useMemo)((function(){var t,n;return(null===(t=e.data.infoFields)||void 0===t||null===(n=t.type)||void 0===n?void 0:n.choices)||[]}),[e]);Object(Un.useEffect)((function(){e.status===R.a.NEEDS_INPUT&&i({amount:"",depositType:{type:d[0]},infoFields:{},customerFields:{}})}),[e.status,d,u]);var l,p=function(){u(ct()),u(ne()),i(n)},b=function(e){var t=e.target,n=t.id,r=t.value,a=Object(E.a)(Object(E.a)({},s),{},{depositType:Object(E.a)(Object(E.a)({},s.depositType),{},Object(ae.a)({},n,r))});i(a)},h=function(e){var t=e.target,n=t.id,r=t.value,a=Object(E.a)(Object(E.a)({},s),{},{infoFields:Object(E.a)(Object(E.a)({},s.infoFields),{},Object(ae.a)({},n,r))});i(a)},f=function(e){var t=e.target,n=t.id,r=t.value,a=Object(E.a)(Object(E.a)({},s),{},{customerFields:Object(E.a)(Object(E.a)({},s.customerFields),{},Object(ae.a)({},n,r))});i(a)};return e.status===R.a.NEEDS_INPUT?Object(Ln.jsxs)(o.Modal,{visible:!0,onClose:p,parentId:se.a,children:[Object(Ln.jsx)(o.Modal.Heading,{children:"SEP-6 Deposit Info"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)("div",{className:"vertical-spacing",children:Object(Ln.jsx)(o.Input,{id:"amount",label:Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["The amount of the asset the user would like to deposit with the anchor. This field may be necessary for the anchor to determine what KYC information is necessary to collect."," ",Object(Ln.jsx)(o.TextLink,{href:"https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0006.md#1-success-no-additional-information-needed",children:"Learn more"})]}),isInline:!0,tooltipPosition:o.DetailsTooltip.tooltipPosition.left,children:Object(Ln.jsx)(Ln.Fragment,{children:"Amount (optional)"})}),onChange:function(e){var t=e.target,n=t.id,r=t.value,a=Object(E.a)(Object(E.a)({},s),{},Object(ae.a)({},n,r.toString()));i(a)},type:"number",note:function(){var t=e.data,n=t.minAmount,r=t.maxAmount;return 0===n&&0===r?null:"Min: ".concat(n," | Max: ").concat(r)}()})}),Object(Ln.jsx)(o.Heading3,{children:Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["These are the fields the receiving anchor requires. The sending client obtains them from the /info endpoint."," ",Object(Ln.jsx)(o.TextLink,{href:"https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0006.md#info",children:"Learn more"})]}),isInline:!0,tooltipPosition:o.DetailsTooltip.tooltipPosition.left,children:Object(Ln.jsx)(Ln.Fragment,{children:"SEP-6 Required Info"})})}),Object(Ln.jsx)("div",{className:"vertical-spacing",children:Object.entries(e.data.infoFields||{}).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return"type"===n?Object(Ln.jsx)("div",{children:Object(Ln.jsx)(o.Select,{label:r.description,id:n,onChange:b,children:d.map((function(e){return Object(Ln.jsx)("option",{value:e,children:e},e)}))},n)},n):Object(Ln.jsx)(o.Input,{id:n,label:r.description,required:!0,onChange:h},n)}))}),Object.keys(e.data.customerFields).length?Object(Ln.jsx)(o.Heading3,{children:Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["These are the fields the receiving anchor requires. The sending client obtains them from the /customer endpoint."," ",Object(Ln.jsx)(o.TextLink,{href:"https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0012.md#customer-get",children:"Learn more"})]}),isInline:!0,children:Object(Ln.jsx)(Ln.Fragment,{children:"SEP-12 Required Info"})})}):null,Object(Ln.jsx)("div",{className:"vertical-spacing",children:Object.entries(e.data.customerFields||{}).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return Object(Ln.jsx)(o.Input,{id:n,label:r.description,required:!0,onChange:f},n)}))})]}),Object(Ln.jsxs)(o.Modal.Footer,{children:[Object(Ln.jsx)(o.Button,{onClick:function(e){e.preventDefault(),u(tt(Object(E.a)({},s)))},children:"Submit"}),Object(Ln.jsx)(o.Button,{onClick:p,variant:o.Button.variant.secondary,children:"Cancel"})]})]}):e.status===R.a.CAN_PROCEED?Object(Ln.jsxs)(o.Modal,{visible:!0,onClose:p,parentId:se.a,children:[Object(Ln.jsx)(o.Modal.Heading,{children:"SEP-6 Deposit Success"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)("p",{children:t.how}),(null===(l=t.extra_info)||void 0===l?void 0:l.message)&&Object(Ln.jsx)("p",{children:t.extra_info.message})]}),Object(Ln.jsxs)(o.Modal.Footer,{children:[Object(Ln.jsx)(o.Button,{onClick:function(){return u(nt())},children:"Proceed"}),Object(Ln.jsx)(o.Button,{onClick:p,variant:o.Button.variant.secondary,children:"Close"})]})]}):null},Br=function(){var e=Vn("sep6WithdrawAsset").sep6WithdrawAsset,t=e.data,n=t.assetCode,r=t.transactionResponse,a=t.withdrawResponse,s={withdrawType:{type:""},customerFields:{},infoFields:{}},i=Object(Un.useState)(s),u=Object(w.a)(i,2),d=u[0],l=u[1],p=Object(Un.useState)(""),b=Object(w.a)(p,2),h=b[0],f=b[1],j=Object(c.b)(),v=Object(Un.useMemo)((function(){var t;return(null===(t=e.data.withdrawTypes)||void 0===t?void 0:t.types)||{fields:{}}}),[e]),m=Object(Un.useState)(Object.keys(v)[0]),S=Object(w.a)(m,2),O=S[0],g=S[1],x=Object(Un.useMemo)((function(){return Object.entries(v)}),[v]);Object(Un.useEffect)((function(){if(e.status===R.a.NEEDS_INPUT){var t=x[0][0];l({withdrawType:{type:t},customerFields:{},infoFields:{}}),g(t)}}),[e.status,x,j]);var y,T,A=function(){j(ft()),j(ne()),l(s)},C=function(e){var t=e.target,n=t.id,r=t.value,a=Object(E.a)(Object(E.a)({},d),{},{infoFields:Object(E.a)(Object(E.a)({},d.infoFields),{},Object(ae.a)({},n,r))});l(a)},N=function(e){var t=e.target,n=t.id,r=t.value,a=Object(E.a)(Object(E.a)({},d),{},{customerFields:Object(E.a)(Object(E.a)({},d.customerFields),{},Object(ae.a)({},n,r))});l(a)};return e.status===R.a.NEEDS_INPUT?Object(Ln.jsxs)(o.Modal,{visible:!0,onClose:A,parentId:se.a,children:[Object(Ln.jsx)(o.Modal.Heading,{children:"SEP-6 Withdrawal Info"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)(o.Heading3,{children:Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["These are the fields the receiving anchor requires. The sending client obtains them from the /info endpoint."," ",Object(Ln.jsx)(o.TextLink,{href:"https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0006.md#info",children:"Learn more"})]}),isInline:!0,tooltipPosition:o.DetailsTooltip.tooltipPosition.left,children:Object(Ln.jsx)(Ln.Fragment,{children:"SEP-6 Required Info"})})}),Object(Ln.jsxs)("div",{className:"vertical-spacing",children:[Object(Ln.jsx)(o.Select,{label:"Withdrawal Type",id:"withdrawal-type",onChange:function(e){var t=e.target.value;g(t),l(Object(E.a)(Object(E.a)({},d),{},{withdrawType:{type:t}}))},children:x.map((function(e){var t=Object(w.a)(e,1)[0];return Object(Ln.jsx)("option",{value:t,children:t},t)}))}),Object.entries((null===(y=v[O])||void 0===y?void 0:y.fields)||{}).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return Object(Ln.jsx)(o.Input,{id:n,label:null===r||void 0===r?void 0:r.description,required:!0,onChange:C},n)}))]}),Object.keys(e.data.fields).length?Object(Ln.jsx)(o.Heading3,{children:Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["These are the fields the receiving anchor requires. The sending client obtains them from the /customer endpoint."," ",Object(Ln.jsx)(o.TextLink,{href:"https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0012.md#customer-get",children:"Learn more"})]}),isInline:!0,children:Object(Ln.jsx)(Ln.Fragment,{children:"SEP-12 Required Info"})})}):null,Object(Ln.jsx)("div",{className:"vertical-spacing",children:Object.entries(e.data.fields||{}).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return Object(Ln.jsx)(o.Input,{id:n,label:null===r||void 0===r?void 0:r.description,required:!0,onChange:N},n)}))}),Object(Ln.jsx)(Dr,{message:e.errorString})]}),Object(Ln.jsx)(o.Modal.Footer,{children:Object(Ln.jsx)(o.Button,{onClick:function(e){e.preventDefault(),j(ut(Object(E.a)({},d)))},children:"Submit"})})]}):e.status===R.a.CAN_PROCEED?Object(Ln.jsxs)(o.Modal,{visible:!0,onClose:A,parentId:se.a,children:[Object(Ln.jsx)(o.Modal.Heading,{children:"Payment Sending"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsxs)("div",{className:"vertical-spacing",children:[Object(Ln.jsx)("strong",{children:"Sending Payment To: "}),fr(a.account_id)]}),Object(Ln.jsx)(o.Input,{id:"withdraw-amount",label:"Amount to Withdraw",required:!0,onChange:function(e){var t=e.target.value;f(t)}}),a.min_amount||a.max_amount?Object(Ln.jsxs)("div",{className:"vertical-spacing",children:[a.min_amount&&Object(Ln.jsxs)("p",{children:[Object(Ln.jsx)("strong",{children:"Min Amount: "}),a.min_amount]}),a.max_amount&&Object(Ln.jsxs)("p",{children:[Object(Ln.jsx)("strong",{children:"Max Amount: "}),a.max_amount]})]}):null,a.id&&Object(Ln.jsxs)("div",{className:"vertical-spacing",children:[Object(Ln.jsx)("strong",{children:"Transaction ID: "}),a.id]}),(null===(T=a.extra_info)||void 0===T?void 0:T.message)&&Object(Ln.jsx)("div",{className:"vertical-spacing",children:a.extra_info.message}),a.memo_type&&Object(Ln.jsxs)("div",{className:"vertical-spacing",children:[Object(Ln.jsx)("strong",{children:"Memo Type: "}),a.memo_type]}),a.memo&&Object(Ln.jsxs)("div",{className:"vertical-spacing",children:[Object(Ln.jsx)("strong",{children:"Memo: "}),a.memo]})]}),Object(Ln.jsx)(o.Modal.Footer,{children:Object(Ln.jsx)(o.Button,{onClick:function(e){e.preventDefault(),j(dt(h))},children:"Submit"})})]}):e.status===R.a.SUCCESS?Object(Ln.jsxs)(o.Modal,{visible:!0,onClose:A,parentId:se.a,children:[Object(Ln.jsx)(o.Modal.Heading,{children:"SEP-6 Withdrawal Completed"}),Object(Ln.jsxs)(o.Modal.Body,{children:[r.to&&Object(Ln.jsxs)("div",{className:"vertical-spacing",children:[Object(Ln.jsx)("strong",{children:"Account Withdrawn To: "}),Object(Ln.jsx)("p",{children:r.to}),Object(Ln.jsx)("p",{children:r.external_extra_text})]}),r.more_info_url&&Object(Ln.jsxs)("div",{className:"vertical-spacing",children:[Object(Ln.jsx)("strong",{children:"More Info: "}),Object(Ln.jsx)("p",{children:r.more_info_url})]}),r.amount_in&&Object(Ln.jsxs)("div",{className:"vertical-spacing",children:["Amount Withdrawn: ",r.amount_in,Object(Ln.jsx)("p",{children:r.amount_fee&&Object(Ln.jsxs)(Ln.Fragment,{children:["Fee: ",r.amount_fee]})}),Object(Ln.jsx)("p",{children:r.amount_out&&Object(Ln.jsxs)("strong",{children:["Total Amount Out: ",r.amount_out," ",n]})})]})]})]}):null},Mr=function(e){var t=e.onClose,n=Vn("account","sep8Send"),r=n.account,a=n.sep8Send,s=Object(Un.useState)({}),i=Object(w.a)(s,2),u=i[0],d=i[1],l=a.data.actionRequiredInfo,p=l.actionFields,b=l.message,h=l.actionMethod,f=l.actionUrl,j=a.data.actionRequiredResult,v=j.nextUrl,m=j.result,S=Object(c.b)();Object(Un.useEffect)((function(){var e="GET"===h;if((e||a.data.sep8Step===R.n.SENT_ACTION_REQUIRED_FIELDS)&&(e&&window.open(f,"_blank"),v&&m===R.l.FOLLOW_NEXT_URL&&(window.open(v,"_blank"),r.data&&S(yt({assetCode:a.data.assetCode,assetIssuer:a.data.assetIssuer,homeDomain:a.data.homeDomain}))),r.data&&m===R.l.NO_FURTHER_ACTION_REQUIRED)){var t,n={destination:a.data.revisedTransaction.destination,isDestinationFunded:!0,amount:a.data.revisedTransaction.amount,assetCode:a.data.assetCode,assetIssuer:a.data.assetIssuer,publicKey:null===(t=r.data)||void 0===t?void 0:t.id,approvalServer:a.data.approvalServer};S(Tt(n))}}),[h,f,r.data,S,v,m,a.data.approvalServer,a.data.assetCode,a.data.assetIssuer,a.data.homeDomain,a.data.revisedTransaction.amount,a.data.revisedTransaction.destination,a.data.sep8Step]);var O=function(){S(At({actionFields:u,actionMethod:h,actionUrl:f}))};return Object(Ln.jsx)(o.Modal,{onClose:t,visible:!0,parentId:se.a,children:Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Modal.Heading,{children:"SEP-8 Action Required"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)("div",{className:"ModalMessage",children:Object(Ln.jsx)("p",{children:b})}),Object(Ln.jsx)("div",{className:"ModalMessage",children:Object(Ln.jsx)("p",{children:"The following information is needed before we can proceed:"})}),null===p||void 0===p?void 0:p.map((function(e){var t=e.name,n=e.description,r=function(e){var t=e.sep9Field,n=t.name,r=t.type,a={value:u[n]||""},s="text";switch(r){case L.DATE:s="date";break;case L.BINARY:s="file",a={};break;case L.NUMBER:s="number"}return"email_address"===n&&(s="email"),{inputType:s,inputValue:a}}({sep9Field:e}),a=r.inputType,s=r.inputValue;return Object(Ln.jsx)(o.Input,Object(E.a)({id:"sep8-action-field-".concat(t),type:a,label:t,onChange:function(e){return function(e){var t=e.fieldName,n=e.event,r=n.target.files,a=(null===r||void 0===r?void 0:r.length)?r[0]:n.target.value,s=Object(E.a)({},u);s[t]=a,d(s)}({fieldName:t,event:e})},multiple:!1,note:n},s),t)})),Object(Ln.jsx)(Dr,{message:a.errorString})]}),Object(Ln.jsx)(o.Modal.Footer,{children:Object(Ln.jsx)(o.Button,{onClick:O,isLoading:a.status===R.a.PENDING,children:"Submit"})})]})})},Fr=function(e){var t=e.onClose,n=Vn("account","sep8Send","settings"),r=n.account,a=n.sep8Send,s=n.settings,i=a.data,u=i.approvalCriteria,d=i.approvalServer,l=i.assetCode,p=i.assetIssuer,b=Object(Un.useState)(a.data.revisedTransaction.amount),h=Object(w.a)(b,2),f=h[0],O=h[1],E=Object(Un.useState)(a.data.revisedTransaction.destination),g=Object(w.a)(E,2),x=g[0],y=g[1],T=Object(Un.useState)(!0),A=Object(w.a)(T,2),C=A[0],N=A[1],k=Object(c.b)();Object(Un.useEffect)((function(){a.data.sep8Step===R.n.PENDING&&t()}),[t,a.data.sep8Step]);var I=function(){var e;if(null===(e=r.data)||void 0===e?void 0:e.id){var t,n={destination:x,isDestinationFunded:C,amount:f,assetCode:l,assetIssuer:p,publicKey:null===(t=r.data)||void 0===t?void 0:t.id,approvalServer:d};k(Tt(n))}},_=function(){var e=Object(v.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x&&S.StrKey.isValidEd25519PublicKey(x)){e.next=2;break}return e.abrupt("return");case 2:return t=new m.a({serverUrl:M(s.pubnet).url,accountOrKey:x,networkPassphrase:M(s.pubnet).network}),e.t0=N,e.next=6,t.isAccountFunded();case 6:e.t1=e.sent,(0,e.t0)(e.t1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(Ln.jsx)(o.Modal,{onClose:function(){y(""),O(""),N(!0),t()},visible:!0,parentId:se.a,children:Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Modal.Heading,{children:"Send SEP-8 Payment"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)(o.Input,{id:"send-destination",label:"Destination",value:x,onChange:function(e){y(e.target.value),a.errorString&&k(Pt())},onBlur:_}),Object(Ln.jsx)(o.Input,{id:"send-amount",label:"Amount",type:"number",value:f,onChange:function(e){O(e.target.value),a.errorString&&k(Pt())}}),Object(Ln.jsx)(o.Input,{id:"send-asset-code",label:"Asset code",value:l,disabled:!0}),Object(Ln.jsx)(o.Input,{id:"send-asset-issuer",label:"Asset issuer",value:p,disabled:!0}),Object(Ln.jsxs)(o.InfoBlock,{children:[Object(Ln.jsx)("strong",{children:"Approval criteria: "}),u]}),!C&&Object(Ln.jsxs)(o.InfoBlock,{children:["The destination account doesn\u2019t exist. A create account operation will be used to create this account."," ",Object(Ln.jsx)(o.TextLink,{href:"https://developers.stellar.org/docs/tutorials/create-account/",children:"Learn more about account creation"})]}),Object(Ln.jsx)(Dr,{message:a.errorString})]}),Object(Ln.jsx)(o.Modal.Footer,{children:Object(Ln.jsx)(o.Button,{onClick:I,isLoading:a.status===R.a.PENDING,children:"Submit"})})]})})},Kr=function(e){var t,n=e.onClose,r=Vn("account","sep8Send","settings"),a=r.account,s=r.sep8Send,i=r.settings,u=Object(Un.useState)(),d=Object(w.a)(u,2),l=d[0],p=d[1],b=Object(Un.useState)(),h=Object(w.a)(b,2),f=h[0],j=h[1],v=Object(Un.useState)(!1),m=Object(w.a)(v,2),O=m[0],E=m[1],g=Object(c.b)(),x=s.data.revisedTransaction,y=x.revisedTxXdr,T=x.submittedTxXdr,A=s.data.sep8Step,C=function(){y&&O&&g(wt())};Object(Un.useEffect)((function(){var e;A===R.n.COMPLETE&&(null===(e=a.data)||void 0===e?void 0:e.id)&&(g(K({publicKey:a.data.id,secretKey:a.secretKey})),n())}),[null===(t=a.data)||void 0===t?void 0:t.id,a.secretKey,g,n,A]),Object(Un.useEffect)((function(){var e=M(i.pubnet).network;if(T){var t=S.TransactionBuilder.fromXDR(T,e);p(t)}if(y){var n=S.TransactionBuilder.fromXDR(y,e);j(n)}}),[y,T,i.pubnet]);return Object(Ln.jsx)(o.Modal,{onClose:n,visible:!0,parentId:se.a,children:Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Modal.Heading,{children:"Review & Submit SEP-8 Transaction"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)("div",{className:"ModalMessage",children:Object(Ln.jsxs)("p",{children:[s.data.actionRequiredResult.result&&"KYC has been approved. ","Please review the updated operations before submitting your SEP-8 payment."]})}),(null===l||void 0===l?void 0:l.operations)&&Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Heading3,{children:"Original transaction operations"}),Object(Ln.jsx)(tr,{src:l.operations})]}),(null===f||void 0===f?void 0:f.operations)&&Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Heading3,{children:"Revised transaction operations"}),Object(Ln.jsx)(tr,{src:f.operations})]}),Object(Ln.jsx)(Dr,{marginBottom:"1rem",message:s.errorString}),Object(Ln.jsx)(o.Checkbox,{id:"sep8-send-approve",label:"I approve executing these operations.",checked:O,onChange:function(){E(!O)},disabled:s.status===R.a.PENDING})]}),Object(Ln.jsx)(o.Modal.Footer,{children:Object(Ln.jsx)(o.Button,{onClick:C,disabled:!O,isLoading:s.status===R.a.PENDING,children:"Submit"})})]})})},Gr=function(){var e=Vn("sep8Send").sep8Send.data.sep8Step,t=Object(c.b)(),n=function(){t(ne()),t(_t())};return Object(Ln.jsxs)(Ln.Fragment,{children:[[R.n.STARTING,R.n.PENDING].includes(e)&&Object(Ln.jsx)(Fr,{onClose:n}),[R.n.TRANSACTION_REVISED,R.n.COMPLETE].includes(e)&&Object(Ln.jsx)(Kr,{onClose:n}),[R.n.ACTION_REQUIRED,R.n.SENT_ACTION_REQUIRED_FIELDS].includes(e)&&Object(Ln.jsx)(Mr,{onClose:n})]})},Vr=n(464),Wr=function(e){var t=e.split(""),n=Object(Vr.a)(t),r=n[0],a=n.slice(1);return r.toUpperCase()+a.join("")};!function(e){e.SENDER="sender",e.RECEIVER="receiver"}(sr||(sr={}));var qr=function(){var e,t=Vn("account","sep31Send"),n=t.account,r=t.sep31Send,a=Object(Un.useState)({}),s=Object(w.a)(a,2),i=s[0],u=s[1],d=Object(Un.useState)(""),l=Object(w.a)(d,2),p=l[0],b=l[1],h=Object(Un.useState)({sender:"",receiver:""}),f=Object(w.a)(h,2),j=f[0],v=f[1],m=r.data,S=Object(c.b)();Object(Un.useEffect)((function(){var e;(r.status===R.a.CAN_PROCEED&&r.data.isTypeSelected&&S(un()),r.status===R.a.SUCCESS)&&((null===(e=n.data)||void 0===e?void 0:e.id)&&(O(),S(K({publicKey:n.data.id,secretKey:n.secretKey})),S(fn())))}),[r.status,r.data.isTypeSelected,null===(e=n.data)||void 0===e?void 0:e.id,n.secretKey,S]);var O=function(){b(""),on({senderType:"",receiverType:""}),u({})},g=function(e){var t=e.target,n=t.id,r=t.value,a=n.split("#"),s=Object(w.a)(a,2),c=s[0],o=s[1],d=Object(E.a)(Object(E.a)({},i),{},Object(ae.a)({},c,Object(E.a)(Object(E.a)({},i[c]||{}),{},Object(ae.a)({},o,r))));u(d)},x=function(e,t){var n=Object(E.a)(Object(E.a)({},j),{},Object(ae.a)({},e,t));v(n)},y=function(){O(),S(fn()),S(ne())};if(r.status===R.a.NEEDS_INPUT){if(!m.isTypeSelected)return Object(Ln.jsxs)(o.Modal,{visible:!0,onClose:y,parentId:se.a,children:[Object(Ln.jsx)(o.Modal.Heading,{children:"Customer Types"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)("p",{children:"Receiving anchors are required to collect Know Your Customer (KYC) information on the customers involved in a transaction. Each type described below corresponds to a different set of KYC values the anchor will request the sending anchor to provide. This demo wallet, which acts as a sending anchor, will provide you a form to enter the fields corresponding to the type selected."}),Object(Ln.jsxs)("div",{children:[Object(Ln.jsx)(o.Heading3,{children:"Sender"}),function(){var e,t;return m.senderType?Object(Ln.jsxs)("p",{children:[Object(Ln.jsx)("code",{children:m.senderType})," was automatically selected"]}):m.senderType||(null===(e=m.multipleSenderTypes)||void 0===e?void 0:e.length)?null===(t=m.multipleSenderTypes)||void 0===t?void 0:t.map((function(e){return Object(Ln.jsx)(o.RadioButton,{onChange:function(){return x(sr.SENDER,e.type)},id:e.type,value:e.type,name:"customer-sender",label:Object(Ln.jsxs)("span",{className:"inline-block",children:[Object(Ln.jsx)("code",{children:e.type})," ",e.description]})},e.type)})):Object(Ln.jsx)("p",{children:"Sender type is not required"})}()]}),Object(Ln.jsxs)("div",{children:[Object(Ln.jsx)(o.Heading3,{children:"Receiver"}),function(){var e,t;return m.receiverType?Object(Ln.jsxs)("p",{children:[Object(Ln.jsx)("code",{children:m.receiverType})," was automatically selected"]}):m.receiverType||(null===(e=m.multipleReceiverTypes)||void 0===e?void 0:e.length)?null===(t=m.multipleReceiverTypes)||void 0===t?void 0:t.map((function(e){return Object(Ln.jsx)(o.RadioButton,{onChange:function(){return x(sr.RECEIVER,e.type)},id:e.type,value:e.type,name:"customer-receiver",label:Object(Ln.jsxs)("span",{className:"inline-block",children:[Object(Ln.jsx)("code",{children:e.type})," ",e.description]})},e.type)})):Object(Ln.jsx)("p",{children:"Receiver type is not required"})}()]}),p&&Object(Ln.jsx)("p",{className:"error",children:p})]}),Object(Ln.jsx)(o.Modal.Footer,{children:Object(Ln.jsx)(o.Button,{onClick:function(e){var t,n;b("");var r=j.sender,a=j.receiver;e.preventDefault(),(null===(t=m.multipleSenderTypes)||void 0===t?void 0:t.length)&&!r||(null===(n=m.multipleReceiverTypes)||void 0===n?void 0:n.length)&&!a?b("Please select sender/receiver type"):S(on({senderType:null!==r&&void 0!==r?r:m.senderType,receiverType:null!==a&&void 0!==a?a:m.receiverType}))},children:"Submit"})})]});if(m.isTypeSelected){var T=m.fields,A=T.transaction,C=T.sender,N=T.receiver,k=Object(E.a)(Object(E.a)(Object(E.a)({amount:{amount:{description:"amount to send"}}},C?{sender:C}:{}),N?{receiver:N}:{}),A?{transaction:A}:{});return Object(Ln.jsxs)(o.Modal,{visible:!0,onClose:y,parentId:se.a,children:[Object(Ln.jsx)(o.Modal.Heading,{children:Object(Ln.jsx)(o.DetailsTooltip,{details:Object(Ln.jsxs)(Ln.Fragment,{children:["These are the fields the receiving anchor requires. The sending client obtains them from the /customer endpoint."," ",Object(Ln.jsx)(o.TextLink,{href:"https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0012.md#customer-get",children:"Learn more"})]}),isInline:!0,children:Object(Ln.jsx)(Ln.Fragment,{children:"Sender and receiver info"})})}),Object(Ln.jsx)(o.Modal.Body,{children:Object.entries(k).map((function(e){var t=Object(w.a)(e,2),n=t[0],r=t[1];return Object(Ln.jsxs)("div",{className:"vertical-spacing",children:[Object(Ln.jsx)(o.Heading3,{children:Wr(n)}),Object.entries(r||{}).map((function(e){var t=Object(w.a)(e,2),r=t[0],a=t[1];return Object(Ln.jsx)(o.Input,{id:"".concat(n,"#").concat(r),label:a.description,required:!a.optional,onChange:g},"".concat(n,"#").concat(r))}))]},n)}))}),Object(Ln.jsx)(o.Modal.Footer,{children:Object(Ln.jsx)(o.Button,{onClick:function(e){e.preventDefault(),S(dn(Object(E.a)({},i)))},children:"Submit"})})]})}}return null},Hr=function(){var e,t=Vn("account").account,n=Object(Un.useState)(!1),r=Object(w.a)(n,2),a=r[0],s=r[1],i=Object(Un.useState)(),u=Object(w.a)(i,2),d=u[0],l=u[1],p=Object(c.b)(),b=function(){s(!1),p(ne())};return(null===(e=t.data)||void 0===e?void 0:e.id)?Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(jr,{}),Object(Ln.jsx)(Pr,{onSendPayment:function(e){l(e),s(!0)}}),Object(Ln.jsx)(Lr,{}),Object(Ln.jsx)(Br,{}),Object(Ln.jsx)(Gr,{}),Object(Ln.jsx)(qr,{}),Object(Ln.jsx)(o.Modal,{visible:Boolean(a),onClose:b,parentId:se.a,children:Object(Ln.jsx)(Ur,{asset:d,onClose:b})})]}):null},Yr="loaded screen: home",Xr=function(){var e=Vn("account","settings"),t=e.account,n=e.settings,r=Object(Un.useState)(""),a=Object(w.a)(r,2),s=a[0],c=a[1],u=Object(i.g)();return Object(Ln.jsxs)(Ln.Fragment,{children:[Object(Ln.jsx)(o.Modal.Heading,{children:"Connect with a secret key"}),Object(Ln.jsxs)(o.Modal.Body,{children:[Object(Ln.jsx)(o.Input,{id:"secretKey",label:"Your secret key",onChange:function(e){return c(e.target.value)},value:s,placeholder:"Starts with S, example: SCHK\u2026ZLJK"}),Object(Ln.jsx)(o.Checkbox,{id:"use-pubnet",label:"Operate on pubnet (NOT RECOMMENDED)",checked:n.pubnet,onChange:function(){u.push(Yn.update(R.i.PUBNET,(!n.pubnet).toString()))}})]}),Object(Ln.jsx)(o.Modal.Footer,{children:Object(Ln.jsx)(o.Button,{onClick:function(){u.push(Yn.update(R.i.SECRET_KEY,s))},disabled:!s,isLoading:t.status===R.a.PENDING,children:"Connect"})})]})},Qr=function(){var e=Vn("account").account,t=Object(Un.useState)(!1),n=Object(w.a)(t,2),r=n[0],a=n[1],s=Object(c.b)(),d=Object(i.h)(),l=Object(i.g)();Object(Un.useEffect)((function(){u.metrics.emitMetric(Yr)}),[]),Object(Un.useEffect)((function(){e.status!==R.a.SUCCESS||e.isAuthenticated||l.push(Yn.update(R.i.SECRET_KEY,e.secretKey))}),[e.secretKey,e.status,e.isAuthenticated,l,d]);var p=e.status===R.a.PENDING;return Object(Ln.jsx)(o.Layout.Inset,{children:Object(Ln.jsxs)("div",{className:"Landing__container",children:[Object(Ln.jsx)(o.Heading3,{children:"Import or generate keypair"}),Object(Ln.jsxs)("div",{className:"Landing__buttons",children:[Object(Ln.jsx)(o.TextLink,{onClick:function(){return a(!0)},variant:o.TextLink.variant.secondary,disabled:p,underline:!0,children:"Provide a secret key (testnet or mainnet)"}),Object(Ln.jsxs)("div",{className:"Layout__inline",children:[Object(Ln.jsx)(o.TextLink,{onClick:function(){l.push(Yn.update(R.i.PUBNET,"false")),s(G())},variant:o.TextLink.variant.secondary,disabled:p,underline:!0,children:"Generate keypair for new account (testnet only)"}),!r&&p&&Object(Ln.jsx)(o.Loader,{})]})]}),Object(Ln.jsx)(o.Modal,{visible:r,onClose:function(){return a(!1)},parentId:se.a,children:Object(Ln.jsx)(Xr,{})})]})})},zr=function(){var e=Object(i.g)();return Object(Ln.jsx)(o.Layout.Inset,{children:Object(Ln.jsxs)("div",{className:"NotFoundPage",children:[Object(Ln.jsx)(o.Eyebrow,{children:"Error 404"}),Object(Ln.jsx)(o.Heading1,{children:"Sorry, that page couldn\u2019t be found."}),Object(Ln.jsx)("p",{children:"Have you tried turning it off and on again?"}),Object(Ln.jsx)(o.Button,{onClick:function(){e.push({pathname:"/",search:e.location.search})},children:"Go back"})]})})};n(1060);u.errorReporting.reportErrors({projectName:"demo-wallet",tracingOrigins:[/^\/[^/]/]});var Jr=function(){return Object(Ln.jsx)(c.a,{store:Dn,children:Object(Ln.jsx)(s.a,{children:Object(Ln.jsxs)(pr,{children:[Object(Ln.jsx)(br,{}),Object(Ln.jsxs)("div",{id:"app-wrapper",className:"Wrapper",children:[Object(Ln.jsx)("div",{className:"SplitContainer Main",children:Object(Ln.jsxs)("div",{className:"Main__content",children:[Object(Ln.jsx)(Wn,{}),Object(Ln.jsxs)(o.Layout.Content,{children:[Object(Ln.jsxs)(o.Layout.Inset,{children:[Object(Ln.jsx)("p",{children:"This demo wallet lets financial application developers test their integrations and learn how Stellar ecosystem protocols (SEPs) work."}),Object(Ln.jsxs)("p",{children:[Object(Ln.jsx)(o.TextLink,{variant:o.TextLink.variant.secondary,underline:!0,href:"https://github.com/stellar/stellar-demo-wallet#stellar-demo-wallet",children:"Learn more"})," ","about the tool and"," ",Object(Ln.jsx)(o.TextLink,{variant:o.TextLink.variant.secondary,underline:!0,href:"https://github.com/stellar/stellar-demo-wallet/issues",children:"report issues or request features"})," ","on GitHub."]})]}),Object(Ln.jsxs)(i.d,{children:[Object(Ln.jsx)(i.b,{exact:!0,path:"/",children:Object(Ln.jsx)(Qr,{})}),Object(Ln.jsx)(lr,{exact:!0,path:"/account",children:Object(Ln.jsx)(Hr,{})}),Object(Ln.jsx)(i.b,{component:zr})]})]}),Object(Ln.jsx)(Qn,{})]})}),Object(Ln.jsx)(ur,{})]})]})})})},Zr=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,1067)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),s(e),i(e)}))};n(1061);a.a.render(Object(Ln.jsx)(Jr,{}),document.getElementById("root")),Zr()},188:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var r=n(6),a=function(t,n){var a;switch(n){case"hash":a=new r.Memo(r.MemoHash,e.from(t,"base64").toString("hex"));break;case"id":a=new r.Memo(r.MemoID,t);break;case"text":a=new r.Memo(r.MemoText,t)}if(!a)throw new Error("Invalid memo_type: ".concat(t," (").concat(n,")"));return a}}).call(this,n(11).Buffer)},19:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return i}));var r="logEventMessage",a="|",s=">",i="app-wrapper"},3:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(39),a=n(19),s=n(1),i=function(e){document.dispatchEvent(new CustomEvent(a.b,{detail:e}))},c={request:function(e){var t=e.title,n=e.body,r=void 0===n?"":n;console.log("\ud83d\ude80",t,r),i({timestamp:(new Date).getTime(),type:s.f.REQUEST,title:t,body:r})},response:function(e){var t=e.title,n=e.body,r=void 0===n?"":n;console.log("\u2705",t,r),i({timestamp:(new Date).getTime(),type:s.f.RESPONSE,title:t,body:r})},instruction:function(e){var t=e.title,n=e.body,r=void 0===n?"":n;console.info("\ud83d\udcac",t,r),i({timestamp:(new Date).getTime(),type:s.f.INSTRUCTION,title:t,body:r})},error:function(e){var t=e.title,n=e.body,a=void 0===n?"":n;Object(r.d)(t),console.error(t,a),i({timestamp:(new Date).getTime(),type:s.f.ERROR,title:t,body:a})}}},441:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var r=n(4),a=n.n(r),s=n(16),i=n(9),c=n(50),o=n(6),u=n(3),d=n(1),l=function(){var t=Object(i.a)(a.a.mark((function t(n){var r,i,c,l,b,h,f,j,v,m,S,O,E,g,x,y,T,w,A,C,R;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.secretKey,i=n.assetCode,c=n.assetIssuer,l=n.networkUrl,b=n.networkPassphrase,h=n.amount,f=n.sendMemo,j=n.sendMemoType,v=n.receiverAddress,u.a.instruction({title:"Sending Stellar payment to the receiving anchor"}),m=o.Keypair.fromSecret(r),S=new o.Server(l),O=new o.Asset(i,c),E=m.publicKey(),t.next=8,S.loadAccount(E);case 8:return g=t.sent,t.next=11,S.accounts().accountId(E).call();case 11:if(x=t.sent,y=x.sequence,T=g.balances.find((function(e){return e.asset_code===O.getCode()&&e.asset_issuer===O.getIssuer()}))){t.next=16;break}throw new Error("".concat(i," is not a trusted asset, a trusline must be added"));case 16:if(!(Number(T.balance)<Number(h))){t.next=18;break}throw new Error("The sending anchor does not have enough ".concat(i," balance"));case 18:t.prev=18,C=(A={},Object(s.a)(A,d.g.TEXT,o.Memo.text),Object(s.a)(A,d.g.ID,o.Memo.id),Object(s.a)(A,d.g.HASH,o.Memo.hash),A)[j],w=j===d.g.HASH?C(e.from(f,"base64").toString("hex")):C(f),t.next=26;break;case 23:throw t.prev=23,t.t0=t.catch(18),new Error("The memo `".concat(f,"` could not be encoded to type `").concat(j,"`"));case 26:(R=new o.TransactionBuilder(new o.Account(E,y),{fee:(5*Number(o.BASE_FEE)).toString(),networkPassphrase:b}).addOperation(o.Operation.payment({destination:v,amount:h,asset:O})).addMemo(w).setTimeout(30).build()).sign(m),p({tx:R,server:S});case 29:case"end":return t.stop()}}),t,null,[[18,23]])})));return function(e){return t.apply(this,arguments)}}(),p=function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r,s,i,o,d,l,p,b,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.tx,r=t.server,u.a.instruction({title:"Submitting payment transaction"}),e.prev=2,e.next=5,r.submitTransaction(n);case 5:s=e.sent,e.next=17;break;case 8:throw e.prev=8,e.t0=e.catch(2),o=Object(c.getCatchError)(e.t0),d=null===o||void 0===o||null===(i=o.result)||void 0===i?void 0:i.data,l=null===d||void 0===d?void 0:d.status,p=null===d||void 0===d?void 0:d.extras.result_codes.transaction,b=null===d||void 0===d?void 0:d.extras.result_codes.operations,h=b?b.join(", "):"",new Error("Sending transaction failed with error code ".concat(l,": ").concat(p,", ").concat(h));case 17:return u.a.instruction({title:"Payment transaction submitted",body:s}),e.abrupt("return",s);case 19:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}()}).call(this,n(11).Buffer)},500:function(e,t){},501:function(e,t){},800:function(e,t){},802:function(e,t){},953:function(e,t){},955:function(e,t){},984:function(e,t){},985:function(e,t){},990:function(e,t){},992:function(e,t){},999:function(e,t){}},[[1062,1,2]]]);
//# sourceMappingURL=main.6df29935.chunk.js.map